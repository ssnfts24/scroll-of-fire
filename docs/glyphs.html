<!doctype html>
<html lang="en" dir="ltr">
<head>
  <base href="https://ssnfts24.github.io/scroll-of-fire/">
  <meta charset="utf-8" />
  <title>Voice-Glyph Synth ‚Äî Scroll of Fire</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b0b0f">
  <meta name="color-scheme" content="dark">
  <meta name="description" content="Project a tuned phrase (Eq.16) into a polar lattice (Eq.11) to mint a resonant glyph. Save PNG and attach to ledger notes.">
  <link rel="canonical" href="https://ssnfts24.github.io/scroll-of-fire/glyphs.html" />

  <!-- Global Codex Styles -->
  <link rel="preload" as="style" href="assets/css/codex.css?v=2025-10-20">
  <link rel="stylesheet" href="assets/css/codex.css?v=2025-10-20" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="assets/css/codex.css?v=2025-10-20"></noscript>

  <style>
    :root{--maxw:980px}
    body{overflow-x:hidden}
    .wrap{max-width:var(--maxw);margin:0 auto;padding:24px 16px 100px}
    .title{
      font-family:"Crimson Pro",serif;font-weight:800;text-align:center;
      font-size:clamp(30px,3.8vw,46px);margin:8px 0 4px;
      background:linear-gradient(180deg,#fff 0%,#baf7ff 60%,#7af3ff 100%);
      -webkit-background-clip:text;background-clip:text;color:transparent;
    }
    textarea{
      width:100%;padding:10px;border:1px solid var(--line);
      border-radius:10px;background:var(--bg-elev);color:var(--ink);
      font-size:1rem;resize:vertical;
    }
    .lab-row{display:flex;flex-wrap:wrap;gap:10px;margin-top:12px}
    .lab-btn{
      background:var(--accent);color:#000;border:none;
      border-radius:8px;padding:.6rem 1rem;font-weight:600;
      cursor:pointer;transition:background .3s,transform .2s;
    }
    .lab-btn:hover{background:var(--accent-2);transform:translateY(-2px)}
    .lab-btn.ghost{
      background:transparent;color:var(--ink);border:1px solid var(--line);
    }
    canvas{
      width:100%;max-width:580px;height:auto;
      border:1px solid var(--line);border-radius:14px;
      background:radial-gradient(circle at 50% 50%,#0f0f14 60%,#050509);
      display:block;margin:16px auto 12px;
      box-shadow:0 0 24px rgba(122,243,255,.15);
    }
    .eq-scroll{overflow-x:auto;font-family:serif;font-size:1.1em;text-align:center}
    @media(prefers-reduced-motion:no-preference){
      canvas{animation:pulseGlow 6s ease-in-out infinite alternate}
      @keyframes pulseGlow{
        0%{box-shadow:0 0 12px rgba(122,243,255,.15)}
        100%{box-shadow:0 0 22px rgba(122,243,255,.35)}
      }
    }
  </style>
</head>
<body>
<main class="wrap">
  <header class="page-head fancy-head">
    <h1 class="title">üî∑ Voice-Glyph Synth</h1>
    <p class="subtitle" style="text-align:center">
      Eq.16 ‚Üí Eq.11: Token weights ‚Üí polar projection ‚Üí glyph. Save and attach to your ledger.
    </p>
    <nav class="crumbs" style="display:flex;gap:10px;justify-content:center;margin-top:10px">
      <a class="cta" href="index.html">‚Üê Codex</a>
      <a class="cta" href="teach.html">Teaching Lab</a>
    </nav>
  </header>

  <!-- Phrase input -->
  <section class="card">
    <h2>Phrase</h2>
    <textarea id="phrase" rows="3" placeholder="Type your tuned phrase‚Ä¶"></textarea>
    <div class="lab-row">
      <button id="render" class="lab-btn">Render Glyph</button>
      <button id="save" class="lab-btn ghost" disabled>Save .png</button>
    </div>
    <p class="meta">
      Weights are inferred by simple heuristics (verbs, nouns ‚Üë; filler ‚Üì).  
      For precision, tune in <a href="teach.html#phrase">Phrase Tuner</a> first.
    </p>
  </section>

  <!-- Glyph output -->
  <section class="card">
    <h2>Glyph</h2>
    <canvas id="cv" width="800" height="800" aria-label="Voice glyph"></canvas>
    <div class="eq">
      <div class="eq-scroll">
        $$ \Pi_{\nu}:\ \mathcal{R}\to\mathbb{C},\quad 
           \Pi_{\nu}(\mathcal{R})=\int \mathcal{R}(x)e^{-i2\pi\nu x}\,dx \tag{Eq.11} $$
        $$ \nabla_{\text{sem}}\mathrm{Phrase} = 
           \sum w_k \nabla_{\text{sem}}\mathrm{Token}_k \tag{Eq.16} $$
      </div>
    </div>
  </section>

  <footer class="footer">
    <div class="divider" aria-hidden="true"></div>
    <p class="small muted">¬© <span id="yr">2025</span> Aaron Paul Laird ‚Äî Scroll of Fire ‚Ä¢ CC BY-NC 4.0</p>
  </footer>
</main>

<!-- ============================================================ -->
<!--  Glyph Generator Script                                      -->
<!-- ============================================================ -->
<script>
(function(){
  const yr=document.getElementById('yr');
  if(yr) yr.textContent=new Date().getFullYear();

  // --- token ranking heuristic ---
  function rank(t){
    t=t.toLowerCase();
    if(/(not|never|no|can't|won't|don't)/.test(t)) return 0.1;
    if(/(choose|deliver|build|learn|restore|reveal|listen|act|serve)/.test(t)) return 1.0;
    if(/(love|truth|light|care|power|calm|timing|thanks)/.test(t)) return 0.85;
    if(/(and|the|a|to|of|for|with|that|this)/.test(t)) return 0.2;
    return 0.6;
  }

  // --- compute normalized weights ---
  function weights(text){
    let toks=text.trim().split(/\s+/).filter(Boolean).slice(0,24);
    if(!toks.length) toks=["empty"];
    let raw=toks.map(rank);
    const sum=raw.reduce((a,b)=>a+b,0)||1;
    return toks.map((t,i)=>({t,w:raw[i]/sum}));
  }

  // --- draw glyph ---
  function drawGlyph(list){
    const c=document.getElementById('cv'), ctx=c.getContext('2d');
    ctx.clearRect(0,0,c.width,c.height);
    const W=c.width, H=c.height, cx=W/2, cy=H/2, R=Math.min(cx,cy)*0.85;

    // background grid
    ctx.strokeStyle="rgba(122,243,255,.12)"; ctx.lineWidth=1;
    for(let i=0;i<12;i++){
      let a=(i/12)*Math.PI*2;
      ctx.beginPath(); ctx.moveTo(cx,cy);
      ctx.lineTo(cx+R*Math.cos(a), cy+R*Math.sin(a)); ctx.stroke();
    }
    ctx.beginPath(); ctx.arc(cx,cy,R,0,Math.PI*2); ctx.stroke();

    // token polygon
    ctx.beginPath();
    let ang=0, step=(Math.PI*2)/list.length;
    list.forEach((o,idx)=>{
      const r=0.35*R + o.w*R*0.55;
      const x=cx+r*Math.cos(ang);
      const y=cy+r*Math.sin(ang);
      idx?ctx.lineTo(x,y):ctx.moveTo(x,y);
      ang+=step;
    });
    ctx.closePath();
    ctx.strokeStyle="rgba(243,201,122,.9)";
    ctx.lineWidth=2; ctx.stroke();
    ctx.fillStyle="rgba(243,201,122,.12)"; ctx.fill();

    // center seal
    ctx.beginPath();
    ctx.arc(cx,cy,6,0,Math.PI*2);
    ctx.fillStyle="rgba(122,243,255,.8)";
    ctx.shadowBlur=12; ctx.shadowColor="rgba(122,243,255,.5)";
    ctx.fill();
    ctx.shadowBlur=0;
  }

  // --- controls ---
  const render=document.getElementById('render');
  const save=document.getElementById('save');
  render.addEventListener('click',()=>{
    const phrase=document.getElementById('phrase').value;
    const list=weights(phrase);
    drawGlyph(list);
    save.disabled=false;
  });
  save.addEventListener('click',()=>{
    const url=document.getElementById('cv').toDataURL("image/png");
    const a=document.createElement('a');
    a.href=url; a.download="voice-glyph.png"; a.click();
  });
})();
</script>

<!-- Optional: MathJax for live equation rendering -->
<script defer id="MathJax-script"
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
