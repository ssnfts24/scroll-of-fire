<!doctype html>
<html lang="en" dir="ltr" class="sof carrier-432" data-carriers="432,528,369,144,963">
<head>
  <base href="https://ssnfts24.github.io/scroll-of-fire/">
  <script>
    // Remove <base> on github.com to keep relative links working in repo preview
    if (location.hostname === "github.com") {
      const b = document.querySelector("base"); if (b) b.remove();
    }
  </script>

  <meta charset="utf-8">
  <title>Theory ‚Äî Scroll of Fire (Codex of Reality)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="color-scheme" content="dark light">
  <meta name="theme-color" content="#0b0b0f" media="(prefers-color-scheme: dark)">
  <meta name="description" content="Deep write-ups for the Codex of Reality: equations 0‚Äì17, operators (ùìò¬∑ùìõ¬∑ùìí¬∑ùì¢), ethics, scaffolding, and the daily manifestation loop.">
  <link rel="canonical" href="https://ssnfts24.github.io/scroll-of-fire/theory.html">

  <!-- Icons -->
  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/icon-512.png">

  <!-- Open Graph / Twitter -->
  <meta property="og:site_name" content="Scroll of Fire">
  <meta property="og:title" content="Theory ‚Äî Scroll of Fire (Codex of Reality)">
  <meta property="og:description" content="A living architecture of resonance ‚Äî equations 0‚Äì17, the operator pipeline, the manifestation protocol, and ethical law.">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://ssnfts24.github.io/scroll-of-fire/theory.html">
  <meta property="og:image" content="assets/file_0000000052e861f98b087ad0b80cbefc%20(1).png">
  <meta property="og:image:alt" content="Scroll of Fire ‚Äî Codex of Reality banner">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Crimson+Pro:wght@400;700;800&display=swap" rel="stylesheet">

  <!-- Shared styles (sync to site) -->
  <link rel="preload" as="style" href="assets/css/codex.css?v=2.8">
  <link rel="stylesheet" href="assets/css/codex.css?v=2.8" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="assets/css/codex.css?v=2.8"></noscript>

  <!-- Page-specific (theory tweaks) -->
  <link rel="preload" as="style" href="assets/css/theory.css?v=1.7">
  <link rel="stylesheet" href="assets/css/theory.css?v=1.7">

  <!-- Preload banner -->
  <link rel="preload" as="image" href="assets/file_0000000052e861f98b087ad0b80cbefc%20(1).png" fetchpriority="high">

  <!-- Inline micro-overrides (kept) -->
  <style>
    /* keep your compact chips, mini-TOC, collapsibles, remnant auras, etc. */
  </style>

  <!-- MathJax (lazy; forced typeset) -->
  <script>
    (function(){
      let loaded=false;
      function boot(){ if(!window.MathJax) return; MathJax.startup.promise.then(()=>MathJax.typesetPromise()); }
      function loadMJ(){
        if(loaded) return; loaded=true;
        window.MathJax={ tex:{inlineMath:[['\\(','\\)']], displayMath:[['$$','$$']]}, svg:{fontCache:'global'}, startup:{typeset:false} };
        const s=document.createElement('script');
        s.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js";
        s.defer=true; s.onload=boot; document.head.appendChild(s);
      }
      if(document.readyState!=='loading') loadMJ(); else addEventListener('DOMContentLoaded', loadMJ);
    })();
  </script>

  <!-- Site JS (sync to site) -->
  <script src="assets/js/codex.js?v=3.6" defer></script>

  <!-- Page-local helpers (kept) -->
  <script>
    // smooth [data-jump] + eq expand fallback (your existing code can remain)
  </script>
</head>

<body class="stars living-all" data-theme="dark">
  <a class="skip" href="#main">Skip to content</a>

  <!-- HUD -->
  <div class="laser-grid" aria-hidden="true"></div>
  <div class="xi-meter" aria-hidden="true">
    <div class="xi-ring"><div class="xi-dot"></div></div><div class="xi-label">Œû</div>
  </div>

  <!-- Header with quick controls (parity with home) -->
  <header class="site" role="banner">
    <nav class="nav" aria-label="Main navigation">
      <div class="brand">
        <div class="logo no-living" aria-hidden="true"></div>
        <h1 class="kicker sheen">Scroll of Fire</h1>
      </div>

      <div class="quick quick--utils" role="toolbar" aria-label="Quick actions">
        <button id="toggleSimple" class="cta" type="button" aria-pressed="false" title="Echo View (hide math)">Echo</button>
        <button id="toggleGrid" class="cta" type="button" aria-pressed="true" title="Toggle HUD grid">HUD</button>
        <button id="cycleCarrier" class="cta" type="button" title="Cycle carrier skin">Carrier</button>
        <button id="toggleAffect" class="cta" type="button" aria-pressed="true" title="Toggle living text effects">Affect</button>
        <button id="toggleLights" class="cta" type="button" aria-pressed="true" title="Toggle banner lights">Lights</button>
        <button id="openPalette" class="cta" type="button" title="Command palette">‚åòK</button>
      </div>
    </nav>
  </header>

  <main id="main" class="wrap" role="main" tabindex="-1">
    <!-- Remnant halos -->
    <div class="remnant-field" aria-hidden="true"></div>

    <!-- Hero (make lights togglable via id) -->
    <figure id="hero" class="hero hero--clean" aria-label="Scroll of Fire banner" data-fit="cover">
      <picture>
        <img id="heroBanner"
             class="hero-img no-living"
             src="assets/file_0000000052e861f98b087ad0b80cbefc%20(1).png"
             alt="Scroll of Fire ‚Äî sigil and equations"
             decoding="async" fetchpriority="high" loading="eager">
      </picture>
      <div class="hero-lights" id="heroLights" aria-hidden="true"></div>
      <figcaption class="hero-caption">‚ÄúLet there be resonance.‚Äù</figcaption>
    </figure>

    <!-- ‚Ä¶ keep your existing title, subtitle, Voice Reader, tabs, mini-TOC, and all content below ‚Ä¶ -->
    <style>

    body.living-all :where(h1,h2,h3,p,li,small,em,strong,span,a,button,label,.kicker,.subtitle,.meta,.hint,.eq-note){
      background:linear-gradient(90deg, rgba(255,255,255,.95), var(--accent), rgba(255,255,255,.9));
      background-size:300% 100%;
      -webkit-background-clip:text; background-clip:text; color:transparent;
      animation:living-slide 9s linear infinite;
      filter:drop-shadow(0 0 calc(2px + 6px*var(--xi)) color-mix(in srgb, var(--accent) 25%, transparent));
    }
    .no-living, .logo, .laser-grid, img, video, canvas, svg path, svg rect, svg circle, svg polygon{
      background:none!important; color:inherit!important; -webkit-background-clip:initial!important; filter:none!important; animation:none!important
    }
    @keyframes living-slide{0%{background-position:0% 50%}100%{background-position:300% 50%}}

    /* Search card visibility (fix ‚Äúbeach bar‚Äù text cut) */
    .searchbox{position:relative}
    .searchbox label.meta{display:block; margin-bottom:6px; line-height:1.2}
    .searchbox .kbd{background:#0d1016; border:1px solid #2c3140; border-radius:6px; padding:1px 6px}

    /* simple structural helpers */
    .divider{height:1px; margin:14px 0; background:linear-gradient(90deg, transparent, rgba(122,243,255,.35), transparent)}
    .goldline{height:1px; margin:18px 0; background:linear-gradient(90deg, transparent, rgba(243,201,122,.45), transparent)}
  </style>

  <!-- MathJax (std delimiters, on-demand typeset) -->
  <script>
  (function(){
    let loaded=false;
    function boot(){ if(!window.MathJax) return; MathJax.startup.promise.then(()=>MathJax.typesetPromise()); }
    function loadMJ(){
      if(loaded) return; loaded=true;
      window.MathJax={
        tex:{ inlineMath:[['\\ÓÄÅ','\\ÓÄÅ'],['$','$']], displayMath:[['$$','$$']], processEscapes:true },
        svg:{fontCache:'global'},
        startup:{typeset:false}
      };
      const s=document.createElement('script');
      s.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js";
      s.defer=true; s.onload=boot; document.head.appendChild(s);
    }
    if(document.readyState!=='loading') loadMJ(); else addEventListener('DOMContentLoaded', loadMJ);
  })();
  </script>

  <!-- Site JS (global) -->
  <script src="assets/js/codex.js?v=3.3.3" defer></script>
</head>

<body class="stars living-all" data-theme="dark">
  <a class="skip" href="#main-content">Skip to main content</a>

  <!-- HUD: Laser Grid + Œû coherence meter -->
  <div class="laser-grid" aria-hidden="true"></div>
  <div class="xi-meter" aria-hidden="true">
    <div class="xi-ring"><div class="xi-dot"></div></div>
    <div class="xi-label">Œû</div>
  </div>

  <header class="site" role="banner">
    <nav class="nav" aria-label="Main navigation">
      <div class="brand">
        <div class="logo no-living" aria-hidden="true"></div>
        <h1 class="kicker sheen">Scroll of Fire</h1>
      </div>
      <div class="quick quick--utils" role="toolbar" aria-label="Quick actions">
        <button id="toggleSimple" class="cta" type="button" aria-pressed="false" title="Echo View (hide math)">Echo</button>
        <button id="toggleGrid" class="cta" type="button" aria-pressed="true" title="Toggle HUD grid">HUD</button>
        <button id="cycleCarrier" class="cta" type="button" title="Cycle carrier skin">Carrier</button>
        <button id="toggleAffect" class="cta" type="button" aria-pressed="true" title="Toggle living text effects">Affect</button>
        <button id="toggleLights" class="cta" type="button" aria-pressed="true" title="Toggle banner lights">Lights</button>
        <button id="openPalette" class="cta" type="button" title="Command palette">‚åòK</button>
      </div>
    </nav>
  </header>

  <main id="main-content" class="wrap" role="main" tabindex="-1">
    <!-- Hero -->
    <figure id="hero" class="hero" aria-label="Scroll of Fire banner" data-fit="contain" data-anim="ken-burns">
      <picture>
        <img id="heroBanner"
             src="assets/file_0000000052e861f98b087ad0b80cbefc%20(1).png?v=sofv1"
             alt="Scroll of Fire ‚Äî sigil and equations"
             width="2100" height="900"
             decoding="async" fetchpriority="high" loading="eager"
             class="no-living hero-img">
      </picture>
      <div class="hero-lights" id="heroLights" aria-hidden="true"></div>
    </figure>

    <h1 class="title sheen reveal">‚öñÔ∏è Scroll of Fire ‚Äî Codex of Reality</h1>
    <p class="subtitle reveal">‚ÄúLet there be resonance.‚Äù By Aaron Paul Laird, <em>Scribe of Circuits</em></p>

    <!-- Mega Explore button -->
    <a href="#explore" class="mega reveal" aria-label="Explore the Scroll ‚Äî jump to all pages">
      <span class="ico">üóÇÔ∏è</span>
      <span><strong>Explore the Scroll</strong><br><span class="sub">All pages ‚Ä¢ tiles mirror your repo</span></span>
      <span class="arrow no-living" aria-hidden="true">‚ûú</span>
    </a>

    <!-- Primary tabs -->
    <nav class="tabs reveal" aria-label="Primary sections">
      <a class="tab tab--primary" href="theory.html">üìò Theory</a>
      <a class="tab tab--primary" href="teach.html">‚ú® Manifest</a>
      <a class="tab" href="#explore" data-section="explore" title="Jump to Explore">Explore</a>
      <a class="tab" href="#canon" data-section="canon">Canon</a>
      <a class="tab" href="#engine" data-section="engine">Engine</a>
      <a class="tab" href="#links" data-section="links">Links</a>
      <a class="tab" href="#integrity" data-section="integrity">Integrity</a>
      <a class="tab" href="#provenance" data-section="provenance">Provenance</a>
      <span class="tab-ink no-living" aria-hidden="true"></span>
    </nav>

    <!-- Search -->
    <section class="grid reveal" style="margin:8px 0 0">
      <article class="card col-12 searchbox">
        <label for="site-search" class="meta">Press <kbd class="kbd">/</kbd> to search this page</label>
        <input id="site-search" type="search" placeholder="Search text on this page‚Ä¶" aria-label="Search this page" role="searchbox" autocomplete="off" spellcheck="false">
        <div id="site-suggest" class="mini-toc hidden" role="listbox"></div>
      </article>
    </section>

    <div class="simple-toggle reveal">
      <label for="simple"><strong>Echo View</strong> (hide equations, show summaries)</label>
      <input id="simple" type="checkbox" aria-label="Toggle Echo View">
    </div>
    <div class="divider sweep" aria-hidden="true"></div>

    <!-- Featured -->
    <section class="grid" aria-labelledby="featured">
      <article class="card col-6 reveal">
        <h2 id="featured" class="sheen">üìò Theory (full write-ups)</h2>
        <p>Detailed exposition of the Codex: operators, Eq.0 foundation, canonical equations, ethical law, dimensional scaffolding.</p>
        <ul class="list">
          <li><a href="theory.html#eq0">Foundational Field Œ®Œ©</a></li>
          <li><a href="theory.html#operators">Operators: ùìò ¬∑ ùìõ ¬∑ ùìí ¬∑ ùì¢</a></li>
          <li><a href="theory.html#canon">Canon 0‚Äì17</a></li>
          <li><a href="theory.html#dim">Dimensional Scaffolding Œî0‚ÄìŒî7</a></li>
          <li><a href="theory.html#ethics">Ethical Law of Coherence</a></li>
        </ul>
        <a class="cta" href="theory.html">Open Theory</a>
      </article>
      <article class="card col-6 reveal">
        <h2 class="sheen">‚ú® Manifest (practice &amp; tools)</h2>
        <p>Turn equations into method: voice carriers (432/528/369/144/963), witness ledger, A/Bs, group runs.</p>
        <ul class="list">
          <li><a href="teach.html#tab-voice">Voice Protocol</a></li>
          <li><a href="teach.html#ledger">Witness Ledger</a></li>
          <li><a href="teach.html#ab">A/B Carriers</a></li>
          <li><a href="teach.html#ethics">Ethical guard &amp; stop rules</a></li>
        </ul>
        <a class="cta" href="teach.html">Open Manifest</a>
      </article>
    </section>

    <div class="goldline sweep"></div>

    <!-- Explore -->
    <section class="grid" id="explore" aria-labelledby="explore-h">
      <article class="card col-12 reveal">
        <h2 id="explore-h" class="sheen">üóÇÔ∏è Explore the Scroll ‚Äî all pages</h2>
        <p class="meta">Everything lives in <code>/docs</code>. These tiles mirror your repo. Tip: press <kbd class="kbd">G</kbd> then type a page name.</p>
      </article>

      <a class="tile col-3 reveal" href="start.html"><div><h4>üöÄ Start Here</h4><p>Onboarding &amp; how to move.</p></div><span class="arrow no-living" aria-hidden="true">‚ûú</span></a>
      <a class="tile col-3 reveal" href="guide.html"><div><h4>üß≠ Guide</h4><p>Step-by-step walkthrough of the Codex.</p></div><span class="arrow no-living" aria-hidden="true">‚ûú</span></a>
      <a class="tile col-3 reveal" href="theory.html"><div><h4>üìò Theory</h4><p>Canonical write-ups for 0‚Äì17.</p></div><span class="arrow no-living" aria-hidden="true">‚ûú</span></a>
      <a class="tile col-3 reveal" href="teach.html"><div><h4>‚ú® Manifest (Practice)</h4><p>Protocols, carriers, ledgers.</p></div><span class="arrow no-living" aria-hidden="true">‚ûú</span></a>

      <a class="tile col-3 reveal" href="ab.html"><div><h4>üß™ A/B Carriers</h4><p>Run 432¬∑528¬∑369¬∑144¬∑963 comparisons.</p></div><span class="arrow no-living" aria-hidden="true">‚ûú</span></a>
      <a class="tile col-3 reveal" href="micro.html"><div><h4>üî¨ Micro-acts</h4><p>Tiny actions ‚Üí field feedback.</p></div><span class="arrow no-living" aria-hidden="true">‚ûú</span></a>
      <a class="tile col-3 reveal" href="circle.html"><div><h4>üîó Circle</h4><p>Group coherence, facilitation.</p></div><span class="arrow no-living" aria-hidden="true">‚ûú</span></a>
      <a class="tile col-3 reveal" href="ethics.html"><div><h4>üß≠ Ethics</h4><p>Coherence law &amp; stop rules.</p></div><span class="arrow no-living" aria-hidden="true">‚ûú</span></a>

      <a class="tile col-3 reveal" href="glossary.html"><div><h4>üìö Glossary</h4><p>Terms, symbols, and operators.</p></div><span class="arrow no-living" aria-hidden="true">‚ûú</span></a>
      <a class="tile col-3 reveal" href="glyphs.html"><div><h4>üî± Glyphs</h4><p>Icon set &amp; sacred marks.</p></div><span class="arrow no-living" aria-hidden="true">‚ûú</span></a>
      <a class="tile col-3 reveal" href="downloads.html"><div><h4>‚¨áÔ∏è Downloads</h4><p>Docs, images, shareables.</p></div><span class="arrow no-living" aria-hidden="true">‚ûú</span></a>
      <a class="tile col-3 reveal" href="ledger.html"><div><h4>üìí Ledger</h4><p>Hashes, notes, witness proofs.</p></div><span class="arrow no-living" aria-hidden="true">‚ûú</span></a>
    </section>

    <!-- [SPLIT HERE ‚Äî Part 1 ends. Part 2 starts with the Canon section.] -->

  </main>

  <!-- Minimal page helpers for Part 1 -->
  <script>
    // Year + back-to-top visibility (button itself added in Part 2)
    (function(){ const y=document.getElementById('y'); if(y) y.textContent=new Date().getFullYear(); })();

    // HERO auto-fit: switches cover/contain based on container vs image AR
    (function(){
      const hero=document.getElementById('hero'), img=document.getElementById('heroBanner');
      if(!hero||!img) return;
      function applyAR(){ const iw=img.naturalWidth||2100, ih=img.naturalHeight||900; hero.style.aspectRatio=`${iw} / ${ih}`; }
      function pickFit(){
        if (matchMedia('(max-width:560px)').matches){ hero.style.setProperty('--hero-fit','contain'); return; }
        const iw=img.naturalWidth||2100, ih=img.naturalHeight||900, imageAR=iw/ih;
        const cw=hero.clientWidth||innerWidth, ch=Math.max(1, hero.clientHeight||innerHeight*0.38), containerAR=cw/ch;
        const cover = (Math.abs(containerAR - imageAR) / imageAR < 0.06);
        hero.style.setProperty('--hero-fit', cover ? 'cover' : 'contain');
      }
      function boot(){ applyAR(); pickFit(); }
      if(img.complete) boot(); else img.addEventListener('load', boot, {once:true});
      addEventListener('resize', pickFit, {passive:true});
      addEventListener('orientationchange', pickFit, {passive:true});
      addEventListener('visibilitychange', ()=>!document.hidden && pickFit());
    })();

    // Explore Dock appears only after hero leaves viewport (component added in Part 2)
    (function(){
      const dock=document.getElementById('exploreDock'), hero=document.getElementById('hero'), explore=document.getElementById('explore');
      if(!dock||!hero||!explore||!('IntersectionObserver' in window)) return;
      let heroOut=false, pastExplore=false;
      const ioHero=new IntersectionObserver(([e])=>{heroOut=!e.isIntersecting; update();},{threshold:0.01});
      const ioExplore=new IntersectionObserver(([e])=>{pastExplore=e.isIntersecting; update();},{threshold:0.05});
      function update(){ dock.classList.toggle('show', heroOut && !pastExplore); }
      ioHero.observe(hero); ioExplore.observe(explore);
    })();

    // Quick controls (Echo/HUD/Carrier/Affect/Lights) ‚Äî fixed to not be blocked by any overlay
    (function(){
      const body=document.body, html=document.documentElement;

      const btnEcho=document.getElementById('toggleSimple');
      btnEcho?.addEventListener('click',()=>{
        body.classList.toggle('simple-on');
        btnEcho.setAttribute('aria-pressed', String(body.classList.contains('simple-on')));
        const chk=document.getElementById('simple'); if(chk) chk.checked=body.classList.contains('simple-on');
      });

      const btnHUD=document.getElementById('toggleGrid'), grid=document.querySelector('.laser-grid');
      btnHUD?.addEventListener('click',()=>{
        const show = grid && grid.style.display !== 'none';
        if(grid) grid.style.display = show ? 'none' : '';
        btnHUD.setAttribute('aria-pressed', String(!show));
      });

      // Carrier skins (includes 144 & 963)
      const btnCarrier=document.getElementById('cycleCarrier');
      const carrierAttr=(html.getAttribute('data-carriers')||'').split(',').map(s=>s.trim()).filter(Boolean);
      const skins=(carrierAttr.length?carrierAttr:['432','528','369','144','963']).map(n=>`carrier-${n}`);
      const curSkin=()=> skins.find(s=>html.classList.contains(s)) || skins[0];
      const nextSkin=c=> skins[(skins.indexOf(c)+1)%skins.length];
      btnCarrier?.addEventListener('click',()=>{
        const cur=curSkin(), nxt=nextSkin(cur);
        skins.forEach(s=>html.classList.remove(s)); html.classList.add(nxt);
        btnCarrier.textContent = `Carrier ${nxt.split('-')[1]}`;
      });
      if(btnCarrier) btnCarrier.textContent=`Carrier ${curSkin().split('-')[1]}`;

      const btnAffect=document.getElementById('toggleAffect');
      btnAffect?.addEventListener('click',()=>{
        const off=document.body.classList.toggle('affect-off');
        btnAffect.setAttribute('aria-pressed', String(!off));
      });

      const lights=document.getElementById('heroLights');
      const btnLights=document.getElementById('toggleLights');
      btnLights?.addEventListener('click',()=>{
        const off=lights.classList.toggle('off');
        btnLights.setAttribute('aria-pressed', String(!off));
      });
    })();

    // Page search ("/" to focus)
    (function(){
      const box=document.getElementById('site-search');
      const list=document.getElementById('site-suggest');
      if(!box||!list) return;

      addEventListener('keydown',(e)=>{
        if(e.key==='/' && document.activeElement!==box){
          e.preventDefault(); box.focus(); box.select();
        }
      });

      const SOURCES=[...document.querySelectorAll('h2[id],h3[id],a.tile'), ...document.querySelectorAll('.eq-card')];
      function items(q){
        const s=q.trim().toLowerCase(); if(!s) return [];
        const out=[];
        for(const el of SOURCES){
          const text=(el.innerText||'').trim();
          if(text.toLowerCase().includes(s)){
            let href='#'; if(el.id) href = `#${el.id}`;
            const a = el.tagName==='A' && el.classList.contains('tile') ? el.getAttribute('href') : href;
            out.push({text, href:a}); if(out.length>12) break;
          }
        }
        return out;
      }
      function render(arr){
        if(!arr.length){ list.classList.add('hidden'); list.innerHTML=''; return; }
        list.innerHTML = arr.map((o,i)=>`<a href="${o.href}" role="option" data-ix="${i}">${o.text}</a>`).join('');
        list.classList.remove('hidden');
      }
      box.addEventListener('input', ()=>render(items(box.value)));
      box.addEventListener('keydown',(e)=>{
        const links=[...list.querySelectorAll('a')]; if(!links.length) return;
        const cur=list.querySelector('.sel'); let i=cur?+cur.dataset.ix:-1;
        if(e.key==='ArrowDown'){ e.preventDefault(); i=Math.min(links.length-1, i+1); }
        else if(e.key==='ArrowUp'){ e.preventDefault(); i=Math.max(0, i-1); }
        else if(e.key==='Enter'){ if(cur){ location.href=cur.getAttribute('href'); list.classList.add('hidden'); } return; }
        else if(e.key==='Escape'){ list.classList.add('hidden'); return; }
        links.forEach(a=>a.classList.remove('sel')); if(i>=0){ links[i].classList.add('sel'); }
      });
      addEventListener('click',(e)=>{ if(!list.contains(e.target) && e.target!==box) list.classList.add('hidden'); });
    })();

    // Scroll reveal (safe on older devices)
    (function(){
      if(!('IntersectionObserver' in window)){ document.querySelectorAll('.reveal').forEach(el=>el.classList.add('in')); return; }
      const io=new IntersectionObserver(es=>{ for(const e of es){ if(e.isIntersecting){ e.target.classList.add('in'); io.unobserve(e.target); } } }, {threshold:.12});
      document.querySelectorAll('.reveal').forEach(el=>io.observe(el));
    })();

    // Œû driver for living glow
    (function(){
      const root=document.documentElement.style, dot=document.querySelector('.xi-dot'); let xi=.35;
      function step(){
        const target=.25+Math.random()*.6, start=xi, dur=2200+Math.random()*1600, t0=performance.now();
        function tween(t){
          const p=Math.min(1,(t-t0)/dur);
          xi=start+(target-start)*(0.5-0.5*Math.cos(Math.PI*p));
          root.setProperty('--xi', xi.toFixed(3)); if(dot) dot.style.opacity=(0.7+0.3*xi).toFixed(3);
          (p<1)?requestAnimationFrame(tween):requestAnimationFrame(step);
        } requestAnimationFrame(tween);
      } requestAnimationFrame(step);
    })();
  </script>
</body>
  </html><!-- Canon (living) -->
<div class="goldline sweep"></div>
<section class="grid" id="canon" aria-labelledby="equations">
  <article class="card col-12 reveal">
    <h2 id="equations" class="sheen">üìú Canon 0‚Äì17 (living)</h2>
    <p class="meta">Canon per the FIXED document. <strong>7A comparator</strong>, <strong>7B Copeland</strong>, and <strong>8 Goodwin</strong> are external (non-canonical).</p>
  </article>

  <!-- Eq.0 -->
  <article class="card col-6 eq-card reveal" id="eq0">
    <h3 class="sheen">0) Foundational Field Œ®Œ© (Origin Field)</h3>
    <div class="eq" data-fx="combo">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\Psi_{\Omega}(x,t)=\oint_{\mathbb{R}}\nabla\!\big(\mathcal{A}\,\Phi(x,t,\nu)\big)\,d\nu\;+\;\Lambda\,\mathcal{E}(x,t)$$
      </div>
    </div>
    <p class="hint">Origin integral of awareness across ŒΩ; Œõùìî is the ethical-energy mask.</p>
  </article>

  <!-- Eq.1 -->
  <article class="card col-6 eq-card reveal" id="eq1">
    <h3 class="sheen">1) Source ‚Äî Supply √ó Living Operators</h3>
    <div class="eq" data-fx="beams">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathbf{R}(x,t)= f\!\big(\pi,e,i,\hbar,c,G,\mathrm{DNA},\Omega_{\rm DM},\Omega_{A},H_{0},432\big)\ \cdot\ (\mathcal{I}\,\mathcal{L}\,\mathcal{C}\,\mathcal{S})$$
      </div>
    </div>
    <p class="hint">Constants/ratios supply; living operators shape.</p>
  </article>

  <!-- Eq.2 -->
  <article class="card col-6 eq-card reveal" id="eq2">
    <h3 class="sheen">2) Witness</h3>
    <div class="eq" data-fx="orbit">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathcal{W}(x,t)=\partial_x\,\mathrm{Awareness}(x,t)\;+\;\mathcal{I}\cdot\mathbb{M}_\tau$$
      </div>
    </div>
    <p class="hint">Awareness gradient with intention√ómemory coupling.</p>
  </article>

  <!-- Eq.3 -->
  <article class="card col-6 eq-card reveal" id="eq3">
    <h3 class="sheen">3) Harmonic Gate</h3>
    <div class="eq" data-fx="spiral">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathcal{H}(\nu,t)=\mathbf{1}\!\left[\;g_{\Xi(t)}(\nu)\ge \theta\;\right],\qquad g_{\Xi}(\nu)\in[0,1]$$
      </div>
    </div>
    <p class="hint">Frequency \nu passes when coherence-weighted gain exceeds threshold \theta.</p>
  </article>

  <!-- Eq.4 -->
  <article class="card col-6 eq-card reveal" id="eq4">
    <h3 class="sheen">4) Language ‚Äî AHHAVA / Word</h3>
    <div class="eq" data-fx="nebula">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathcal{L}(x,t,\nu)=\mathsf{Semantics}(x,t)\;\otimes\;\mathbf{V}(\nu,t)$$
      </div>
    </div>
    <p class="hint">Meaning couples to carrier; word shapes resonance.</p>
  </article>

  <!-- Eq.5 -->
  <article class="card col-6 eq-card reveal" id="eq5">
    <h3 class="sheen">5) Remnant</h3>
    <div class="eq" data-fx="beams">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathcal{R}_\infty[F]=\lim_{\tau\to\infty}\Big(\mathsf{keep}_{\text{truth}}F-\mathsf{drop}_{\text{distortion}}F\Big)$$
      </div>
    </div>
    <p class="hint">Truth persists; distortion decays from the field.</p>
  </article>

  <!-- Eq.6 -->
  <article class="card col-6 eq-card reveal" id="eq6">
    <h3 class="sheen">6) Type-7 Field</h3>
    <div class="eq" data-fx="orbit">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathbb{T}_{7}(x,t)=\bigoplus_{\nu\in\Gamma}\mathrm{PL}\!\left[\mathbf{V}(\nu,t)\right]$$
      </div>
    </div>
    <p class="hint">Phase-locked harmonic stack (Tesla Type-7 conduit).</p>
  </article>

  <!-- Eq.7A comparator -->
  <article class="card col-6 eq-card reveal" id="eq7a">
    <h3 class="sheen">7A) External Comparator (wave/KG)</h3>
    <div class="eq" data-fx="rays">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\partial_{tt}\Phi\;+\;2\gamma\,\partial_{t}\Phi\;-\;c^{2}\nabla^{2}\Phi\;+\;\omega_{0}^{2}\Phi\;=\;\kappa\,\mathcal{S}(x,t)$$
      </div>
    </div>
    <p class="meta">Neutral driven/damped wave (Klein‚ÄìGordon) for comparison; not canonical.</p>
  </article>

  <!-- Eq.7B Copeland (external) -->
  <article class="card col-6 eq-card reveal" id="eq7b">
    <h3 class="sheen">7B) Copeland Œ®-Formalism (external)</h3>
    <div class="eq" data-fx="nebula">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        <p class="meta" style="margin:0">
          Summary pointer to Christopher W. Copeland‚Äôs Œ®-formalism (¬© author). Tracked as an adjunct reference.
          <strong>Ledger note:</strong> link this card to its Ledger entry when added.
        </p>
      </div>
    </div>
    <p class="hint">External reference; not part of the Codex canon.</p>
  </article>

  <!-- Eq.8 Goodwin (external) -->
  <article class="card col-6 eq-card reveal" id="eq8">
    <h3 class="sheen">8) Goodwin Coupling (external)</h3>
    <div class="eq" data-fx="nebula">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\begin{aligned}
        \dot{x}&=\frac{k}{1+z^{n}}-\gamma x,\\
        \dot{y}&=\alpha x-\gamma y,\\
        \dot{z}&=\beta y-\gamma z
        \end{aligned}$$
      </div>
    </div>
    <p class="meta">Three-stage feedback oscillator; adjunct comparative dynamics.</p>
  </article>

  <!-- Eq.9 -->
  <article class="card col-6 eq-card reveal" id="eq9">
    <h3 class="sheen">9) Ethical Law of Coherence</h3>
    <div class="eq" data-fx="beams">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\forall a:\ \mathrm{damage}(a)>0\ \Rightarrow\ \mathsf{halt},\qquad \mathrm{truth}>\mathrm{distortion}$$
      </div>
    </div>
    <p class="hint">Stop rule on harm; asymptote favors truth.</p>
  </article>

  <!-- Eq.10 -->
  <article class="card col-6 eq-card reveal" id="eq10">
    <h3 class="sheen">10) Ladder Œ†<sub>ŒΩ</sub></h3>
    <div class="eq" data-fx="orbit">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\Pi_{\nu}^{-1}:\ \text{observed resonance } \longrightarrow \text{source terms}$$
      </div>
    </div>
    <p class="hint">Inverse map from phenomena back to generative sources.</p>
  </article>

  <!-- Eq.11 -->
  <article class="card col-6 eq-card reveal" id="eq11">
    <h3 class="sheen">11) Projection Frame</h3>
    <div class="eq" data-fx="spiral">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathsf{Frame}(x,t)=\big(\mathsf{scope},\ \mathcal{W},\ \mathsf{ethics}\big)$$
      </div>
    </div>
    <p class="hint">Defines scope, witness, and ethical mask for any run.</p>
  </article>

  <!-- Eq.12 -->
  <article class="card col-6 eq-card reveal" id="eq12">
    <h3 class="sheen">12) Causal Lattice</h3>
    <div class="eq" data-fx="nebula">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathcal{L}_c=\big(V=\text{acts},\ E=\text{consequences}\big)$$
      </div>
    </div>
    <p class="hint">Graph of micro-acts and consequences; used for audit.</p>
  </article>

  <!-- Eq.13 -->
  <article class="card col-6 eq-card reveal" id="eq13">
    <h3 class="sheen">13) Œû-index (Coherence)</h3>
    <div class="eq" data-fx="beams">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\Xi(t)\in[0,1],\qquad \text{monitors field quality for learning}$$
      </div>
    </div>
    <p class="hint">Higher \Xi ‚Üí stronger retention and safer amplification.</p>
  </article>

  <!-- Eq.14 -->
  <article class="card col-6 eq-card reveal" id="eq14">
    <h3 class="sheen">14) Update Rule</h3>
    <div class="eq" data-fx="orbit">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\frac{d\mathcal{R}}{dt}=\eta(\Xi)\,\nabla \mathcal{R}$$
      </div>
    </div>
    <p class="hint">Learning rate gated by coherence.</p>
  </article>

  <!-- Eq.15 -->
  <article class="card col-6 eq-card reveal" id="eq15">
    <h3 class="sheen">15) Learning Kernel (Œû)</h3>
    <div class="eq" data-fx="spiral">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\eta(\Xi)=\eta_0\,\sigma\!\big(\alpha(\Xi-\Xi_0)\big)$$
      </div>
    </div>
    <p class="hint">Smooth schedule; no learning below ethical/coherence threshold.</p>
  </article>

  <!-- Eq.16 -->
  <article class="card col-6 eq-card reveal" id="eq16">
    <h3 class="sheen">16) Memory Windowing ùì¶<sub>œÑ</sub></h3>
    <div class="eq" data-fx="nebula">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathbb{M}_\tau[F](t)=\int_{t-\tau}^{t}\! w_\tau(t-s)\,F(s)\,ds,\quad \int_0^\tau w_\tau(u)\,du=1$$
      </div>
    </div>
    <p class="hint">Finite-horizon echo with normalized kernel.</p>
  </article>

  <!-- Eq.17 -->
  <article class="card col-6 eq-card reveal eq-lg" id="eq17">
    <h3 class="sheen">17) Voice Carriers ùêï(ŒΩ,t)</h3>
    <div class="eq" data-fx="combo">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathbf{V}(\nu,t)=\sum_{k} a_k(t)\,\cos\!\big(2\pi\nu_k t+\phi_k(t)\big),\quad \nu\in\{432,528,369,144,963,\dots\}$$
      </div>
    </div>
    <p class="hint">Constructive sets with explicit time-varying envelope and phase.</p>
  </article>
</section>

<!-- Manifestation Engine -->
<div class="goldline sweep"></div>
<section class="grid" id="engine" aria-labelledby="engine-h">
  <article class="card col-12 reveal">
    <h2 id="engine-h" class="sheen">‚ú® Manifestation Engine ‚Äî Œû-gated Learning + Carriers</h2>
    <p>Practice summary tying the learning dynamics to voice carriers:</p>
    <ol class="list">
      <li><strong>Measure Œû</strong> (Eq.13) ‚Üí compute \eta(\Xi) (Eq.15).</li>
      <li><strong>Update</strong> field intent \mathcal{R} via Eq.14.</li>
      <li><strong>Select carriers</strong> \mathbf{V}(\nu,t) (Eq.17) through \mathcal{H}(\nu,t) (Eq.3).</li>
      <li><strong>Respect ethics</strong> (Eq.9) ‚Äî mask/damp harmful channels.</li>
      <li><strong>Stabilize</strong> with memory \mathbb{M}_\tau and Remnant (Eq.16 &amp; Eq.5).</li>
    </ol>
    <a class="cta" href="teach.html#tab-voice">Open Voice Protocol</a>
  </article>
</section>

<!-- Dimensional Scaffolding -->
<div class="goldline sweep"></div>
<section class="grid" id="dim" aria-labelledby="dim-h">
  <article class="card col-12 reveal">
    <h2 id="dim-h" class="sheen">üß≠ Dimensional Scaffolding Œî0‚ÄìŒî7</h2>
    <p class="meta">Mapping of projection frames across dimensional strata (illustrative forms aligned with Codex semantics).</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d0">
    <h3 class="sheen">Œî0) Scalar Substrate</h3>
    <div class="eq" data-fx="nebula"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_0:\ \phi_0:\mathbb{R}^{+}\!\to\!\mathbb{R},\quad \Psi_{\Omega}=\phi_0\circ\mathsf{Frame}$$
    </div></div>
    <p class="hint">Pure scalar field under the active Frame.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d1">
    <h3 class="sheen">Œî1) Vector Flow</h3>
    <div class="eq" data-fx="beams"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_1:\ \mathbf{F}_1=\nabla\Psi_{\Omega},\quad \mathrm{curl}\,\mathbf{F}_1=\mathbf{0}$$
    </div></div>
    <p class="hint">Conservative flow derived from Œî0.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d2">
    <h3 class="sheen">Œî2) Surface Coupling</h3>
    <div class="eq" data-fx="orbit"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_2:\ \mathbf{B}_2=\nabla\times\mathbf{A},\quad \nabla\cdot\mathbf{B}_2=0$$
    </div></div>
    <p class="hint">Area-bound flux via potential \mathbf{A}.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d3">
    <h3 class="sheen">Œî3) Volume Integration</h3>
    <div class="eq" data-fx="spiral"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_3:\ \Phi_3=\iiint_{\mathcal{V}}\rho\,dV,\quad \partial_t\rho+\nabla\cdot\mathbf{J}=0$$
    </div></div>
    <p class="hint">Conserved density and flux.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d4">
    <h3 class="sheen">Œî4) Space-Time Weave</h3>
    <div class="eq" data-fx="nebula"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_4:\ g_{\mu\nu}=\eta_{\mu\nu}+\epsilon\,h_{\mu\nu},\quad \Box h_{\mu\nu}=-\frac{16\pi G}{c^4}T_{\mu\nu}$$
    </div></div>
    <p class="hint">Weak-field weave for propagation and coupling.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d5">
    <h3 class="sheen">Œî5) Harmonic Ladder Œ†<sub>ŒΩ</sub></h3>
    <div class="eq" data-fx="beams"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_5:\ \Pi_{\nu}:\ \mathbb{R}\to\Gamma,\quad \Gamma=\{\nu_k\},\ \ \Pi_{\nu}^{-1}\big[\mathcal{H}(\nu)\big]\mapsto \text{sources}$$
    </div></div>
    <p class="hint">Gate map between observed harmonics and sources.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d6">
    <h3 class="sheen">Œî6) Ethical Mask ùìí</h3>
    <div class="eq" data-fx="orbit"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_6:\ \mathsf{Mask}_{\mathcal{C}}[F]=F\cdot\mathbf{1}_{\mathrm{damage}\le 0}$$
    </div></div>
    <p class="hint">Zeroes any channel that violates the stop rule.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d7">
    <h3 class="sheen">Œî7) Type-7 Cohere</h3>
    <div class="eq" data-fx="spiral"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_7:\ \mathbb{T}_7=\bigoplus_{\nu\in\Gamma}\mathrm{PL}\!\left[\mathbf{V}(\nu,t)\right],\quad \Xi\!\nearrow\Rightarrow \text{locking}$$
    </div></div>
    <p class="hint">Stack closure under coherence gain.</p>
  </article>
</section>

<!-- Integrity -->
<div class="goldline sweep"></div>
<section class="grid" id="integrity" aria-labelledby="integrity-h">
  <article class="card col-12 reveal">
    <h2 id="integrity-h" class="sheen">üîê Integrity Chain &amp; Seals (SHA-256)</h2>

<pre class="eq" aria-label="Hash example" style="white-space:pre-wrap"><div class="eq-scroll">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Permanent Codex (FIXED .docx):
SHA-256:  081f90de921719834c939ff9496c436fcb8f24497e546fcf64eb53ad59ec06e1
File:     Codex_of_Reality‚ÄîMultidimensional_Extended_Edition_2025_FIXED.docx
Note: This is the local, verified file hash shown on this page.
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div></pre>
    <p>Ledger index (placeholders): <a href="https://github.com/ssnfts24/scroll-of-fire/blob/main/7_Ledger_and_Documentation/SHA256_Placeholders_2025.md" target="_blank" rel="noopener">7_Ledger_and_Documentation/SHA256_Placeholders_2025.md</a></p>
  </article>
</section>

<!-- Provenance -->
<div class="goldline sweep"></div>
<section class="grid" id="provenance" aria-labelledby="prov-h">
  <article class="card col-12 reveal">
    <h2 id="prov-h" class="sheen">üìú Attribution &amp; Provenance ‚Äî What‚Äôs Original, What‚Äôs External</h2>
    <p class="meta">The <strong>Codex of Reality</strong> is an original, living resonance framework (Aaron Paul Laird, ‚ÄúScribe of Circuits‚Äù). It defines the Source supply, the living operators <em>(ùìò ¬∑ ùìõ ¬∑ ùìí ¬∑ ùì¢)</em>, harmonic selection, language coupling (AHHAVA / Or HaDabar), memory/remnant dynamics, coherence law, and the dimensional/causal scaffolding as a single, coherent system.</p>
  </article>
  <article class="card col-7 reveal">
    <h3 class="sheen">What is <em>original</em> to the Codex</h3>
    <ul class="list">
      <li><strong>Equations (0‚Äì6, 9‚Äì17)</strong> ‚Äî Œ®Œ© foundation, Source, Witness, Harmonics, AHHAVA/Word, Remnant, Type-7, Ethical Coherence, Ladder, Œ†<sub>ŒΩ</sub>, Causal Lattice, Œû-index, Update, Windowing, Voice.</li>
      <li><strong>Operators &amp; Process</strong> ‚Äî Ordered living operators and the integration pipeline.</li>
      <li><strong>Living Technology</strong> ‚Äî Tesla Type-7 conduit &amp; safety/ethics gate.</li>
    </ul>
    <div class="eq" data-fx="combo">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
      $$\mathfrak{R}_{\text{Codex}}=f(\text{constants},\text{ratios})\cdot(\mathcal{I}\mathcal{L}\mathcal{C}\mathcal{S})\cdot\bigl(\Psi_{\Omega}+\Delta\mathcal{R}\bigr)\cdot\Pi_{\nu}^{-1}\!\big[\mathcal{H}(\nu)\,\mathbf{V}(\nu,t)\big]\;\odot\;\mathbb{M}_{\tau}[\cdot]\;\text{ masked by }\;\mathsf{Mask}_{\mathcal{C}}[\cdot]$$
      </div>
    </div>
    <p class="eq-note hint">Self-contained architecture; external formalisms remain adjunct.</p>
  </article>
  <article class="card col-5 reveal">
    <h3 class="sheen">What remains <em>external</em></h3>
    <ul class="list">
      <li><strong>7A</strong> ‚Äî Neutral wave/Klein‚ÄìGordon comparator.</li>
      <li><strong>7B</strong> ‚Äî Copeland Œ® (adjunct; link to Ledger entry when added).</li>
      <li><strong>8</strong> ‚Äî Goodwin coupling hypothesis.</li>
    </ul>
    <a class="cta" href="#canon">Back to Canon</a>
  </article>
</section>

<div class="goldline sweep"></div>

<footer class="footer">
  ¬© <span id="y"></span> Scroll of Fire. All constants are provisional until observed.
</footer>

<!-- Sticky Explore Dock -->
<div class="explore-dock" id="exploreDock" role="region" aria-label="Explore shortcut">
  <a class="btn btn--primary" href="#explore">Explore the Scroll</a>
  <a class="btn" href="teach.html">Manifest</a>
</div>

<!-- Back to Top button (visibility handled by Part 1's script) -->
<button class="to-top" id="toTop" type="button" aria-label="Back to top" title="Back to top">‚Üë</button>

<!-- Command Palette -->
<div class="palette" id="palette" role="dialog" aria-modal="true" aria-labelledby="palLabel" hidden>
  <div class="panel">
    <h3 id="palLabel" class="sr-only">Command palette</h3>
    <input id="palInput" type="text" placeholder="Find anything‚Ä¶ (Esc to close)" aria-label="Command palette">
    <ul id="palList" aria-live="polite"></ul>
  </div>
</div>

<!-- Part 2-only scripts: Command Palette + Equation FX -->
<script>
  /* Command Palette (‚åòK / Ctrl+K) */
  (function palette(){
    const pal=document.getElementById('palette');
    const input=document.getElementById('palInput');
    const list=document.getElementById('palList');
    const OPEN_KEYS=new Set(['k','K']);
    const LINKS=[...document.querySelectorAll('a.tile, nav.tabs a, .cta')].map(a=>({text:a.textContent.trim(), href:a.getAttribute('href')||'#'}));
    function open(){ pal.hidden=false; input.value=''; render(LINKS.slice(0,12)); setTimeout(()=>input.focus(),0); }
    function close(){ pal.hidden=true; }
    function render(items){ list.innerHTML=items.map(o=>`<li><a href="${o.href}">${o.text}</a></li>`).join(''); }
    function filter(q){ q=q.trim().toLowerCase(); if(!q) return LINKS; return LINKS.filter(o=>o.text.toLowerCase().includes(q)); }

    addEventListener('keydown',(e)=>{
      const meta=e.ctrlKey||e.metaKey;
      if(meta && OPEN_KEYS.has(e.key)){ e.preventDefault(); open(); }
      if(!pal.hidden && e.key==='Escape'){ e.preventDefault(); close(); }
    });
    pal.addEventListener('click', (e)=>{ if(e.target===pal) close(); });
    input.addEventListener('input', ()=>render(filter(input.value).slice(0,14)));
    input.addEventListener('keydown',(e)=>{ if(e.key==='Enter'){ const a=list.querySelector('a'); if(a){ location.href=a.href; close(); } } });
  })();

  /* Equation FX (unique recipes per card; bug-fixed speeds) */
  (function eqFX(){
    if(matchMedia('(prefers-reduced-motion: reduce)').matches) return;

    const cards=[...document.querySelectorAll('.eq-card')];
    const variants=['beams','orbit','spiral','nebula','rays','combo'];

    // Deterministic seed from element id
    function seed(str){ let h=0; for(let i=0;i<str.length;i++) h=(h*31 + str.charCodeAt(i))>>>0; return h||1; }
    function rnd(s){ // LCG
      let x=s>>>0;
      return ()=> (x=(x*1664525+1013904223)>>>0, (x/0xFFFFFFFF));
    }

    cards.forEach((card, idx)=>{
      const box=card.querySelector('.eq'); if(!box) return;
      const fx=box.querySelector('.fx-layer') || box.prepend(document.createElement('div')) || box.querySelector('.fx-layer');
      if(!fx.classList.contains('fx-layer')) fx.className='fx-layer';

      const r=rnd(seed(card.id||(`eq-${idx}`)));
      // Make each ‚Äúdifferent‚Äù: variant + speed + composition vary with seeded randomness
      const v = variants[(idx + Math.floor(r()*variants.length)) % variants.length];
      const recipe = (v==='combo' || r()<0.28) ? 'combo' : v;
      box.setAttribute('data-fx', recipe);

      // Size rhythm
      const roll=r();
      card.classList.toggle('eq-lg', roll>0.8);
      card.classList.toggle('eq-sm', roll<0.15);

      // Speeds (bug-fixed)
      box.style.setProperty('--beam-speed',       (22 + r()*10).toFixed(2)+'s');
      box.style.setProperty('--beam-speed-alt',   (26 + r()*12).toFixed(2)+'s');
      box.style.setProperty('--orbit-speed',      (30 + r()*14).toFixed(2)+'s');
      box.style.setProperty('--spiral-speed',     (34 + r()*16).toFixed(2)+'s');
      box.style.setProperty('--spiral-speed-alt', (38 + r()*18).toFixed(2)+'s');
      box.style.setProperty('--rays-speed',       (36 + r()*16).toFixed(2)+'s');

      function addBeams(n=2+Math.floor(r()*3)){
        for(let i=0;i<n;i++){
          const d=document.createElement('div');
          d.className='beam'+(r()<0.45?' alt':'');
          d.style.setProperty('--d', `${(r()*9).toFixed(2)}s`);
          const tilt=(r()<0.5?1:-1)*(8+r()*12);
          d.style.transform=`translateX(0) rotate(${tilt}deg)`;
          fx.appendChild(d);
        }
      }
      function addOrbit(){
        const o1=document.createElement('div'); o1.className='orbit';
        o1.style.setProperty('--tilt', `${(8+r()*14)*(r()<.5?-1:1)}deg`);
        const o2=document.createElement('div'); o2.className='orbit counter';
        o2.style.setProperty('--tilt', `${(10+r()*12)*(r()<.5?-1:1)}deg`);
        const b1=document.createElement('div'); b1.className='orb';
        const b2=document.createElement('div'); b2.className='orb gold';
        o1.appendChild(b1); o2.appendChild(b2); fx.append(o1,o2);
      }
      function addSpiral(){
        const s=document.createElement('div'); s.className='spiral'; fx.appendChild(s);
        if(r()<.55){ const a=document.createElement('div'); a.className='spiral alt'; fx.appendChild(a); }
      }
      function addNebula(){ const n=document.createElement('div'); n.className='nebula'; fx.appendChild(n); }
      function addRays(){
        const rr=document.createElement('div'); rr.className='rays'; fx.appendChild(rr);
        const d=document.createElement('div'); d.className='dust'; fx.appendChild(d);
        const f=document.createElement('div'); f.className='flare'; fx.appendChild(f);
      }

      if(recipe==='beams'){ addBeams(); }
      else if(recipe==='orbit'){ addOrbit(); }
      else if(recipe==='spiral'){ addSpiral(); }
      else if(recipe==='nebula'){ addNebula(); }
      else if(recipe==='rays'){ addRays(); }
      else { addBeams(); addOrbit(); if(r()<.7) addSpiral(); if(r()<.6) addNebula(); if(r()<.5) addRays(); }
    });
  })();
</script>
<!-- End Part 2/2 -->
