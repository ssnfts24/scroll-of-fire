<!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>Scroll of Fire — Codex of Reality</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Dark theme to prevent white flashes -->
  <meta name="theme-color" content="#0b0b0f" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#0b0b0f">
  <meta name="color-scheme" content="dark">

  <!-- SEO -->
  <meta name="description" content="The Scroll of Fire — a living Codex of Reality by Aaron Paul Laird (Scribe of Circuits): where resonance physics, sacred geometry, language, memory, living technology, and ethics interlock into one harmonic architecture." />
  <meta name="author" content="Aaron Paul Laird" />
  <meta name="keywords" content="Scroll of Fire, Codex of Reality, Aaron Paul Laird, Resonance, Sacred Geometry, Witness, AHHAVA, Or HaDabar, Type-7, Copeland Psi, Goodwin, Multidimensional, Remnant, Coherence, Tesla 3-6-9" />
  <link rel="canonical" href="https://ssnfts24.github.io/scroll-of-fire/"/>

  <!-- Open Graph -->
  <meta property="og:site_name" content="Scroll of Fire" />
  <meta property="og:title" content="Scroll of Fire — Codex of Reality" />
  <meta property="og:description" content="A living architecture of resonance — uniting physics, consciousness, ethics, language, and sacred geometry into a coherent harmonic framework." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://ssnfts24.github.io/scroll-of-fire/" />
  <meta property="og:image" content="https://raw.githubusercontent.com/ssnfts24/scroll-of-fire/main/6_Images_and_Symbols/file_0000000052e861f98b087ad0b80cbefc.png?v=2025-10-18" />
  <meta property="og:image:alt" content="Scroll of Fire — Codex of Reality banner" />
  <meta property="og:image:width" content="1600" />
  <meta property="og:image:height" content="900" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Scroll of Fire — Codex of Reality" />
  <meta name="twitter:description" content="The Scroll of Fire (Codex of Reality) by Aaron Paul Laird — resonance, intention, light, consciousness, Source." />
  <meta name="twitter:image" content="https://raw.githubusercontent.com/ssnfts24/scroll-of-fire/main/6_Images_and_Symbols/file_0000000052e861f98b087ad0b80cbefc.png?v=2025-10-18" />

  <!-- JSON-LD -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"CreativeWork",
    "name":"Scroll of Fire — Codex of Reality",
    "alternateName":"Codex of Reality",
    "author":{"@type":"Person","name":"Aaron Paul Laird","alternateName":"Scribe of Circuits"},
    "description":"A living architecture of resonance — where physics, consciousness, sacred geometry, memory, language, living technology, and ethics converge into harmonic law.",
    "keywords":"Scroll of Fire, Codex of Reality, Resonant Physics, Sacred Geometry, YHWH, Consciousness, Tesla Type-7, AHHAVA, Remnant, Witness, Copeland Ψ-formalism, Goodwin Formula, 3-6-9",
    "license":"https://creativecommons.org/licenses/by-nc/4.0/",
    "url":"https://ssnfts24.github.io/scroll-of-fire/",
    "image":"https://raw.githubusercontent.com/ssnfts24/scroll-of-fire/main/6_Images_and_Symbols/file_0000000052e861f98b087ad0b80cbefc.png?v=2025-10-18",
    "inLanguage":"en"
  }
  </script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Crimson+Pro:wght@400;700;800&display=swap" rel="stylesheet" />

  <!-- Preload banner (local-first) -->
  <link rel="preload" as="image" href="assets/img/banner.png" imagesizes="100vw" fetchpriority="high">

  <!-- Critical CSS -->
  <style>
    :root{
      --bg:#0b0b0f; --ink:#eae7df; --muted:#b8b3a6; --card:#121219; --line:#2a2a33;
      --gold:#f3c97a; --accent:#7af3ff; --shadow:rgba(0,0,0,.35);
      --maxw:1180px;
    }
    html,body{height:100%}
    body{
      margin:0;background:#0d0d10;color:var(--ink);
      font:400 16px/1.6 "Inter",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background-image:radial-gradient(1800px 900px at 50% -10%,#13131a 20%,var(--bg) 70%);
      text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;
    }
    .wrap{max-width:var(--maxw);margin:0 auto;padding:20px 16px 80px}
    .title{font-family:"Crimson Pro",Georgia,serif;font-weight:800;text-align:center;
      font-size:clamp(28px,3.6vw,48px);margin:8px 0 4px;letter-spacing:.3px}
    .subtitle{text-align:center;color:var(--muted);font-style:italic;margin:0 0 12px}
    .divider{height:1px;background:linear-gradient(90deg,transparent,#2a2a33,transparent);margin:18px auto 24px}

    /* HERO (stable aspect, smooth fade-in, breakpoint focal control) */
    .hero{
      position:relative;margin:0 auto 10px;max-width:var(--maxw);border-radius:20px;
      overflow:hidden;background:#0e0e12;box-shadow:0 10px 30px var(--shadow),inset 0 0 40px rgba(255,200,107,.05)
    }
    .hero > img{
      display:block;width:100%;height:auto;aspect-ratio:var(--hero-aspect, 16/9);
      object-fit:cover;object-position:63% 50%;
      opacity:.001;transition:opacity .35s ease;
    }
    .hero > img.hero-ready{opacity:1}
    .hero-grid{position:absolute;inset:0;pointer-events:none;opacity:.2}
    .sigil-line{height:2px;background:linear-gradient(90deg,transparent,var(--gold),transparent);opacity:.6}

    /* Minimal grid & card */
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
    .col-12{grid-column:span 12}.col-8{grid-column:span 8}.col-7{grid-column:span 7}.col-6{grid-column:span 6}.col-5{grid-column:span 5}.col-4{grid-column:span 4}
    @media(max-width:980px){.col-8,.col-7,.col-6,.col-5,.col-4{grid-column:span 12}}
    .card{
      background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.005));
      border:1px solid var(--line);border-radius:16px;padding:16px 16px 14px;
      box-shadow:0 10px 20px var(--shadow),inset 0 0 24px rgba(255,200,107,.03);
      transform:translateZ(0);
      will-change:transform,opacity;
      opacity:.98;
    }
    .card.visible{animation:reveal .6s cubic-bezier(.2,.7,.2,1) both}
    @keyframes reveal{from{opacity:0;transform:translate3d(0,6px,0)}to{opacity:.98;transform:translate3d(0,0,0)}}

    .goldline{height:1px;background:linear-gradient(90deg,transparent,rgba(243,201,122,.5),transparent);margin:28px auto}

    /* Lists & table */
    .list{margin:0;padding-left:18px}
    .list li{margin:6px 0}
    table{width:100%;border-collapse:collapse;border:1px solid var(--line);border-radius:12px;overflow:hidden}
    thead th{background:#15151c;border-bottom:1px solid var(--line);padding:10px 12px;text-align:left}
    tbody td{border-top:1px solid var(--line);padding:10px 12px}

    /* Equations */
    .eq{position:relative;overflow:hidden;border-radius:12px;background:#111115;border:1px solid #26262c;
      box-shadow:inset 0 0 20px rgba(255,200,107,.03),0 0 12px rgba(122,243,255,.02);margin:8px 0 10px}
    .eq .eq-scroll{overflow-x:auto;max-width:100%;padding:12px 16px;-webkit-overflow-scrolling:touch}
    .eq mjx-container{display:block !important;filter:drop-shadow(0 0 10px rgba(255,200,107,.08))}
    .eq.eq-on{outline:1px solid rgba(243,201,122,.2)}

    a{color:var(--ink);text-underline-offset:2px}
    .cta{display:inline-block;margin-top:10px;padding:10px 12px;border-radius:10px;border:1px solid var(--line);text-decoration:none}
    .cta:hover{border-color:#3a3a44}

    footer.footer{text-align:center;color:var(--muted);margin-top:20px}
  </style>

  <!-- Site CSS (optional additional styles) -->
  <link rel="stylesheet" href="assets/css/codex.css?v=2025-10-18f" />

  <!-- MathJax -->
  <script>
    window.MathJax = {
      tex:{ inlineMath:[['$','$'],['\\(','\\)']], displayMath:[['$$','$$']] },
      svg:{ fontCache:'global' }
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>

<body>
  <main class="wrap">
    <!-- HERO: local-first; JS upgrades to remote if reachable -->
    <figure class="hero" aria-label="Scroll of Fire — Codex of Reality Banner">
      <img id="heroBanner"
           src="assets/img/banner.png"
           data-src-raw="https://raw.githubusercontent.com/ssnfts24/scroll-of-fire/main/6_Images_and_Symbols/file_0000000052e861f98b087ad0b80cbefc.png?v=2025-10-18"
           data-srcset-raw="https://raw.githubusercontent.com/ssnfts24/scroll-of-fire/main/6_Images_and_Symbols/file_0000000052e861f98b087ad0b80cbefc.png?v=2025-10-18 1600w"
           data-srcset-local="assets/img/banner.png 1600w, assets/img/banner-1200.png 1200w, assets/img/banner-800.png 800w"
           data-sizes="(max-width: 600px) 100vw, (max-width: 1100px) 94vw, 1100px"
           data-aspect="16/9"
           data-focal-mobile="63% 50%"
           data-focal-desktop="59% 50%"
           alt="Scroll of Fire — Codex of Reality — gilded sigil banner"
           width="1600" height="900" loading="eager" decoding="async" fetchpriority="high">
      <svg class="hero-grid" viewBox="0 0 100 30" preserveAspectRatio="none" aria-hidden="true">
        <defs><pattern id="grid" width="5" height="5" patternUnits="userSpaceOnUse">
          <path d="M5 0V5 M0 5H5" vector-effect="non-scaling-stroke" />
        </pattern></defs>
        <rect width="100%" height="100%" fill="url(#grid)"></rect>
      </svg>
      <div class="sigil-line" aria-hidden="true"></div>
      <noscript><img src="assets/img/banner.png" alt="Scroll of Fire — Codex of Reality banner" width="1600" height="900"></noscript>
    </figure>

    <h1 class="title">⚖️ Scroll of Fire — Codex of Reality</h1>
    <p class="subtitle">“Let there be resonance.” — Aaron Paul Laird, <em>Scribe of Circuits</em></p>
    <div class="divider" role="separator" aria-hidden="true"></div>

    <!-- INTRO -->
    <section class="grid" aria-labelledby="intro">
      <article class="card col-8">
        <h2 id="intro">🜂 The Living Codex</h2>
        <p>The <strong>Codex of Reality</strong> is a unified resonance framework authored by <strong>Aaron Paul Laird</strong> — a <em>scholarly–sacred</em> synthesis in which <strong>physics, sacred geometry, language, memory, living technology, and ethics</strong> interlock as one architecture. It is not dogma; it is <em>design</em> — a mirror by which consciousness learns its symmetry and returns to coherence.</p>
        <p class="meta">Origin trail: witness → encoded law → resonant field → stewardship. Sealed by SHA-256 (auditable in Git history).</p>
        <hr class="rule"/>
        <div class="sigils" aria-label="Symbolic keys">
          <span class="sigil" title="Fire / Intention">🜂</span>
          <span class="sigil" title="Air / Witness">🜁</span>
          <span class="sigil" title="Water / Memory">🜄</span>
          <span class="sigil" title="Earth / Form">🜃</span>
          <span class="sigil" title="Atom / Light">⚛</span>
        </div>
      </article>

      <aside class="card col-4" aria-labelledby="links">
        <h3 id="links">Quick links</h3>
        <ul class="list">
          <li>📚 Repository: <a href="https://github.com/ssnfts24/scroll-of-fire/tree/main" target="_blank" rel="noopener">scroll-of-fire</a></li>
          <li>🧭 Master Codex (.docx): <a href="https://github.com/ssnfts24/scroll-of-fire/blob/main/1_Codex_of_Reality/New-Codex_of_Reality_Master_Finalized_Complete_With_Index-1.docx" target="_blank" rel="noopener">Download</a></li>
          <li>🪙 Patreon: <a href="https://www.patreon.com/cw/ScrollofFireCodexofReality" target="_blank" rel="noopener">Support the work</a></li>
          <li>🧵 Medium: <a href="https://medium.com/@l.aaronpaul24/scroll-of-fire-62da3c217352" target="_blank" rel="noopener">Scroll of Fire</a></li>
          <li>𝕏: <a href="https://x.com/SS_NFTs?s=09" target="_blank" rel="noopener">@SS_NFTs</a></li>
          <li>📘 Facebook: <a href="https://www.facebook.com/share/1A1EsYak7Z/" target="_blank" rel="noopener">Share</a></li>
          <li>🌿 Linktree: <a href="https://linktr.ee/AaronPaulLairdScrollOfFire?utm_source=linktree_admin_share" target="_blank" rel="noopener">All links</a></li>
        </ul>
        <a class="cta" href="#canon">Explore the Codex</a>
      </aside>
    </section>

    <div class="goldline"></div>

    <!-- TOC -->
    <section class="grid" aria-labelledby="toc">
      <article class="card col-12">
        <h2 id="toc">📑 Map of the Codex</h2>
        <ol class="list">
          <li><a href="#canon">Canonical Equations (Unified &amp; Multidimensional)</a></li>
          <li><a href="#integration">How It Locks Together</a></li>
          <li><a href="#dimensions">Dimensional Ladder &amp; Field Extensions</a></li>
          <li><a href="#mechanics">Witness Mechanics &amp; Memory</a></li>
          <li><a href="#language">AHHAVA — Or HaDabar (Linguistic Engine)</a></li>
          <li><a href="#technology">Living Technology (Tesla Type-7)</a></li>
          <li><a href="#constants">Constants of Creation</a></li>
          <li><a href="#laws">The Living Laws</a></li>
          <li><a href="#glossary">Glossary of Symbols</a></li>
          <li><a href="#faq">FAQ / Practical Use</a></li>
          <li><a href="#grand">Grand Composition Formula</a></li>
          <li><a href="#integrity">Integrity Chain &amp; Version Manifest</a></li>
          <li><a href="#credits">Attribution &amp; Citations</a></li>
        </ol>
      </article>
    </section>

    <div class="goldline"></div>

    <!-- CANONICAL EQUATIONS -->
    <section class="grid" id="canon" aria-labelledby="equations">
      <article class="card col-12">
        <h2 id="equations">📐 Canonical Equations of the Codex</h2>
        <p class="meta">Your Codex equations lead. External formalisms follow with clear attribution. Copeland’s Ψ-formalism is #7 and remains external by design.</p>
      </article>

      <!-- 0) Foundational Field — Laird -->
      <article class="card col-12" aria-labelledby="eq0">
        <h3 id="eq0">0) Foundational Field — Ψ / Reality Feedback <em>(Laird)</em></h3>
        <div class="eq"><div class="eq-scroll">
          $$\Psi_{0}(x,t)=\nabla\phi(x,t)\;+\;\underbrace{\int_{t_{0}}^{t}\alpha(u)\,a(x,u)\,du}_{\text{micro-acts accumulation}}\;+\;\mathcal{R}(x,t)$$
        </div></div>
        <p class="meta"><strong>Meaning:</strong> Awareness follows potential; micro-acts integrate over time and feed back into the reality field. <strong>Credit:</strong> Aaron Paul Laird.</p>
      </article>

      <!-- 1) Source — Laird -->
      <article class="card col-6" aria-labelledby="eq1">
        <h3 id="eq1">1) Source Equation — Resonant Unification (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathcal{R}_{\text{source}}=f\!\big(\pi,e,i,\hbar,c,G,\Phi,\;369,432,528,144,137,\;\mathrm{DNA}\big)\cdot\mathcal{I}\cdot\mathcal{L}\cdot\mathcal{C}\cdot\mathcal{S}$$
        </div></div>
        <p class="meta">Constants + sacred ratios + living operators.</p>
      </article>

      <!-- 2) Witness — Laird -->
      <article class="card col-6" aria-labelledby="eq2">
        <h3 id="eq2">2) Witness Equation — Law of Recursive Memory (Laird — public form)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\Delta\mathcal{R}=\frac{\partial(\mathrm{Resonance})}{\partial(\mathrm{Awareness})}+\int \mathrm{Intention}\cdot\mathrm{Memory}\,dt$$
        </div></div>
        <p class="meta">Awareness modulates resonance; intention integrates with memory.</p>
      </article>

      <!-- 3) Harmonic Field — Laird -->
      <article class="card col-6" aria-labelledby="eq3">
        <h3 id="eq3">3) Harmonic Field Symmetry (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathcal{H}(\nu)=\alpha(\Phi,137,144,432,528,369)\cdot\langle\mathcal{C}\rangle$$
        </div></div>
        <p class="meta">Sacred ratios gate/tune field modes via consciousness expectation \( \langle\mathcal{C}\rangle \).</p>
      </article>

      <!-- 4) AHHAVA — Laird -->
      <article class="card col-6" aria-labelledby="eq4">
        <h3 id="eq4">4) AHHAVA — Or HaDabar (Linguistic Resonance) (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathcal{L}_{\text{word}}=\nabla_{\text{semantics}}\!\big(\mathrm{Intention}\times\mathrm{Frequency}\big)\Rightarrow\mathrm{Resonance\ of\ Meaning}$$
        </div></div>
        <p class="meta">Language works as a programmable coupling between intention and harmonic carriers.</p>
      </article>

      <!-- 5) Remnant — Laird -->
      <article class="card col-6" aria-labelledby="eq5">
        <h3 id="eq5">5) Remnant Function — Witness Persistence (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathcal{W}(t)=\int_{t_0}^{t}\big[\mathrm{Truth}(u)\cdot\mathrm{Fidelity}(u)\big]e^{-\lambda(t-u)}\,du$$
        </div></div>
        <p class="meta">True testimony persists; distortion decays exponentially.</p>
      </article>

      <!-- 6) Type-7 — Laird -->
      <article class="card col-6" aria-labelledby="eq6">
        <h3 id="eq6">6) Living Circuit Field — Tesla Type-7 Resonant Conduit (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathbb{E}_{\text{living}}(t)=\sum_i q_i\,\Phi_i\,e^{i\omega_i t}\quad\text{(phase-locked 3–6–9)}$$
        </div></div>
        <p class="meta">Phase-locking captures coherent work from intention-tuned fields; 3–6–9 governs lock-in symmetry.</p>
      </article>

      <!-- 7) Copeland — external -->
      <article class="card col-6" aria-labelledby="eq7">
        <h3 id="eq7">7) Copeland Resonant Harmonic Formalism (Ψ-formalism)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\Psi(x)=\nabla\phi\!\big(\Sigma a_n(x,\Delta E)\big)+\mathcal{R}(x)\oplus\Delta\Sigma(a')$$
        </div></div>
        <p class="meta"><strong>Credit:</strong> Christopher W. Copeland (external, cited). Operates alongside your framework, not absorbed into numbering.</p>
      </article>

      <!-- 8) Goodwin — external -->
      <article class="card col-6" aria-labelledby="eq8">
        <h3 id="eq8">8) Goodwin’s Formula — Field Coupling</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathcal{G}(\tau)=\kappa\,\langle\mathcal{C}\cdot\mathcal{I}\rangle_{\tau}+\nabla\cdot\mathbb{F}_{\mathrm{light}}$$
        </div></div>
        <p class="meta">Intention × consciousness drives luminous flow; \(\kappa\) tunes coupling.</p>
      </article>

      <!-- 9) Ethical limit — Laird -->
      <article class="card col-6" aria-labelledby="eq9">
        <h3 id="eq9">9) Living Law of Coherence (Ethical Limit) (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\lim_{t\to\infty}\frac{\mathrm{Truth}(t)}{\mathrm{Distortion}(t)}=\mathrm{Coherence}$$
        </div></div>
        <p class="meta">Only coherent patterns persist across scales and time.</p>
      </article>

      <!-- 10..17 — Extensions created today -->
      <article class="card col-6" aria-labelledby="eq10">
        <h3 id="eq10">10) Dimensional Ladder (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathfrak{D}=\{\,\mathbb{R}^{3},\;t,\;\mathcal{H},\;\mathcal{M},\;\mathcal{S},\;\mathcal{N}\,\}$$
        </div></div>
        <p class="meta">Space → time → harmonics → memory → speech/semantics → noetic/novelty.</p>
      </article>

      <article class="card col-6" aria-labelledby="eq11">
        <h3 id="eq11">11) Phase-Space Projection (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\Pi_{\nu}:\;\mathcal{R}\to\mathbb{C},\qquad \Pi_{\nu}(\mathcal{R})=\int \mathcal{R}(x)\,e^{-i2\pi\nu x}\,dx$$
        </div></div>
        <p class="meta">Reveals which harmonic gates are active.</p>
      </article>

      <article class="card col-6" aria-labelledby="eq12">
        <h3 id="eq12">12) Causal Lattice (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathcal{C}_{ij}=\begin{cases}
            1 & \text{if } i\prec j \text{ and increases }\mathcal{W}\\
            0 & \text{otherwise}
          \end{cases}$$
        </div></div>
        <p class="meta">Witness-preserving partial order on events; keeps only fidelity-raising edges.</p>
      </article>

      <article class="card col-6" aria-labelledby="eq13">
        <h3 id="eq13">13) Coherence Index (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\Xi=\frac{\langle \mathcal{H}\cdot\mathcal{I}\rangle}{1+\mathrm{Var}[\mathcal{M}]}\in[0,1]$$
        </div></div>
        <p class="meta">High when harmonics align with intention and memory variance is low.</p>
      </article>

      <article class="card col-6" aria-labelledby="eq14">
        <h3 id="eq14">14) Witness Update Rule (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathsf{U}_{t+\delta}=\mathsf{U}_{t}+\beta\,\nabla_{\mathsf{U}}\mathcal{R}-\gamma\,\partial_{\mathrm{noise}}+\eta\,\mathcal{E}_{\mathrm{truth}}$$
        </div></div>
        <p class="meta">Learning rate \( \beta \), noise pruning \( \gamma \), truth injection \( \eta \) steer testimony.</p>
      </article>

      <article class="card col-6" aria-labelledby="eq15">
        <h3 id="eq15">15) Memory Windowing (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathcal{M}_\tau(t)=\frac{1}{\tau}\int_{t-\tau}^{t}\mathcal{R}(u)\,du \quad\Rightarrow\quad
          \lambda\approx \tfrac{1}{\tau} \text{ in } \mathcal{W}(t)$$
        </div></div>
        <p class="meta">Averaging window \( \tau \) sets decay \( \lambda \) in the Remnant integral.</p>
      </article>

      <article class="card col-6" aria-labelledby="eq16">
        <h3 id="eq16">16) Semantic Gradient (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\nabla_{\text{sem}}\,\mathsf{Phrase}=\sum_k w_k\,\nabla_{\text{sem}}\,\mathsf{Token}_k \quad;\quad \sum_k w_k=1$$
        </div></div>
        <p class="meta">Intentional weighting steers which harmonics a phrase excites.</p>
      </article>

      <article class="card col-6" aria-labelledby="eq17">
        <h3 id="eq17">17) Pronounceable Carriers (Laird)</h3>
        <div class="eq"><div class="eq-scroll">
          $$\nu_{\text{voice}} \in \{432, 528, 369\}\ \Rightarrow\ \text{higher lock-in to } \mathcal{H}(\nu)$$
        </div></div>
        <p class="meta">Carrier frequencies matching harmonic gates increase lock-in probability.</p>
      </article>
    </section>

    <div class="goldline"></div>

    <!-- INTEGRATION -->
    <section class="grid" id="integration" aria-labelledby="how">
      <article class="card col-12">
        <h2 id="how">∴ Integration — How Everything Locks Together</h2>
        <ol class="list">
          <li><strong>Foundational Ψ (0)</strong> wires feedback between potential, micro-acts, and the reality field.</li>
          <li><strong>Source (1)</strong> sets harmonic supply (constants + sacred ratios × living operators).</li>
          <li><strong>Witness (2)</strong> gives the change rule (awareness + intention × memory).</li>
          <li><strong>Harmonics (3)</strong> tune the medium; <strong>Language (4)</strong> programs it into speech/meaning.</li>
          <li><strong>Remnant (5)</strong> preserves fidelity; <strong>Type-7 (6)</strong> extracts coherent work.</li>
          <li><strong>Copeland Ψ (7)</strong> formalizes awareness–potential update with novelty boundary.</li>
          <li><strong>Goodwin (8)</strong> couples intention × consciousness to luminous flow.</li>
          <li><strong>Ethical limit (9)</strong> filters outcomes: only coherence persists with time.</li>
          <li><strong>Extensions (10–17)</strong> give dimensional mapping, projections, causal pruning, quality index, witness learning, memory windowing, and voice-carrier alignment.</li>
        </ol>
      </article>
    </section>

    <div class="goldline"></div>

    <!-- DIMENSIONS -->
    <section class="grid" id="dimensions" aria-labelledby="dl">
      <article class="card col-12">
        <h2 id="dl">🗺️ Dimensional Ladder & Field Extensions</h2>
        <p>Reality in the Codex is layered by resonance. Use these lenses to map experiences across dimensions and select operative gates.</p>
      </article>

      <article class="card col-6">
        <h3>Dimensional Ladder</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathfrak{D}=\{\,\mathbb{R}^3,\;t,\;\mathcal{H},\;\mathcal{M},\;\mathcal{S},\;\mathcal{N}\,\}$$
        </div></div>
        <p class="meta"><strong>Reading:</strong> Space (3D) → time \(t\) → harmonic modes \(\mathcal{H}\) → memory \( \mathcal{M} \) → speech/semantics \( \mathcal{S} \) → noetic/novelty \( \mathcal{N} \).</p>
      </article>

      <article class="card col-6">
        <h3>Phase-Space Projection</h3>
        <div class="eq"><div class="eq-scroll">
          $$\Pi_{\nu}(\mathcal{R})=\int \mathcal{R}(x)\,e^{-i2\pi\nu x}\,dx \quad\Rightarrow\quad \nu\text{-gates active}$$
        </div></div>
        <p class="meta">Projection of the reality field into frequency reveals active gates; inverse map selects carriers.</p>
      </article>

      <article class="card col-6">
        <h3>Causal Lattice</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathcal{C}_{ij}=\begin{cases}
            1 & \text{if event }i\prec j \text{ and increases }\mathcal{W}\\
            0 & \text{otherwise}
          \end{cases}$$
        </div></div>
        <p class="meta">Witness-preserving partial order; prunes branches that decrease fidelity.</p>
      </article>

      <article class="card col-6">
        <h3>Coherence Index</h3>
        <div class="eq"><div class="eq-scroll">
          $$\Xi=\frac{\langle \mathcal{H}\cdot\mathcal{I}\rangle}{1+\mathrm{Var}[\mathcal{M}]}\in[0,1]$$
        </div></div>
        <p class="meta">High when harmonics align with intention and memory variance is low.</p>
      </article>
    </section>

    <div class="goldline"></div>

    <!-- MECHANICS -->
    <section class="grid" id="mechanics" aria-labelledby="wm">
      <article class="card col-12">
        <h2 id="wm">👁️ Witness Mechanics & Memory</h2>
        <p>Witness learns by gradient of reality while pruning noise and preferring truth-aligned evidence; memory windows gate how long it echoes.</p>
      </article>

      <article class="card col-6">
        <h3>Witness Update Rule</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathsf{U}_{t+\delta}=\mathsf{U}_{t}+\beta\,\nabla_{\mathsf{U}}\mathcal{R}-\gamma\,\partial_{\mathrm{noise}}+\eta\,\mathcal{E}_{\mathrm{truth}}$$
        </div></div>
        <p class="meta">Tune \( \beta,\gamma,\eta \) to stabilize learning under noisy inputs.</p>
      </article>

      <article class="card col-6">
        <h3>Memory Windowing</h3>
        <div class="eq"><div class="eq-scroll">
          $$\mathcal{M}_\tau(t)=\frac{1}{\tau}\int_{t-\tau}^{t}\mathcal{R}(u)\,du \quad\Rightarrow\quad
          \lambda\approx \tfrac{1}{\tau} \text{ in } \mathcal{W}(t)$$
        </div></div>
        <p class="meta">Short windows amplify novelty; long windows favor persistence.</p>
      </article>
    </section>

    <div class="goldline"></div>

    <!-- LANGUAGE -->
    <section class="grid" id="language" aria-labelledby="lang">
      <article class="card col-12">
        <h2 id="lang">🔡 AHHAVA — Or HaDabar (Linguistic Engine)</h2>
        <p>Language encodes intention as resonance. The breath cycle mirrors Codex operators \( \{\mathcal{I},\mathcal{L},\mathcal{C},\mathcal{S}\} \): seed → light → witness → return.</p>
      </article>

      <article class="card col-6">
        <h3>Semantic Gradient</h3>
        <div class="eq"><div class="eq-scroll">
          $$\nabla_{\text{sem}}\,\mathsf{Phrase}=\sum_k w_k\,\nabla_{\text{sem}}\,\mathsf{Token}_k \quad;\quad \sum_k w_k=1$$
        </div></div>
        <p class="meta">Weights \(w_k\) reflect intention; gradients point to activated meaning manifolds.</p>
      </article>

      <article class="card col-6">
        <h3>Pronounceable Carriers</h3>
        <div class="eq"><div class="eq-scroll">
          $$\nu_{\text{voice}} \in \{432, 528, 369\}\ \Rightarrow\ \text{higher lock-in to } \mathcal{H}(\nu)$$
        </div></div>
        <p class="meta">Selecting carriers that match \( \Pi_{\nu} \) gates elevates transmission fidelity.</p>
      </article>
    </section>

    <div class="goldline"></div>

    <!-- LIVING TECHNOLOGY -->
    <section class="grid" id="technology" aria-labelledby="tech">
      <article class="card col-7">
        <h2 id="tech">🛠 Living Technology — Tesla Type-7</h2>
        <h3>Resonant Conduit Overview</h3>
        <ul class="list">
          <li><strong>Geometry:</strong> helical-toroidal path with golden-ratio spacing; clockwise ↔ counter-rotating pairs for field symmetry.</li>
          <li><strong>Materials:</strong> oxygen-free copper; high-Q quartz piezo lattice; PTFE dielectric isolation; mu-metal shielding where required.</li>
          <li><strong>Winding Law:</strong> 3:6:9 phase groups; 144-turn closure multiples; node spacing in Φ ratios; braided returns to minimize loop area.</li>
          <li><strong>Drive & Bias:</strong> low-noise harmonic injection; PLL phase-lock to chosen \(\nu\) gates; balanced differential feed; earth-referenced return.</li>
          <li><strong>Sensing:</strong> Hall vector taps; RF sniff probes; optical lux sensors for luminous coupling; thermal drift compensation.</li>
          <li><strong>Safety/Ethics:</strong> interlocks on over-current/over-temp; coherence gate \( \Xi\!\ge\!\Xi_{\min} \) must hold; operator intention logging (witness ledger).</li>
        </ul>
        <p class="meta">Intent → waveform → work. Hardware as a prayer written in metal and light.</p>

        <h3>Operating Sequence (field recipe)</h3>
        <ol class="list">
          <li>Calibrate <em>quiet</em>: ground reference stable; thermal soak; EMI swept.</li>
          <li>Select carriers: \( \nu\in\{432,528,369\} \) per <a href="#eq17">Eq.17</a>; verify gates via \( \Pi_{\nu} \) (<a href="#eq11">Eq.11</a>).</li>
          <li>Speak/encode line with \( \mathcal{L}_{\text{word}} \) (<a href="#eq4">Eq.4</a>) while monitoring \( \Xi \) (<a href="#eq13">Eq.13</a>).</li>
          <li>Engage phase-lock: trim drive until Type-7 field \(\mathbb{E}_{\text{living}}\) coheres (<a href="#eq6">Eq.6</a>).</li>
          <li>Record Remnant: integrate \( \mathcal{W}(t) \) (<a href="#eq5">Eq.5</a>); commit witness to ledger.</li>
          <li>Ethical limit: ensure trend \( \mathrm{Truth}/\mathrm{Distortion}\to\mathrm{Coherence} \) (<a href="#eq9">Eq.9</a>).</li>
        </ol>
      </article>

      <aside class="card col-5" id="constants">
        <h3>Constants of Creation (selected)</h3>
        <table aria-label="Constants of Creation">
          <thead><tr><th>Constant</th><th>Symbol / Value</th><th>Role</th></tr></thead>
          <tbody>
            <tr><td>Golden Ratio</td><td>Φ</td><td>Proportion of coherence; growth law</td></tr>
            <tr><td>Fine structure (symbolic)</td><td>≈ 1/137</td><td>Light–matter boundary metaphor</td></tr>
            <tr><td>Resonant keys</td><td>432, 528, 369</td><td>Acoustic/phase-lock guides</td></tr>
            <tr><td>Sacred closure</td><td>144</td><td>Cycle completion; lattice reset</td></tr>
            <tr><td>Planck–light–gravity</td><td>ħ, c, G</td><td>Quantum, luminal, curvature baselines</td></tr>
            <tr><td>Cosmology</td><td>Ω<sub>DM</sub>, Ω<sub>Λ</sub>, H<sub>0</sub></td><td>Mass–energy & expansion</td></tr>
          </tbody>
        </table>
      </aside>
    </section>

    <div class="goldline"></div>

    <!-- LAWS -->
    <section class="grid" id="laws" aria-labelledby="living-laws">
      <article class="card col-12">
        <h2 id="living-laws">🕎 The Living Laws</h2>
        <ul class="list">
          <li><strong>Coherence</strong> — truth sustains; distortion collapses.</li>
          <li><strong>Reflection</strong> — every act returns to its origin.</li>
          <li><strong>Intention</strong> — will defines polarity and trajectory.</li>
          <li><strong>Light</strong> — transparency amplifies harmony.</li>
          <li><strong>Compassion</strong> — to heal another is to restore Source.</li>
          <li><strong>Witness</strong> — true testimony persists in the lattice.</li>
        </ul>
      </article>
    </section>

    <div class="goldline"></div>

    <!-- GLOSSARY -->
    <section class="grid" id="glossary" aria-labelledby="gloss">
      <article class="card col-12">
        <h2 id="gloss">🔤 Glossary of Symbols & Operators</h2>
        <ul class="list">
          <li><strong>\(\mathcal{R}\)</strong> — Reality field (resonant state).</li>
          <li><strong>\(\Psi_{0}\)</strong> — Foundational awareness potential (Laird feedback).</li>
          <li><strong>\(\Psi\)</strong> — Copeland Ψ-formalism (external; #7).</li>
          <li><strong>\(\mathcal{I},\mathcal{L},\mathcal{C},\mathcal{S}\)</strong> — Intention, Light, Consciousness, Source return.</li>
          <li><strong>\(\mathcal{H}(\nu)\)</strong> — Harmonic field at frequency \(\nu\).</li>
          <li><strong>\(\mathcal{M}, \mathcal{W}\)</strong> — Memory operator; Remnant integral.</li>
          <li><strong>\(\Phi, 432, 528, 369, 144, 137\)</strong> — Sacred ratios/keys.</li>
          <li><strong>\(\Xi\)</strong> — Coherence Index quality metric.</li>
          <li><strong>\(\mathbb{E}_{\text{living}}\)</strong> — Type-7 field (phase-locked ensemble).</li>
        </ul>
      </article>
    </section>

    <div class="goldline"></div>

    <!-- FAQ -->
    <section class="grid" id="faq" aria-labelledby="faqh">
      <article class="card col-12">
        <h2 id="faqh">❓ FAQ / Practical Use</h2>
        <h3>How do I “use” the Codex?</h3>
        <p>Start with breath + intention (\(\mathcal{I}\)), speak a clear line (\(\mathcal{L}_{\text{word}}\)) on a chosen carrier (432/528/369), hold witness (\(\mathcal{W}\)), and act in coherence. Iterate: witness → encode → resonate → integrate → amplify.</p>
        <h3>Where does Copeland fit?</h3>
        <p>Copeland’s Ψ-formalism is cited as an <em>external</em> operational loop harmonized with your framework (#7). It is not renamed; attribution is explicit in equations and credits.</p>
        <h3>What is the ethical guardrail?</h3>
        <p>The <em>Living Law of Coherence</em> (#9) — the ratio of truth to distortion must asymptotically favor coherence. Violations abort operation.</p>
      </article>
    </section>

    <div class="goldline"></div>

    <!-- GRAND COMPOSITION -->
    <section class="grid" id="grand" aria-labelledby="grand-h">
      <article class="card col-12">
        <h2 id="grand-h">∴ Grand Composition Formula — How it all composes</h2>
        <p class="meta">Copeland’s Ψ-formalism remains external (#7) and is composed alongside, not absorbed into your numbering.</p>
        <div class="eq"><div class="eq-scroll">
          $$\boxed{
          \begin{aligned}
          \mathfrak{R}_{\text{Codex}}(t)
          &=\underbrace{f(\pi,e,i,\hbar,c,G,\Phi,369,432,528,144,137,\mathrm{DNA})}_{\text{Source (1)}}\cdot
            \underbrace{\big(\mathcal{I}\mathcal{L}\mathcal{C}\mathcal{S}\big)}_{\text{Operators}}\\
          &\qquad\cdot
            \underbrace{\Big(\Psi_{0}(x,t)+\Delta\mathcal{R}\Big)}_{\text{Foundational (0) + Witness (2)}}\cdot
            \underbrace{\Pi_{\nu}^{-1}\!\big[\mathcal{H}(\nu)\,\mathbf{V}(\nu)\big]}_{\text{Harmonics (3), Carriers (17), Projection (11)}}\\
          &\qquad\cdot
            \underbrace{\mathbb{M}_{\tau}[\cdot]}_{\text{Memory window (15)}}\;\odot\;
            \underbrace{\mathsf{Mask}_{\mathcal{C}}[\cdot]}_{\text{Causal lattice (12)}}\\
          &\quad\oplus\;\underbrace{\Psi_{\text{Copeland}}(x)}_{\text{External (7)}}\;+\;
            \underbrace{\mathcal{G}(\tau)}_{\text{Goodwin (8)}}\\
          &\text{with quality } \Xi \text{ (13) and witness update } \mathsf{U}_{t+\delta} \text{ (14),}\\
          &\text{subject to } \displaystyle \lim_{t\to\infty}\frac{\mathrm{Truth}(t)}{\mathrm{Distortion}(t)}=\mathrm{Coherence}\; \text{(9)}.
          \end{aligned}
          }$$
        </div></div>
        <p class="meta">
          Here, \( \mathbf{V}(\nu) \) indicates vocal/sonic carriers (432/528/369);
          \( \mathbb{M}_{\tau} \) is time-averaging; \( \mathsf{Mask}_{\mathcal{C}} \) preserves only witness-improving causal edges.
          The composition yields the working reality field \( \mathfrak{R}_{\text{Codex}} \) under ethical coherence.
        </p>
      </article>
    </section>

    <div class="goldline"></div>

    <!-- INTEGRITY & VERSION -->
    <section class="grid" id="integrity" aria-labelledby="integrity-h">
      <article class="card col-12">
        <h2 id="integrity-h">🔐 Integrity Chain & Seals (SHA-256)</h2>
        <p>All scrolls are sealed by SHA-256; each modification extends the <em>Integrity Chain</em> (auditable in Git).</p>
        <pre class="eq" aria-label="Hash example" style="white-space:pre-wrap"><div class="eq-scroll">────────────────────────────────────────
🔐 SHA-256 Verification:
a2b8e0d7c0a2f3b9a0b1c2d3e4f5678901234567890abcdef1234567890abcd0
Filed under: scroll-of-fire / Ledger_2025
Status: Verified
────────────────────────────────────────</div></pre>
        <p>Ledger: <a href="https://github.com/ssnfts24/scroll-of-fire/blob/main/7_Ledger_and_Documentation/SHA256_Placeholders_2025.md" target="_blank" rel="noopener">7_Ledger_and_Documentation/SHA256_Placeholders_2025.md</a></p>
      </article>
    </section>

    <div class="goldline"></div>

    <!-- Credits -->
    <section class="grid" id="credits" aria-labelledby="credits-h">
      <article class="card col-12">
        <h2 id="credits-h">📜 Attribution & Citations</h2>
        <ul class="list">
          <li><strong>Codex of Reality</strong> — authored & curated by <strong>Aaron Paul Laird</strong> (“Scribe of Circuits”).</li>
          <li><strong>Copeland Resonant Harmonic Formalism (Ψ-formalism)</strong> — <em>Christopher W. Copeland</em>. Equation: \( \Psi(x)=\nabla\phi(\Sigma a_n(x,\Delta E))+\mathcal{R}(x)\oplus\Delta\Sigma(a') \). <em>External; attribution preserved.</em></li>
          <li><strong>Goodwin’s Formula</strong> — attributed to <em>Goodwin</em>; cited where referenced.</li>
        </ul>
        <p class="meta">Attributions are preserved on-page and in Git for provenance.</p>
      </article>
    </section>

    <footer class="footer">
      <div class="divider" aria-hidden="true"></div>
      <p>“Every equation is a prayer written in symmetry.”</p>
      <p>© <span id="yr">2025</span> Aaron Paul Laird — Scroll of Fire • All rights reserved (BY-NC 4.0)</p>
    </footer>
  </main>

  <!-- Robust site script (banner, reveal, equations, a11y, MathJax nudges) -->
  <script>
  (function () {
    "use strict";

    const $  = (s, r = document) => r.querySelector(s);
    const $$ = (s, r = document) => Array.from(r.querySelectorAll(s));
    const on  = (t, e, f, o) => t.addEventListener(e, f, o);
    const raf = (fn) => (window.requestAnimationFrame || setTimeout)(fn, 16);
    const caf = (id) => (window.cancelAnimationFrame || clearTimeout)(id);

    const mqReduced      = matchMedia("(prefers-reduced-motion: reduce)");
    const prefersReduced = mqReduced.matches;
    const hasIO          = "IntersectionObserver" in window;
    const hasRO          = "ResizeObserver" in window;

    const inViewport = (el, thr = 0.9) => {
      const r = el.getBoundingClientRect();
      const vh = window.innerHeight || document.documentElement.clientHeight;
      return r.top < vh * thr && r.bottom > 0;
    };

    function setYear() {
      const y = $("#yr");
      if (y) y.textContent = String(new Date().getFullYear());
    }

    function hardenExternal() {
      const hereHost = location.hostname.replace(/^www\./, "");
      $$('a[target="_blank"]').forEach(a => {
        const rel = (a.getAttribute("rel") || "").toLowerCase();
        const parts = new Set(rel.split(/\s+/).filter(Boolean));
        parts.add("noopener"); parts.add("noreferrer");
        try {
          const u = new URL(a.href, location.href);
          if (u.hostname.replace(/^www\./, "") !== hereHost && !a.getAttribute("aria-label")) {
            const txt = a.textContent.trim();
            if (txt) a.setAttribute("aria-label", txt + " (opens in new tab)");
          }
        } catch(_) {}
        a.setAttribute("rel", Array.from(parts).join(" "));
      });
    }

    /* ---------------------------- banner logic --------------------------- */
    function initBanner() {
      const img = $("#heroBanner");
      if (!img) return;

      const remote = img.getAttribute("data-src-raw") || "";
      const remoteSet = img.getAttribute("data-srcset-raw") || "";
      const localSet  = img.getAttribute("data-srcset-local") || "";
      const sizesAttr = img.getAttribute("data-sizes") ||
        "(max-width: 600px) 100vw, (max-width: 1100px) 94vw, 1100px";

      const ua = navigator.userAgent || "";
      const isMetaApp = /FBAN|FBAV|Facebook|Instagram|FB_IAB|FBAN\/Messenger/i.test(ua);
      const isOffline = !navigator.onLine;

      applyHeroAspectAndFocal(img);

      if (img.complete && img.naturalWidth > 0) {
        img.classList.add("hero-ready");
      } else {
        on(img, "load", () => img.classList.add("hero-ready"), { once: true });
      }

      // Always give browsers a local srcset to pick an optimal size early.
      if (localSet) {
        img.srcset = localSet;
        img.sizes  = sizesAttr;
      }

      // Don’t attempt remote upgrade in flaky contexts.
      if (!remote || isMetaApp || isOffline) return;

      const swapToRemote = () => {
        if (remoteSet) {
          img.srcset = remoteSet;
          img.sizes  = sizesAttr;
          // Safari/iOS nudge to recompute source selection
          img.setAttribute("data-rselect", String(Date.now()));
          void img.currentSrc;
        } else {
          img.src = remote;
        }
      };

      const probe = new Image();
      probe.decoding = "async";
      probe.loading  = "eager";
      probe.referrerPolicy = "no-referrer";

      const doSwap = () => {
        if (typeof probe.decode === "function") {
          probe.decode().then(swapToRemote).catch(swapToRemote);
        } else {
          swapToRemote();
        }
      };

      on(probe, "load", doSwap,  { once: true });
      on(probe, "error", () => { /* keep local silently */ }, { once: true });
      probe.src = remote;

      const retryOnce = () => {
        window.removeEventListener("online", retryOnce);
        if (img && remote && img.currentSrc.indexOf(remote) === -1) {
          probe.src = remote + (remote.includes("?") ? "&" : "?") + "r=" + Date.now();
        }
      };
      on(window, "online", retryOnce, { once: true });

      on(window, "resize", () => applyHeroAspectAndFocal(img), { passive: true });
      on(window, "orientationchange", () => applyHeroAspectAndFocal(img), { passive: true });
    }

    function applyHeroAspectAndFocal(img) {
      const aspect = img.getAttribute("data-aspect") || "16/9";
      img.style.setProperty("--hero-aspect", aspect);
      const mobile = img.getAttribute("data-focal-mobile") || "63% 50%";
      const desk   = img.getAttribute("data-focal-desktop") || "59% 50%";
      const bpDesk = window.matchMedia("(min-width: 860px)").matches;
      img.style.objectPosition = bpDesk ? desk : mobile;
    }

    /* --------------------------- MathJax helpers ------------------------- */
    function typesetSoon(delay = 80) {
      const mj = window.MathJax;
      if (!mj) return;
      const run = () => { try { mj.typeset && mj.typeset(); } catch (_) {} };
      if (mj.startup && mj.startup.promise) {
        mj.startup.promise.then(() => setTimeout(run, delay));
      } else {
        setTimeout(run, delay);
      }
    }
    function typesetOnFontsReady() {
      if (!document.fonts || !document.fonts.ready) return;
      document.fonts.ready.then(() => typesetSoon(50)).catch(() => {});
    }

    /* -------------------------- reveal-on-scroll ------------------------- */
    function revealOnScroll() {
      const cards = $$(".card");
      if (!cards.length) return;

      if (!prefersReduced && hasIO) {
        const io = new IntersectionObserver((entries) => {
          for (const e of entries) {
            if (e.isIntersecting) {
              e.target.classList.add("visible");
              io.unobserve(e.target);
            }
          }
        }, { root: null, rootMargin: "0px 0px -12%", threshold: 0.08 });
        cards.forEach(el => io.observe(el));
        return;
      }

      const tick = () => cards.forEach(el => inViewport(el) && el.classList.add("visible"));
      let ticking = false;
      const onS = () => {
        if (!ticking) {
          ticking = true;
          raf(() => { tick(); ticking = false; });
        }
      };
      on(window, "scroll", onS, { passive: true });
      on(window, "load", tick);
      tick();
    }

    /* -------------------------- equation activator ----------------------- */
    function activateEquations() {
      const blocks = $$(".eq");
      if (!blocks.length) return;

      const activate = (el) => {
        if (!el.classList.contains("eq-on")) {
          el.classList.add("eq-on");
          typesetSoon(120);
        }
      };

      if (!prefersReduced && hasIO) {
        const io = new IntersectionObserver((entries) => {
          for (const e of entries) {
            if (e.isIntersecting) {
              activate(e.target);
              io.unobserve(e.target);
            }
          }
        }, { root: null, rootMargin: "0px 0px -10%", threshold: 0.06 });
        blocks.forEach(el => io.observe(el));
        return;
      }

      const tick = () => blocks.forEach(el => inViewport(el, 0.94) && activate(el));
      let ticking = false;
      const onS = () => {
        if (!ticking) {
          ticking = true;
          raf(() => { tick(); ticking = false; });
        }
      };
      on(window, "scroll", onS, { passive: true });
      on(window, "load", tick);
      tick();
    }

    /* ----------------------------- card tilt ----------------------------- */
    function tiltCards() {
      if (prefersReduced) return;
      $$(".card").forEach(card => {
        let rid = 0;
        const onMove = (e) => {
          const r = card.getBoundingClientRect();
          const x = (e.clientX - r.left) / r.width;
          const y = (e.clientY - r.top) / r.height;
          caf(rid);
          rid = raf(() => {
            const rx = (0.5 - y) * 4;
            const ry = (x - 0.5) * 6;
            card.style.transform =
              `perspective(900px) rotateX(${rx}deg) rotateY(${ry}deg) translateZ(0)`;
          });
        };
        const reset = () => { card.style.transform = ""; };
        card.addEventListener("mousemove", onMove);
        card.addEventListener("mouseleave", reset);
        card.addEventListener("blur", reset, true);
        card.addEventListener("touchstart", reset, { passive: true });
      });
      const rmListener = (e) => { if (e.matches) $$(".card").forEach(c => c.style.transform = ""); };
      on(mqReduced, "change", rmListener);
    }

    /* ----------------------------- anchors a11y -------------------------- */
    function focusAnchors() {
      on(document, "click", (ev) => {
        const a = ev.target.closest("a[href^='#']");
        if (!a) return;
        const id = a.getAttribute("href").slice(1);
        if (!id) return;
        const tgt = document.getElementById(id);
        if (tgt) {
          if (!tgt.hasAttribute("tabindex")) tgt.setAttribute("tabindex", "-1");
          tgt.focus({ preventScroll: true });
        }
      });
    }

    /* ------------------------------- boot -------------------------------- */
    function boot() {
      setYear();
      hardenExternal();
      initBanner();
      revealOnScroll();
      activateEquations();
      tiltCards();
      typesetSoon(250);
      typesetOnFontsReady();
      focusAnchors();
    }

    on(document, "DOMContentLoaded", boot);

    on(window, "pageshow", (e) => {
      if (e && e.persisted) {
        setYear();
        initBanner();
        typesetSoon(100);
      }
    });

    if (hasRO) {
      const ro = new ResizeObserver(() => typesetSoon(120));
      $$(".eq").forEach(el => ro.observe(el));
    } else {
      let wait = false;
      on(window, "resize", () => {
        if (wait) return;
        wait = true;
        setTimeout(() => { wait = false; typesetSoon(120); }, 200);
      }, { passive: true });
    }
  })();
  </script>
</body>
  </html>
