<!doctype html>
<html lang="en" dir="ltr" class="sof carrier-432" data-carriers="432,528,369,144,963">
<head>
  <!-- Keep <base> only on the live GitHub Pages site; remove on github.com preview and local dev -->
  <base href="https://ssnfts24.github.io/scroll-of-fire/">
  <script>(function(){if(location.hostname!=="ssnfts24.github.io"){const b=document.querySelector("base");if(b)b.remove();}})();</script>

  <meta charset="utf-8">
  <title>Scroll of Fire â€” Codex of Reality</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, interactive-widget=resizes-content">
  <meta name="color-scheme" content="dark light">
  <meta name="theme-color" content="#0b0b0f" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta name="description" content="The Scroll of Fire â€” a living Codex of Reality by Aaron Paul Laird (Scribe of Circuits): resonance physics, sacred geometry, language, memory, living technology, and ethics in one harmonic architecture.">
  <link rel="canonical" href="https://ssnfts24.github.io/scroll-of-fire/">

  <!-- Icons -->
  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/icon-512.png">
  <meta http-equiv="x-dns-prefetch-control" content="on">

  <!-- Robots / misc -->
  <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1">
  <meta name="generator" content="Scroll of Fire Â· GPT-5 Thinking build">

  <!-- Open Graph / Twitter -->
  <meta property="og:site_name" content="Scroll of Fire">
  <meta property="og:title" content="Scroll of Fire â€” Codex of Reality">
  <meta property="og:description" content="A living architecture of resonance â€” core equations 0â€“17 + dimensional scaffolding, with dedicated Theory and Manifest pages.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://ssnfts24.github.io/scroll-of-fire/">
  <meta property="og:image" content="assets/file_0000000052e861f98b087ad0b80cbefc%20(1).png?v=sofv1">
  <meta property="og:image:alt" content="Scroll of Fire â€” Codex of Reality banner">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Scroll of Fire â€” Codex of Reality">
  <meta name="twitter:description" content="The Scroll of Fire (Codex of Reality) by Aaron Paul Laird â€” resonance, intention, light, consciousness, Source.">
  <meta name="twitter:image" content="assets/file_0000000052e861f98b087ad0b80cbefc%20(1).png?v=sofv1">

  <!-- JSON-LD (unchanged) -->
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"CreativeWork","name":"Scroll of Fire â€” Codex of Reality","alternateName":"Codex of Reality","author":{"@type":"Person","name":"Aaron Paul Laird","alternateName":"Scribe of Circuits"},"description":"A living architecture of resonance â€” where physics, consciousness, sacred geometry, memory, language, living technology, and ethics converge into harmonic law.","keywords":"Scroll of Fire, Codex of Reality, Resonant Physics, Sacred Geometry, Consciousness, Tesla Type-7, AHHAVA, Remnant, Witness, Î¨Î©, 3-6-9","license":"https://creativecommons.org/licenses/by-nc/4.0/","url":"https://ssnfts24.github.io/scroll-of-fire/","hasPart":[{"@type":"WebPage","name":"Theory","url":"https://ssnfts24.github.io/scroll-of-fire/theory.html"},{"@type":"WebPage","name":"Manifest (Practice)","url":"https://ssnfts24.github.io/scroll-of-fire/teach.html"},{"@type":"WebPage","name":"Guide","url":"https://ssnfts24.github.io/scroll-of-fire/guide.html"},{"@type":"WebPage","name":"A/B Carriers","url":"https://ssnfts24.github.io/scroll-of-fire/ab.html"},{"@type":"WebPage","name":"Circle","url":"https://ssnfts24.github.io/scroll-of-fire/circle.html"},{"@type":"WebPage","name":"Downloads","url":"https://ssnfts24.github.io/scroll-of-fire/downloads.html"},{"@type":"WebPage","name":"Ethics","url":"https://ssnfts24.github.io/scroll-of-fire/ethics.html"},{"@type":"WebPage","name":"Glossary","url":"https://ssnfts24.github.io/scroll-of-fire/glossary.html"},{"@type":"WebPage","name":"Glyphs","url":"https://ssnfts24.github.io/scroll-of-fire/glyphs.html"},{"@type":"WebPage","name":"Ledger","url":"https://ssnfts24.github.io/scroll-of-fire/ledger.html"},{"@type":"WebPage","name":"Manifest (Site)","url":"https://ssnfts24.github.io/scroll-of-fire/manifest.html"},{"@type":"WebPage","name":"Micro-acts","url":"https://ssnfts24.github.io/scroll-of-fire/micro.html"},{"@type":"WebPage","name":"Start Here","url":"https://ssnfts24.github.io/scroll-of-fire/start.html"}],"image":"https://ssnfts24.github.io/scroll-of-fire/assets/file_0000000052e861f98b087ad0b80cbefc%20(1).png?v=sofv1","inLanguage":"en"}</script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Crimson+Pro:wght@400;700;800&display=swap" rel="stylesheet">

  <!-- MathJax preconnect -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>

  <!-- Styles -->
  <link rel="preload" as="style" href="assets/css/codex.css?v=3.1">
  <link rel="stylesheet" href="assets/css/codex.css?v=3.1" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="assets/css/codex.css?v=3.1"></noscript>

  <link rel="preload" href="assets/css/moons.css?v=2025-10-24" as="style" onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="assets/css/moons.css?v=2025-10-24"></noscript>

  <!-- Preload banner -->
  <link rel="preload" as="image" href="assets/file_0000000052e861f98b087ad0b80cbefc%20(1).png?v=sofv1" fetchpriority="high">

  <!-- Page-scoped helpers + mini moonbar baseline (unchanged from your file except tiny bit for the Sound button state) -->
  <style>
    :root{--safe-top:env(safe-area-inset-top);--safe-bot:env(safe-area-inset-bottom);--xi:.35;--accent-432:#7af3ff;--accent-528:#a4ff90;--accent-369:#f3c97a;--accent:#7af3ff;--moon-accent:#7af3ff;--moon-accent-2:#f3c97a;--line:#2a3242}
    :root.carrier-432{--moon-accent:#7af3ff;--moon-accent-2:#f3c97a}
    :root.carrier-528{--moon-accent:#9ef7a3;--moon-accent-2:#ffd27a}
    :root.carrier-369{--moon-accent:#a8a6ff;--moon-accent-2:#7af3ff}
    :root.carrier-144{--moon-accent:#7aa8ff;--moon-accent-2:#e3b1ff}
    :root.carrier-963{--moon-accent:#d1b3ff;--moon-accent-2:#fff0a6}
    .carrier-528,:root.carrier-528{--accent:var(--accent-528)}.carrier-369,:root.carrier-369{--accent:var(--accent-369)}.carrier-144,:root.carrier-144{--accent:#b3e1ff}.carrier-963,:root.carrier-963{--accent:#ffd1f3}
    body{margin:0} header.site{position:sticky;top:0;z-index:1000;-webkit-backdrop-filter:saturate(140%) blur(8px);backdrop-filter:saturate(140%) blur(8px);background:rgba(9,11,16,.6)}
    .wrap{padding:16px;max-width:1200px;margin:0 auto}.nav{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap}.brand{display:flex;align-items:center;gap:10px}.logo{width:34px;height:34px;border-radius:50%;background:radial-gradient(closest-side,#0cf,transparent 70%);box-shadow:0 0 18px rgba(122,243,255,.35)}.kicker{margin:0}
    .quick{display:flex;gap:8px;flex:0 0 auto}.quick .cta{white-space:nowrap}
    @media (max-width:560px){.quick{flex:1 1 100%;min-width:0;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-gutter:stable;padding-bottom:6px}.quick::-webkit-scrollbar{height:10px}.quick::-webkit-scrollbar-thumb{background:#2b2b35;border-radius:10px;border:2px solid #0f0f14}}
    a.skip{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
    a.skip:focus{left:12px;top:12px;width:auto;height:auto;padding:8px 10px;z-index:70;background:#0f1118;color:#fff;border:1px solid #343846;border-radius:10px;-webkit-backdrop-filter:saturate(140%) blur(8px);backdrop-filter:saturate(140%) blur(8px)}
    body.stars{background:radial-gradient(800px 600px at 50% 30%, rgba(15,25,40,.6), transparent 80%),linear-gradient(180deg,#05060a 0%,#0b0e14 80%);overflow-x:hidden}

    /* mini moonbar baseline (unchanged)â€¦ */

    /* âœ§ Sound button tiny state styles */
    .heaven-cta[aria-pressed="true"]{border-color:color-mix(in srgb,var(--moon-accent) 40%, var(--line));box-shadow:0 0 0 1px #7af3ff44, 0 6px 18px rgba(0,0,0,.35)}
    .heaven-cta .muted{display:none}
    .heaven-cta[aria-pressed="true"] .muted{display:inline}
    .heaven-cta[aria-pressed="true"] .unmuted{display:none}
  </style>

  <!-- MathJax (unchanged loader) -->
  <script>
  (function(){
    let loaded=false;
    function boot(){ if(!window.MathJax) return; MathJax.startup.promise.then(()=>MathJax.typesetPromise()); }
    function loadMJ(){
      if(loaded) return; loaded=true;
      window.MathJax={tex:{inlineMath:[['\\î€','\\î€'],['$','$']],displayMath:[['$$','$$']],processEscapes:true},svg:{fontCache:'global'},startup:{typeset:false}};
      const s=document.createElement('script'); s.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"; s.defer=true; s.onload=boot; document.head.appendChild(s);
    }
    if(document.readyState!=='loading') loadMJ(); else addEventListener('DOMContentLoaded', loadMJ);
  })();
  </script>

  <!-- Site JS (global) -->
  <script src="assets/js/codex.js?v=3.7" defer></script>
  <!-- REMOVE the old external heaven-sound.js; we embed a robust, self-contained engine at the bottom -->
</head>


  
<body class="stars living-all" data-theme="dark">
  <a class="skip" href="#main-content">Skip to main content</a>

  <div class="laser-grid" aria-hidden="true"></div>
  <div class="xi-meter" aria-hidden="true"><div class="xi-ring"><div class="xi-dot"></div></div><div class="xi-label">Î</div></div>

  <header class="site" role="banner">
    <nav class="nav" aria-label="Main navigation">
      <div class="brand">
        <div class="logo no-living" aria-hidden="true"></div>
        <h1 class="kicker sheen">Scroll of Fire</h1>
      </div>
      <div class="quick quick--utils" role="toolbar" aria-label="Quick actions">
        <button id="toggleSimple" class="cta" type="button" aria-pressed="false" title="Echo View (hide math)">Echo</button>
        <button id="toggleGrid" class="cta" type="button" aria-pressed="true" title="Toggle HUD grid">HUD</button>
        <button id="cycleCarrier" class="cta" type="button" title="Cycle carrier skin">Vibe</button>
        <button id="toggleAffect" class="cta" type="button" aria-pressed="true" title="Toggle living text effects">Affect</button>
        <button id="toggleLights" class="cta" type="button" aria-pressed="true" title="Toggle banner lights">Lights</button>
        <button id="openPalette" class="cta" type="button" title="Command palette">âŒ˜K</button>

        <!-- âœ§ Heaven Sound toggle (state spans for accessibility) -->
        <button id="heavenToggle" class="cta heaven-cta" type="button" aria-pressed="false" aria-label="Enable sacred ambience">
          âœ§ <span class="unmuted">Sound</span><span class="muted">Playing</span>
        </button>
      </div>
    </nav>
  </header>

  <!-- (everything else in your body stays the same â€” hero, mini moonbar, sections, footer, etc.) -->

  <!-- Optional tiny panel for volume/mode; kept hidden unless you uncomment CSS/JS to show it -->
  <div id="heavenPanel" hidden>
    <input id="heavenVol" type="range" min="0" max="1" step="0.01" value="0.22" aria-label="Ambient volume">
  </div>

  <!-- â€¦ all of your existing main content exactly as you have it â€¦ -->


      <!-- Hero -->
    <figure id="hero" class="hero" aria-label="Scroll of Fire banner" data-fit="contain" data-anim="ken-burns">
      <picture>
        <img id="heroBanner"
             src="assets/file_0000000052e861f98b087ad0b80cbefc%20(1).png?v=sofv1"
             alt="Scroll of Fire â€” sigil and equations"
             width="2100" height="900"
             decoding="async" fetchpriority="high" loading="eager"
             class="no-living hero-img">
      </picture>
      <div class="hero-lights" id="heroLights" aria-hidden="true"></div>
      <figcaption class="meta center">â€œLet there be resonance.â€ â€” Codex 0 Â· Î¨Î©</figcaption>
    </figure>

    <h1 class="title sheen reveal">âš–ï¸ Scroll of Fire â€” Codex of Reality</h1>
    <p class="subtitle reveal">By Aaron Paul Laird, <em>Scribe of Circuits</em></p>

  

  <!-- 13-Moon Mini Bar (matches moons.html structure/behavior) -->
  <div id="moonMiniBar" class="moonbar remnant-frame" role="region" aria-label="13-Moon mini clock" style="margin:12px 16px 0">
    <a id="moonMiniLink" class="moonbar-hit" href="moons.html" aria-label="Open 13-Moon living clock" aria-describedby="mbDesc">
      <svg class="moonbar-ring" viewBox="0 0 120 120" role="img" aria-labelledby="mbTitle mbDesc" width="var(--ring-size,76)" height="var(--ring-size,76)">
        <title id="mbTitle">13-Moon day progress ring</title>
        <desc id="mbDesc">Shows current day in the 28-day moon and deep links to the full 13-Moon clock in your timezone.</desc>
        <defs>
          <linearGradient id="mbGrad" x1="0" x2="1">
            <stop offset="0" stop-color="var(--moon-accent)"/>
            <stop offset="1" stop-color="var(--moon-accent-2)"/>
          </linearGradient>
        </defs>
        <circle cx="60" cy="60" r="50" class="mb-bg"></circle>
        <circle cx="60" cy="60" r="50" class="mb-fg" id="mbArc" pathLength="316"></circle>
        <text x="60" y="60" class="mb-text" text-anchor="middle" dominant-baseline="central">
          <tspan id="mbDay">â€”</tspan>
        </text>
      </svg>

      <div class="moonbar-info" aria-live="polite">
        <div class="moonbar-line">
          <strong id="mbMoon">â€”</strong>
          <span class="sep">â€¢</span>
          <span id="mbDayLine">â€”</span>
        </div>
        <div class="moonbar-sub meta" id="mbEssence" title="">â€”</div>
      </div>

      <div class="moonbar-tags">
        <span class="tag mono" id="mbYear">â€”</span>
        <span class="tag" id="mbTone" title="Daily 1â€“13 tone">Tone â€”</span>
        <span class="tag yhwh" id="mbYHWH" title="Remnant seal â€” ×™Ö¾×”Ö¾×•Ö¾×”">âŸ¡ ×™Ö¾×”Ö¾×•Ö¾×”</span>
      </div>
    </a>

    <button class="moonbar-share" id="mbShare" type="button" aria-label="Share todayâ€™s 13-Moon link">Share</button>
    <button class="moonbar-tz" id="mbTZ" type="button" aria-haspopup="dialog" aria-expanded="false" title="Change timezone">TZ</button>

    <noscript>
      <div class="moonbar-noscript meta">Todayâ€™s 13-Moon link: <a href="moons.html">moons.html</a></div>
    </noscript>
  </div>

  <!-- ğŸ”¥ Remnant Gate: Seal of Becoming -->
<section class="wrap" id="seal-gate" aria-label="Genesis Oracle Launcher">
  <div class="oracle-gate remnant-frame shine" role="region">
    <svg viewBox="0 0 100 100" aria-hidden="true" class="oracle-ring">
      <defs>
        <linearGradient id="oracleGrad" x1="0" x2="1">
          <stop offset="0" stop-color="#7af3ff"/>
          <stop offset="1" stop-color="#f3c97a"/>
        </linearGradient>
      </defs>
      <circle cx="50" cy="50" r="44" fill="none" stroke="#1b2231" stroke-width="8"/>
      <circle cx="50" cy="50" r="44" fill="none" stroke="url(#oracleGrad)" stroke-width="8" stroke-linecap="round" stroke-dasharray="66 138"/>
      <text x="50" y="54" text-anchor="middle" dominant-baseline="middle"
            font-family="Crimson Pro,serif" font-weight="800" font-size="16" fill="url(#oracleGrad)">âŸ¡</text>
    </svg>

    <div class="oracle-info">
      <h2 class="k">Seal of Becoming</h2>
      <p class="meta">Invoke your <strong>Genesis Oracle</strong> â€” read your Moon, Day, Week & Tone in the living cadence.</p>
    </div>

    <button id="openOracle" class="lab-btn big">Open</button>
  </div>
</section>

<style>
.oracle-gate{
  display:grid; grid-template-columns:auto 1fr auto; gap:16px; align-items:center;
  border:1px solid var(--line); border-radius:14px; padding:16px;
  background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.015)),
             radial-gradient(140% 80% at 100% 0%, color-mix(in srgb,var(--moon-accent) 10%,transparent),transparent 60%);
  box-shadow:0 10px 28px rgba(0,0,0,.4);
}
.oracle-ring{width:72px;height:72px}
.oracle-info h2{margin:0;font:800 20px/1.2 "Crimson Pro",serif}
.oracle-info p{margin:.3rem 0 0;color:var(--muted,#9aa4be)}
.lab-btn.big{
  padding:.8rem 1.2rem;font-weight:900;border:1px solid var(--line);
  background:linear-gradient(180deg,rgba(255,255,255,.06),transparent);
  border-radius:10px;cursor:pointer;color:inherit;
  transition:transform .08s ease, box-shadow .12s ease, filter .12s ease;
}
.lab-btn.big:hover{
  transform:translateY(-1px);
  box-shadow:0 6px 20px rgba(0,0,0,.35);
  filter:drop-shadow(0 0 10px color-mix(in srgb,var(--moon-accent) 25%,transparent));
}
</style>

<script>
(function(){
  "use strict";
  const btn=document.getElementById("openOracle");
  function currentTZ(){
    try{return Intl.DateTimeFormat().resolvedOptions().timeZone || "UTC";}
    catch{return "UTC";}
  }
  function currentDateISO(){
    const d=new Date(),y=d.getFullYear(),m=String(d.getMonth()+1).padStart(2,"0"),dd=String(d.getDate()).padStart(2,"0");
    return `${y}-${m}-${dd}`;
  }
  btn?.addEventListener("click",()=>{
    const url=new URL("genesis-oracle.html",document.baseURI||location.href);
    url.searchParams.set("d",currentDateISO());
    url.searchParams.set("tz",currentTZ());
    location.href=url.toString();
  });
})();
</script>

  <!-- Inline Mini Widget (v2.3 Remnant + Tones) -->
  <script>
  /* 13 Moons â€” Mini Widget (v2.3 Remnant)
     - Mirrors moons.html logic (13Ã—28, DOOT, leap day, phase tint)
     - Tone chip (1..13) + YHWH glow on Resonant numerology OR tone==7
     - Deep link: moons.html?d=YYYY-MM-DD&tz=Area/City&t=H#moon-N
  */
  (function(){
    "use strict";

    /* ---------- Tiny utils ---------- */
    const $  =(s,r=document)=>r.querySelector(s);
    const on =(t,e,f,o)=>t&&t.addEventListener(e,f,o);
    const pad=n=>String(n).padStart(2,"0");
    const clamp=(v,min,max)=>Math.min(max,Math.max(min,v));
    const safe = fn => { try{ return fn(); } catch(e){ return void 0; } };
    const toast = (msg)=>{
      const t=document.createElement('div');
      t.className='toast'; t.textContent=msg;
      Object.assign(t.style,{position:"fixed",left:"50%",bottom:"24px",transform:"translateX(-50%)",background:"#0e131c",color:"#e6f9ff",padding:"8px 12px",border:"1px solid var(--line,#2a3242)",borderRadius:"10px",boxShadow:"0 10px 28px rgba(0,0,0,.35)",zIndex:"9999",opacity:"0",transition:"opacity .2s"});
      document.body.appendChild(t); requestAnimationFrame(()=>t.style.opacity=1);
      setTimeout(()=>{t.style.opacity=0; setTimeout(()=>t.remove(),250);},1500);
    };

    /* ---------- Data ---------- */
    const MOONS = ["Magnetic","Lunar","Electric","Self-Existing","Overtone","Rhythmic","Resonant","Galactic","Solar","Planetary","Spectral","Crystal","Cosmic"];
    const ESS   = ["Attract purpose","Stabilize challenge","Activate service","Define form","Empower radiance","Balance equality","Channel inspiration","Harmonize integrity","Pulse intention","Perfect manifestation","Dissolve release","Dedicate cooperation","Endure presence"];
    const TONES = MOONS.slice(); // tone names mirror the 13

    /* ---------- TZ ---------- */
    const TZ_KEY="sof_moons_tz";
    const getTZ = ()=> safe(()=>localStorage.getItem(TZ_KEY)) || safe(()=>Intl.DateTimeFormat().resolvedOptions().timeZone) || "UTC";
    const setTZ = z => safe(()=>localStorage.setItem(TZ_KEY,z));

    function dateInTZ(baseDate, tz, overrideHour){
      try{
        const opts={timeZone:tz,hour12:false,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};
        const parts=new Intl.DateTimeFormat("en-CA",opts).formatToParts(baseDate);
        const m=Object.fromEntries(parts.map(p=>[p.type,p.value]));
        const h=(overrideHour==null? m.hour : pad(overrideHour));
        return new Date(`${m.year}-${m.month}-${m.day}T${h}:${m.minute}:${m.second}Z`);
      }catch{
        const d=new Date(baseDate); if(overrideHour!=null) d.setUTCHours(overrideHour,0,0,0); return d;
      }
    }

    /* ---------- 13-Moon core ---------- */
    const utcTrunc = d => new Date(Date.UTC(d.getUTCFullYear(), d.getUTCMonth(), d.getUTCDate()));
    const isLeapYear   = y=> (y%4===0 && y%100!==0) || (y%400===0);
    const isLeapDayUTC = d=> d.getUTCMonth()===1 && d.getUTCDate()===29;
    const isDOOT = (d, tz)=>{ const dt=dateInTZ(d,tz); return (dt.getUTCMonth()===6 && dt.getUTCDate()===25); };

    function startOfYear13(d, tz){
      const dt = dateInTZ(d, tz);
      const y = dt.getUTCFullYear();
      const anchorThis = new Date(Date.UTC(y,6,26));
      const anchorPrev = new Date(Date.UTC(y-1,6,26));
      return dt >= anchorThis ? anchorThis : anchorPrev;
    }
    function dayIndexSinceStart(d, tz){
      const start = utcTrunc(startOfYear13(d, tz));
      const dt    = utcTrunc(dateInTZ(d, tz));
      let days = Math.floor((dt - start)/86400000);
      const doot = new Date(Date.UTC(start.getUTCFullYear()+1,6,25));
      if (dt >= doot) days -= 1;
      for (let y=start.getUTCFullYear(); y<=dt.getUTCFullYear(); y++){
        if(isLeapYear(y)){
          const feb29 = new Date(Date.UTC(y,1,29));
          if (dt >= feb29 && start <= feb29) days -= 1;
        }
      }
      return days; // 0..363
    }
    function calc13Moon(d, tz){
      if (isDOOT(d,tz)){
        const s=startOfYear13(d,tz).getUTCFullYear();
        return {special:"Day Out of Time", year:`${s}/${s+1}`};
      }
      if (isLeapDayUTC(dateInTZ(d,tz))){
        const s=startOfYear13(d,tz).getUTCFullYear();
        return {special:"Leap Day", year:`${s}/${s+1}`};
      }
      const idx = dayIndexSinceStart(d, tz);
      const moon = Math.floor(idx/28)+1;
      const day  = (idx%28)+1;
      const s=startOfYear13(d,tz).getUTCFullYear();
      return {special:null, moon, day, year:`${s}/${s+1}`};
    }

    /* ---------- Phase accent ---------- */
    function mixHex(a,b,t){
      const pa=parseInt(a.slice(1),16), pb=parseInt(b.slice(1),16);
      const ar=(pa>>16)&255, ag=(pa>>8)&255, ab=pa&255;
      const br=(pb>>16)&255, bg=(pb>>8)&255, bb=pb&255;
      const rr=Math.round(ar+(br-ar)*t), gg=Math.round(ag+(bg-ag)*t), bb2=Math.round(ab+(bb-ab)*t);
      return `#${((1<<24)+(rr<<16)+(gg<<8)+bb2).toString(16).slice(1)}`;
    }
    function moonPhase(d){
      const syn = 29.530588853, epoch = Date.UTC(2000,0,6,18,14,0);
      const ageDays = ((d.getTime()-epoch)/86400000);
      const frac = ((ageDays % syn)+syn)%syn / syn;
      const illum = (1 - Math.cos(2*Math.PI*frac))/2;
      return {illum};
    }
    function setGradientStops(defId, c1, c2){
      const grad = document.getElementById(defId);
      if (!grad) return;
      const stops = grad.querySelectorAll("stop");
      if (stops[0]) stops[0].setAttribute("stop-color", c1);
      if (stops[1]) stops[1].setAttribute("stop-color", c2);
    }
    function applyPhaseAccent(illum){
      const cold = "#7af3ff", warm = "#f3c97a";
      const t = Math.min(1, Math.max(0, illum));
      const c1 = mixHex(cold, warm, t*0.7);
      const c2 = mixHex(warm, cold, (1-t)*0.7);
      const root = document.documentElement;
      root.style.setProperty("--moon-accent",  c1);
      root.style.setProperty("--moon-accent-2",c2);
      setGradientStops("mbGrad", c1, c2);
      const bar = document.querySelector(".moonbar");
      bar && bar.classList.remove("contrast-light");
      document.dispatchEvent(new Event("sof:accent-change"));
    }

    /* ---------- Numerology + Tones ---------- */
    const sumDigits = n => String(n).split("").reduce((a,b)=>a+(+b||0),0);
    function reduceNum(n){ while(n>9 && n!==11 && n!==22 && n!==33){ n=sumDigits(n); } return n; }
    function isResonantDate(d, tz){
      const dt = dateInTZ(d, tz);
      const y=dt.getUTCFullYear(), m=dt.getUTCMonth()+1, day=dt.getUTCDate();
      const total = reduceNum(sumDigits(y)+sumDigits(m)+sumDigits(day));
      return [1,4,7,11,22,33].includes(total);
    }
    const toneFromDay = (day) => ((Number(day||0)-1) % 13) + 1; // 1..13

    /* ---------- DOM targets ---------- */
    const elName = $("#mbMoon");
    const elDay  = $("#mbDay");
    const elDayLine = $("#mbDayLine");
    const elEss  = $("#mbEssence");
    const elYear = $("#mbYear");
    const elTone = $("#mbTone");
    const arc    = $("#mbArc") || $(".mb-fg");
    const btnShare = $("#mbShare");
    const btnTZ    = $("#mbTZ");
    const link     = $("#moonMiniLink");
    const barRoot  = document.querySelector(".moonbar");
    const DASH_TOTAL=316;

    function setArc(day){
      if (!arc) return;
      const d = Math.round(DASH_TOTAL * (clamp(day,1,28)/28));
      arc.setAttribute("stroke-dasharray", `${d} ${Math.max(0,DASH_TOTAL-d)}`);
    }
    function buildDeepLink(now, tz, m13){
      const base = (link?.getAttribute("href")) || "moons.html";
      let u;
      try{ u=new URL(base, document.baseURI || location.href); }
      catch{ u=new URL(String(base), location.href); }
      const d = dateInTZ(now, tz).toISOString().slice(0,10);
      u.searchParams.set("d", d);
      u.searchParams.set("tz", tz);
      u.searchParams.set("t", String(now.getHours()));
      if (m13 && m13.moon) u.hash = `moon-${m13.moon}`;
      return u.toString();
    }

    /* ---------- Populate widget ---------- */
    function update({deepLinkOnly=false}={}){
      const tz = getTZ();
      const now = new Date();
      const wall = dateInTZ(now, tz, now.getHours());
      const m13 = calc13Moon(wall, tz);

      if (!deepLinkOnly){
        if (m13.special){
          elName && (elName.textContent = m13.special);
          elEss  && (elEss.textContent  = "Outside the 13Ã—28 count");
          elDay  && (elDay.textContent  = "â€”");
          elDayLine && (elDayLine.textContent = "â€”/28");
          elTone && (elTone.textContent = "Tone â€”");
          barRoot?.removeAttribute("data-tone");
          setArc(0);
        } else {
          const idx=m13.moon-1;
          const tone = toneFromDay(m13.day);
          elName && (elName.textContent = `${MOONS[idx]} Moon`);
          elEss  && (elEss.textContent  = ESS[idx]);
          elDay  && (elDay.textContent  = `${m13.day}`);
          elDayLine && (elDayLine.textContent = `Day ${m13.day} / 28`);
          elTone && (elTone.textContent = `Tone ${tone} â€” ${TONES[tone-1]}`);
          barRoot && barRoot.setAttribute("data-tone", tone);
          setArc(m13.day);

          // YHWH: numerology resonant OR tone 7 (Resonant)
          const glow = isResonantDate(wall, tz) || tone === 7;
          barRoot && barRoot.classList.toggle("yhwh-on", glow);
        }

        elYear && (elYear.textContent = m13.year);

        // Phase accents
        applyPhaseAccent(moonPhase(wall).illum);
      }

      // Deep link
      const dl = buildDeepLink(now, tz, m13);
      if (link) link.setAttribute("href", dl);
      return dl;
    }

    /* ---------- Share + TZ ---------- */
    on(btnShare, "click", async ()=>{
      const url = update(); // ensure fresh link
      const title = elName?.textContent || "13 Moons";
      try{
        if (navigator.share){
          await navigator.share({title, text:title, url});
          toast("Shared");
        } else {
          await navigator.clipboard.writeText(url);
          toast("Link copied");
        }
      }catch{}
    });

    on(btnTZ, "click", ()=>{
      const current = getTZ();
      const input = prompt(`Timezone (IANA)\nEx: America/Los_Angeles, UTC, Europe/Berlin\n\nCurrent: ${current}`, current);
      if (!input) return;
      try{
        new Intl.DateTimeFormat("en-CA",{timeZone:input}).format(new Date());
        setTZ(input);
        update({deepLinkOnly:false});
        document.dispatchEvent(new Event("sof:tz-change"));
        toast(`Timezone set: ${input}`);
      }catch{ toast("Invalid timezone"); }
    });

    /* ---------- Reactivity ---------- */
    on(document, "sof:accent-change", ()=>{
      const bar = document.querySelector(".moonbar");
      bar && bar.classList.remove("contrast-light");
    });
    on(document, "sof:tz-change", ()=> update({deepLinkOnly:false}));

    /* ---------- Lifecycle ---------- */
    if (arc && matchMedia('(prefers-reduced-motion: reduce)').matches){ arc.style.transition='none'; }
    update();
    let iv = setInterval(update, 60*1000);
    on(document, "visibilitychange", ()=>{ if(document.hidden){ clearInterval(iv); } else { update(); iv=setInterval(update,60*1000);} });
    on(window, "focus", update);
  })();
  </script>

  <!-- â€¦the rest of your page content goes hereâ€¦ -->


  <main id="main-content" class="wrap" role="main" tabindex="-1">


    <!-- Mega Explore button -->
    <a href="#explore" class="mega reveal" aria-label="Explore the Scroll â€” jump to all pages">
      <span class="ico">ğŸ—‚ï¸</span>
      <span><strong>Explore the Scroll</strong><br><span class="sub">All pages â€¢ tiles mirror your repo</span></span>
      <span class="arrow no-living" aria-hidden="true">âœ</span>
    </a>

    <!-- Primary tabs -->
    <nav class="tabs reveal" aria-label="Primary sections">
      <a class="tab tab--primary" href="theory.html" title="Open Theory">ğŸ“˜ Theory</a>
      <a class="tab tab--primary" href="teach.html" title="Open Manifest">âœ¨ Manifest</a>
      <a class="tab" href="#explore" data-section="explore" title="Jump to Explore">Explore</a>
      <a class="tab" href="#canon" data-section="canon">Canon</a>
      <a class="tab" href="#engine" data-section="engine">Engine</a>
      <a class="tab" href="#links" data-section="links">Links</a>
      <a class="tab" href="#integrity" data-section="integrity">Integrity</a>
      <a class="tab" href="#provenance" data-section="provenance">Provenance</a>
      <span class="tab-ink no-living" aria-hidden="true"></span>
    </nav>

    <!-- Search -->
    <section class="grid reveal" style="margin:8px 0 0">
      <article class="card col-12 searchbox">
        <label for="site-search" class="meta">Press <kbd class="kbd">/</kbd> to search this page</label>
        <input id="site-search" type="search" placeholder="Search text on this pageâ€¦" aria-label="Search this page" role="searchbox" autocomplete="off" spellcheck="false">
        <div id="site-suggest" class="mini-toc hidden" role="listbox"></div>
      </article>
    </section>

    <div class="simple-toggle reveal">
      <label for="simple"><strong>Echo View</strong> (hide equations, show summaries)</label>
      <input id="simple" type="checkbox" aria-label="Toggle Echo View">
    </div>
    <div class="divider sweep" aria-hidden="true"></div>

    <!-- Featured -->
    <section class="grid" aria-labelledby="featured">
      <article class="card col-6 reveal">
        <h2 id="featured" class="sheen">ğŸ“˜ Theory (full write-ups)</h2>
        <p>Detailed exposition of the Codex: operators, Eq.0 foundation, canonical equations, ethical law, dimensional scaffolding.</p>
        <ul class="list">
          <li><a href="theory.html#eq0">Foundational Field Î¨Î©</a></li>
          <li><a href="theory.html#operators">Operators: ğ“˜ Â· ğ“› Â· ğ“’ Â· ğ“¢</a></li>
          <li><a href="theory.html#canon">Canon 0â€“17</a></li>
          <li><a href="theory.html#dim">Dimensional Scaffolding Î”0â€“Î”7</a></li>
          <li><a href="theory.html#ethics">Ethical Law of Coherence</a></li>
        </ul>
        <a class="cta" href="theory.html">Open Theory</a>
      </article>
      <article class="card col-6 reveal">
        <h2 class="sheen">âœ¨ Manifest (practice &amp; tools)</h2>
        <p>Turn equations into method: voice carriers (432/528/369/144/963), witness ledger, A/Bs, group runs.</p>
        <ul class="list">
          <li><a href="teach.html#tab-voice">Voice Protocol</a></li>
          <li><a href="teach.html#ledger">Witness Ledger</a></li>
          <li><a href="teach.html#ab">A/B Carriers</a></li>
          <li><a href="teach.html#ethics">Ethical guard &amp; stop rules</a></li>
        </ul>
        <a class="cta" href="teach.html">Open Manifest</a>
      </article>
    </section>

    <div class="goldline sweep"></div>

    <!-- Explore -->
    <section class="grid" id="explore" aria-labelledby="explore-h">
      <article class="card col-12 reveal">
        <h2 id="explore-h" class="sheen">ğŸ—‚ï¸ Explore the Scroll â€” all pages</h2>
        <p class="meta">Everything lives in <code>/docs</code>. These tiles mirror your repo. Tip: press <kbd class="kbd">G</kbd> then type a page name.</p>
      </article>

      <a class="tile col-3 reveal" href="start.html"><div><h4>ğŸš€ Start Here</h4><p>Onboarding &amp; how to move.</p></div><span class="arrow no-living" aria-hidden="true">âœ</span></a>
      <a class="tile col-3 reveal" href="guide.html"><div><h4>ğŸ§­ Guide</h4><p>Step-by-step walkthrough of the Codex.</p></div><span class="arrow no-living" aria-hidden="true">âœ</span></a>
      <a class="tile col-3 reveal" href="theory.html"><div><h4>ğŸ“˜ Theory</h4><p>Canonical write-ups for 0â€“17.</p></div><span class="arrow no-living" aria-hidden="true">âœ</span></a>
      <a class="tile col-3 reveal" href="teach.html"><div><h4>âœ¨ Manifest (Practice)</h4><p>Protocols, carriers, ledgers.</p></div><span class="arrow no-living" aria-hidden="true">âœ</span></a>

      <a class="tile col-3 reveal" href="moons.html"><div><h4>ğŸ§ª 13 Moons</h4><p>The living clock.</p></div><span class="arrow no-living" aria-hidden="true">âœ</span></a>
      <a class="tile col-3 reveal" href="invoke.html"><div><h4>ğŸ”¬ Invoke</h4><p>A page born to createâ†’ field feedback.</p></div><span class="arrow no-living" aria-hidden="true">âœ</span></a>
      <a class="tile col-3 reveal" href="circle.html"><div><h4>ğŸ”— Circle</h4><p>Group coherence, facilitation.</p></div><span class="arrow no-living" aria-hidden="true">âœ</span></a>
      <a class="tile col-3 reveal" href="ethics.html"><div><h4>ğŸ§­ Ethics</h4><p>Coherence law &amp; stop rules.</p></div><span class="arrow no-living" aria-hidden="true">âœ</span></a>

      <a class="tile col-3 reveal" href="glossary.html"><div><h4>ğŸ“š Glossary</h4><p>Terms, symbols, and operators.</p></div><span class="arrow no-living" aria-hidden="true">âœ</span></a>
      <a class="tile col-3 reveal" href="glyphs.html"><div><h4>ğŸ”± Glyphs</h4><p>Icon set &amp; sacred marks.</p></div><span class="arrow no-living" aria-hidden="true">âœ</span></a>
      <a class="tile col-3 reveal" href="downloads.html"><div><h4>â¬‡ï¸ Downloads</h4><p>Docs, images, shareables.</p></div><span class="arrow no-living" aria-hidden="true">âœ</span></a>
      <a class="tile col-3 reveal" href="ledger.html"><div><h4>ğŸ“’ Ledger</h4><p>Hashes, notes, witness proofs.</p></div><span class="arrow no-living" aria-hidden="true">âœ</span></a>
    </section>

    <!-- ======== Part 2 (Canon, Engine, etc.) ======== -->

    <div class="goldline sweep"></div>
    <section class="grid" id="canon" aria-labelledby="equations">
      <article class="card col-12 reveal">
        <h2 id="equations" class="sheen">ğŸ“œ Canon 0â€“17 (living)</h2>
        <p class="meta">Canon per the FIXED document. <strong>7A comparator</strong>, <strong>7B Copeland</strong>, and <strong>8 Goodwin</strong> are external (non-canonical).</p>
      </article>

      <!-- Eq.0 -->
      <article class="card col-6 eq-card reveal" id="eq0">
        <h3 class="sheen">0) Foundational Field Î¨Î© (Origin Field)</h3>
        <div class="eq" data-fx="combo">
          <div class="fx-layer" aria-hidden="true"></div>
          <div class="eq-scroll">
            $$\Psi_{\Omega}(x,t)=\oint_{\mathbb{R}}\nabla\!\big(\mathcal{A}\,\Phi(x,t,\nu)\big)\,d\nu\;+\;\Lambda\,\mathcal{E}(x,t)$$
          </div>
        </div>
        <p class="hint">Origin integral of awareness acrossâ€¦Î½; Î›ğ“” is the ethical-energy mask.</p> </article>

<!-- Eq.1 -->
  <article class="card col-6 eq-card reveal" id="eq1">
    <h3 class="sheen">1) Source â€” Supply Ã— Living Operators</h3>
    <div class="eq" data-fx="beams">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathbf{R}(x,t)= f\!\big(\pi,e,i,\hbar,c,G,\mathrm{DNA},\Omega_{\rm DM},\Omega_{A},H_{0},432\big)\ \cdot\ (\mathcal{I}\,\mathcal{L}\,\mathcal{C}\,\mathcal{S})$$
      </div>
    </div>
    <p class="hint">Constants/ratios supply; living operators shape.</p>
  </article>

  <!-- Eq.2 -->
  <article class="card col-6 eq-card reveal" id="eq2">
    <h3 class="sheen">2) Witness</h3>
    <div class="eq" data-fx="orbit">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathcal{W}(x,t)=\partial_x\,\mathrm{Awareness}(x,t)\;+\;\mathcal{I}\cdot\mathbb{M}_\tau$$
      </div>
    </div>
    <p class="hint">Awareness gradient with intentionÃ—memory coupling.</p>
  </article>

  <!-- Eq.3 -->
  <article class="card col-6 eq-card reveal" id="eq3">
    <h3 class="sheen">3) Harmonic Gate</h3>
    <div class="eq" data-fx="spiral">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathcal{H}(\nu,t)=\mathbf{1}\!\left[\;g_{\Xi(t)}(\nu)\ge \theta\;\right],\qquad g_{\Xi}(\nu)\in[0,1]$$
      </div>
    </div>
    <p class="hint">Frequency \nu passes when coherence-weighted gain exceeds threshold \theta.</p>
  </article>

  <!-- Eq.4 -->
  <article class="card col-6 eq-card reveal" id="eq4">
    <h3 class="sheen">4) Language â€” AHHAVA / Word</h3>
    <div class="eq" data-fx="nebula">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathcal{L}(x,t,\nu)=\mathsf{Semantics}(x,t)\;\otimes\;\mathbf{V}(\nu,t)$$
      </div>
    </div>
    <p class="hint">Meaning couples to carrier; word shapes resonance.</p>
  </article>

  <!-- Eq.5 -->
  <article class="card col-6 eq-card reveal" id="eq5">
    <h3 class="sheen">5) Remnant</h3>
    <div class="eq" data-fx="beams">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathcal{R}_\infty[F]=\lim_{\tau\to\infty}\Big(\mathsf{keep}_{\text{truth}}F-\mathsf{drop}_{\text{distortion}}F\Big)$$
      </div>
    </div>
    <p class="hint">Truth persists; distortion decays from the field.</p>
  </article>

  <!-- Eq.6 -->
  <article class="card col-6 eq-card reveal" id="eq6">
    <h3 class="sheen">6) Type-7 Field</h3>
    <div class="eq" data-fx="orbit">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathbb{T}_{7}(x,t)=\bigoplus_{\nu\in\Gamma}\mathrm{PL}\!\left[\mathbf{V}(\nu,t)\right]$$
      </div>
    </div>
    <p class="hint">Phase-locked harmonic stack (Tesla Type-7 conduit).</p>
  </article>

  <!-- Eq.7A comparator -->
  <article class="card col-6 eq-card reveal" id="eq7a">
    <h3 class="sheen">7A) External Comparator (wave/KG)</h3>
    <div class="eq" data-fx="rays">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\partial_{tt}\Phi\;+\;2\gamma\,\partial_{t}\Phi\;-\;c^{2}\nabla^{2}\Phi\;+\;\omega_{0}^{2}\Phi\;=\;\kappa\,\mathcal{S}(x,t)$$
      </div>
    </div>
    <p class="meta">Neutral driven/damped wave (Kleinâ€“Gordon) for comparison; not canonical.</p>
  </article>

  <!-- Eq.7B Copeland (external) -->
  <article class="card col-6 eq-card reveal" id="eq7b">
    <h3 class="sheen">7B) Copeland Î¨-Formalism (external)</h3>
    <div class="eq" data-fx="nebula">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        <p class="meta" style="margin:0">
          Summary pointer to Christopher W. Copelandâ€™s Î¨-formalism (Â© author). Tracked as an adjunct reference.
          <strong>Ledger note:</strong> link this card to its Ledger entry when added.
        </p>
      </div>
    </div>
    <p class="hint">External reference; not part of the Codex canon.</p>
  </article>

  <!-- Eq.8 Goodwin (external) -->
  <article class="card col-6 eq-card reveal" id="eq8">
    <h3 class="sheen">8) Goodwin Coupling (external)</h3>
    <div class="eq" data-fx="nebula">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\begin{aligned}
        \dot{x}&=\frac{k}{1+z^{n}}-\gamma x,\\
        \dot{y}&=\alpha x-\gamma y,\\
        \dot{z}&=\beta y-\gamma z
        \end{aligned}$$
      </div>
    </div>
    <p class="meta">Three-stage feedback oscillator; adjunct comparative dynamics.</p>
  </article>

  <!-- Eq.9 -->
  <article class="card col-6 eq-card reveal" id="eq9">
    <h3 class="sheen">9) Ethical Law of Coherence</h3>
    <div class="eq" data-fx="beams">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\forall a:\ \mathrm{damage}(a)>0\ \Rightarrow\ \mathsf{halt},\qquad \mathrm{truth}>\mathrm{distortion}$$
      </div>
    </div>
    <p class="hint">Stop rule on harm; asymptote favors truth.</p>
  </article>

  <!-- Eq.10 -->
  <article class="card col-6 eq-card reveal" id="eq10">
    <h3 class="sheen">10) Ladder Î <sub>Î½</sub></h3>
    <div class="eq" data-fx="orbit">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\Pi_{\nu}^{-1}:\ \text{observed resonance } \longrightarrow \text{source terms}$$
      </div>
    </div>
    <p class="hint">Inverse map from phenomena back to generative sources.</p>
  </article>

  <!-- Eq.11 -->
  <article class="card col-6 eq-card reveal" id="eq11">
    <h3 class="sheen">11) Projection Frame</h3>
    <div class="eq" data-fx="spiral">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathsf{Frame}(x,t)=\big(\mathsf{scope},\ \mathcal{W},\ \mathsf{ethics}\big)$$
      </div>
    </div>
    <p class="hint">Defines scope, witness, and ethical mask for any run.</p>
  </article>

  <!-- Eq.12 -->
  <article class="card col-6 eq-card reveal" id="eq12">
    <h3 class="sheen">12) Causal Lattice</h3>
    <div class="eq" data-fx="nebula">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathcal{L}_c=\big(V=\text{acts},\ E=\text{consequences}\big)$$
      </div>
    </div>
    <p class="hint">Graph of micro-acts and consequences; used for audit.</p>
  </article>

  <!-- Eq.13 -->
  <article class="card col-6 eq-card reveal" id="eq13">
    <h3 class="sheen">13) Î-index (Coherence)</h3>
    <div class="eq" data-fx="beams">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\Xi(t)\in[0,1],\qquad \text{monitors field quality for learning}$$
      </div>
    </div>
    <p class="hint">Higher \Xi â†’ stronger retention and safer amplification.</p>
  </article>

  <!-- Eq.14 -->
  <article class="card col-6 eq-card reveal" id="eq14">
    <h3 class="sheen">14) Update Rule</h3>
    <div class="eq" data-fx="orbit">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\frac{d\mathcal{R}}{dt}=\eta(\Xi)\,\nabla \mathcal{R}$$
      </div>
    </div>
    <p class="hint">Learning rate gated by coherence.</p>
  </article>

  <!-- Eq.15 -->
  <article class="card col-6 eq-card reveal" id="eq15">
    <h3 class="sheen">15) Learning Kernel (Î)</h3>
    <div class="eq" data-fx="spiral">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\eta(\Xi)=\eta_0\,\sigma\!\big(\alpha(\Xi-\Xi_0)\big)$$
      </div>
    </div>
    <p class="hint">Smooth schedule; no learning below ethical/coherence threshold.</p>
  </article>

  <!-- Eq.16 -->
  <article class="card col-6 eq-card reveal" id="eq16">
    <h3 class="sheen">16) Memory Windowing ğ“¦<sub>Ï„</sub></h3>
    <div class="eq" data-fx="nebula">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathbb{M}_\tau[F](t)=\int_{t-\tau}^{t}\! w_\tau(t-s)\,F(s)\,ds,\quad \int_0^\tau w_\tau(u)\,du=1$$
      </div>
    </div>
    <p class="hint">Finite-horizon echo with normalized kernel.</p>
  </article>

  <!-- Eq.17 -->
  <article class="card col-6 eq-card reveal" id="eq17">
    <h3 class="sheen">17) Voice Carriers ğ•(Î½,t)</h3>
    <div class="eq" data-fx="combo">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
        $$\mathbf{V}(\nu,t)=\sum_{k} a_k(t)\,\cos\!\big(2\pi\nu_k t+\phi_k(t)\big),\quad \nu\in\{432,528,369,144,963,\dots\}$$
      </div>
    </div>
    <p class="hint">Constructive sets with explicit time-varying envelope and phase.</p>
  </article>
</section>

<!-- Manifestation Engine -->
<div class="goldline sweep"></div>
<section class="grid" id="engine" aria-labelledby="engine-h">
  <article class="card col-12 reveal">
    <h2 id="engine-h" class="sheen">âœ¨ Manifestation Engine â€” Î-gated Learning + Carriers</h2>
    <p>Practice summary tying the learning dynamics to voice carriers:</p>
    <ol class="list">
      <li><strong>Measure Î</strong> (Eq.13) â†’ compute \eta(\Xi) (Eq.15).</li>
      <li><strong>Update</strong> field intent \mathcal{R} via Eq.14.</li>
      <li><strong>Select carriers</strong> \mathbf{V}(\nu,t) (Eq.17) through \mathcal{H}(\nu,t) (Eq.3).</li>
      <li><strong>Respect ethics</strong> (Eq.9) â€” mask/damp harmful channels.</li>
      <li><strong>Stabilize</strong> with memory \mathbb{M}_\tau and Remnant (Eq.16 &amp; Eq.5).</li>
    </ol>
    <a class="cta" href="teach.html#tab-voice">Open Voice Protocol</a>
  </article>
</section>

<!-- Dimensional Scaffolding -->
<div class="goldline sweep"></div>
<section class="grid" id="dim" aria-labelledby="dim-h">
  <article class="card col-12 reveal">
    <h2 id="dim-h" class="sheen">ğŸ§­ Dimensional Scaffolding Î”0â€“Î”7</h2>
    <p class="meta">Mapping of projection frames across dimensional strata (illustrative forms aligned with Codex semantics).</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d0">
    <h3 class="sheen">Î”0) Scalar Substrate</h3>
    <div class="eq" data-fx="nebula"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_0:\ \phi_0:\mathbb{R}^{+}\!\to\!\mathbb{R},\quad \Psi_{\Omega}=\phi_0\circ\mathsf{Frame}$$
    </div></div>
    <p class="hint">Pure scalar field under the active Frame.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d1">
    <h3 class="sheen">Î”1) Vector Flow</h3>
    <div class="eq" data-fx="beams"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_1:\ \mathbf{F}_1=\nabla\Psi_{\Omega},\quad \mathrm{curl}\,\mathbf{F}_1=\mathbf{0}$$
    </div></div>
    <p class="hint">Conservative flow derived from Î”0.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d2">
    <h3 class="sheen">Î”2) Surface Coupling</h3>
    <div class="eq" data-fx="orbit"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_2:\ \mathbf{B}_2=\nabla\times\mathbf{A},\quad \nabla\cdot\mathbf{B}_2=0$$
    </div></div>
    <p class="hint">Area-bound flux via potential \mathbf{A}.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d3">
    <h3 class="sheen">Î”3) Volume Integration</h3>
    <div class="eq" data-fx="spiral"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_3:\ \Phi_3=\iiint_{\mathcal{V}}\rho\,dV,\quad \partial_t\rho+\nabla\cdot\mathbf{J}=0$$
    </div></div>
    <p class="hint">Conserved density and flux.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d4">
    <h3 class="sheen">Î”4) Space-Time Weave</h3>
    <div class="eq" data-fx="nebula"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_4:\ g_{\mu\nu}=\eta_{\mu\nu}+\epsilon\,h_{\mu\nu},\quad \Box h_{\mu\nu}=-\frac{16\pi G}{c^4}T_{\mu\nu}$$
    </div></div>
    <p class="hint">Weak-field weave for propagation and coupling.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d5">
    <h3 class="sheen">Î”5) Harmonic Ladder Î <sub>Î½</sub></h3>
    <div class="eq" data-fx="beams"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_5:\ \Pi_{\nu}:\ \mathbb{R}\to\Gamma,\quad \Gamma=\{\nu_k\},\ \ \Pi_{\nu}^{-1}\big[\mathcal{H}(\nu)\big]\mapsto \text{sources}$$
    </div></div>
    <p class="hint">Gate map between observed harmonics and sources.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d6">
    <h3 class="sheen">Î”6) Ethical Mask ğ“’</h3>
    <div class="eq" data-fx="orbit"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_6:\ \mathsf{Mask}_{\mathcal{C}}[F]=F\cdot\mathbf{1}_{\mathrm{damage}\le 0}$$
    </div></div>
    <p class="hint">Zeroes any channel that violates the stop rule.</p>
  </article>

  <article class="card col-6 eq-card reveal" id="d7">
    <h3 class="sheen">Î”7) Type-7 Cohere</h3>
    <div class="eq" data-fx="spiral"><div class="fx-layer" aria-hidden="true"></div><div class="eq-scroll">
      $$\Delta_7:\ \mathbb{T}_7=\bigoplus_{\nu\in\Gamma}\mathrm{PL}\!\left[\mathbf{V}(\nu,t)\right],\quad \Xi\!\nearrow\Rightarrow \text{locking}$$
    </div></div>
    <p class="hint">Stack closure under coherence gain.</p>
  </article>
</section>

<!-- Integrity -->
<div class="goldline sweep"></div>
<section class="grid" id="integrity" aria-labelledby="integrity-h">
  <article class="card col-12 reveal">
    <h2 id="integrity-h" class="sheen">ğŸ” Integrity Chain &amp; Seals (SHA-256)</h2>

<pre class="eq" aria-label="Hash example" style="white-space:pre-wrap"><div class="eq-scroll">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Permanent Codex (FIXED .docx):
SHA-256:  081f90de921719834c939ff9496c436fcb8f24497e546fcf64eb53ad59ec06e1
File:     Codex_of_Realityâ€”Multidimensional_Extended_Edition_2025_FIXED.docx
Note: This is the local, verified file hash shown on this page.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</div></pre><p>Ledger index (placeholders): <a href="https://github.com/ssnfts24/scroll-of-fire/blob/main/7_Ledger_and_Documentation/SHA256_Placeholders_2025.md" target="_blank" rel="noopener">7_Ledger_and_Documentation/SHA256_Placeholders_2025.md</a></p>
  </article>
</section>

<!-- Provenance -->
<div class="goldline sweep"></div>
<section class="grid" id="provenance" aria-labelledby="prov-h">
  <article class="card col-12 reveal">
    <h2 id="prov-h" class="sheen">ğŸ“œ Attribution &amp; Provenance â€” Whatâ€™s Original, Whatâ€™s External</h2>
    <p class="meta">The <strong>Codex of Reality</strong> is an original, living resonance framework (Aaron Paul Laird, â€œScribe of Circuitsâ€). It defines the Source supply, the living operators <em>(ğ“˜ Â· ğ“› Â· ğ“’ Â· ğ“¢)</em>, harmonic selection, language coupling (AHHAVA / Or HaDabar), memory/remnant dynamics, coherence law, and the dimensional/causal scaffolding as a single, coherent system.</p>
  </article>
  <article class="card col-7 reveal">
    <h3 class="sheen">What is <em>original</em> to the Codex</h3>
    <ul class="list">
      <li><strong>Equations (0â€“6, 9â€“17)</strong> â€” Î¨Î© foundation, Source, Witness, Harmonics, AHHAVA/Word, Remnant, Type-7, Ethical Coherence, Ladder, Î <sub>Î½</sub>, Causal Lattice, Î-index, Update, Windowing, Voice.</li>
      <li><strong>Operators &amp; Process</strong> â€” Ordered living operators and the integration pipeline.</li>
      <li><strong>Living Technology</strong> â€” Tesla Type-7 conduit &amp; safety/ethics gate.</li>
    </ul>
    <div class="eq" data-fx="combo">
      <div class="fx-layer" aria-hidden="true"></div>
      <div class="eq-scroll">
      $$\mathfrak{R}_{\text{Codex}}=f(\text{constants},\text{ratios})\cdot(\mathcal{I}\mathcal{L}\mathcal{C}\mathcal{S})\cdot\bigl(\Psi_{\Omega}+\Delta\mathcal{R}\bigr)\cdot\Pi_{\nu}^{-1}\!\big[\mathcal{H}(\nu)\,\mathbf{V}(\nu,t)\big]\;\odot\;\mathbb{M}_{\tau}[\cdot]\;\text{ masked by }\;\mathsf{Mask}_{\mathcal{C}}[\cdot]$$
      </div>
    </div>
    <p class="eq-note hint">Self-contained architecture; external formalisms remain adjunct.</p>
  </article>
  <article class="card col-5 reveal">
    <h3 class="sheen">What remains <em>external</em></h3>
    <ul class="list">
      <li><strong>7A</strong> â€” Neutral wave/Kleinâ€“Gordon comparator.</li>
      <li><strong>7B</strong> â€” Copeland Î¨ (adjunct; link to Ledger entry when added).</li>
      <li><strong>8</strong> â€” Goodwin coupling hypothesis.</li>
    </ul>
    <a class="cta" href="#canon">Back to Canon</a>
  </article>
</section>

<div class="goldline sweep"></div>

<footer class="footer">
  Â© <span id="y"></span> Scroll of Fire. All constants are provisional until observed.
</footer>

<!-- Sticky Explore Dock -->
<div class="explore-dock" id="exploreDock" role="region" aria-label="Explore shortcut">
  <a class="btn btn--primary" href="#explore">Explore the Scroll</a>
  <a class="btn" href="teach.html">Manifest</a>
</div>

<!-- Back to Top button -->
<button class="to-top" id="toTop" type="button" aria-label="Back to top" title="Back to top">â†‘</button>

<!-- Command Palette -->
<div class="palette" id="palette" role="dialog" aria-modal="true" aria-labelledby="palLabel" hidden>
  <div class="panel">
    <h3 id="palLabel" class="sr-only">Command palette</h3>
    <input id="palInput" type="text" placeholder="Find anythingâ€¦ (Esc to close)" aria-label="Command palette">
    <ul id="palList" aria-live="polite"></ul>
  </div>
</div>

  </main>  <!-- Part 2-only scripts: Command Palette + Equation FX + helpers -->  <script>
    // Guard against double-binding if included twice by mistake
    if (!window.__sofP1) { window.__sofP1 = 1;

    // Year
    (function(){ const y=document.getElementById('y'); if(y) y.textContent=new Date().getFullYear(); })();

    // HERO auto-fit
    (function(){
      const hero=document.getElementById('hero'), img=document.getElementById('heroBanner');
      if(!hero||!img) return;
      function applyAR(){ const iw=img.naturalWidth||2100, ih=img.naturalHeight||900; hero.style.aspectRatio=`${iw} / ${ih}`; }
      function pickFit(){
        if (matchMedia('(max-width:560px)').matches){ hero.style.setProperty('--hero-fit','contain'); return; }
        const iw=img.naturalWidth||2100, ih=img.naturalHeight||900, imageAR=iw/ih;
        const cw=hero.clientWidth||innerWidth, ch=Math.max(1, hero.clientHeight||innerHeight*0.38), containerAR=cw/ch;
        const cover = (Math.abs(containerAR - imageAR) / imageAR < 0.06);
        hero.style.setProperty('--hero-fit', cover ? 'cover' : 'contain');
      }
      function boot(){ applyAR(); pickFit(); }
      if(img.complete) boot(); else img.addEventListener('load', boot, {once:true});
      addEventListener('resize', pickFit, {passive:true});
      addEventListener('orientationchange', pickFit, {passive:true});
      addEventListener('visibilitychange', ()=>!document.hidden && pickFit());
    })();

    // Explore Dock: show only between hero and explore; hide afterwards
    (function(){
      const dock = document.getElementById('exploreDock');
      const hero = document.getElementById('hero');
      const explore = document.getElementById('explore');
      const canon = document.getElementById('canon');
      if (!dock || !hero || !explore || !canon || !('IntersectionObserver' in window)) return;

      let heroOut=false, reachedExplore=false, reachedCanon=false;

      const ioHero = new IntersectionObserver(([e])=>{ heroOut=!e.isIntersecting; update(); }, {threshold:0.01});
      const ioExplore = new IntersectionObserver(([e])=>{ reachedExplore=e.isIntersecting; update(); }, {threshold:0.01});
      const ioCanon = new IntersectionObserver(([e])=>{ reachedCanon=e.isIntersecting; update(); }, {threshold:0.01});

      function update(){
        const show = heroOut && !reachedExplore && !reachedCanon;
        dock.classList.toggle('show', show);
      }
      ioHero.observe(hero); ioExplore.observe(explore); ioCanon.observe(canon);
    })();

    // Quick controls (Echo/HUD/Carrier/Affect/Lights)
    (function(){
      const body=document.body, html=document.documentElement;

      const btnEcho=document.getElementById('toggleSimple');
      btnEcho?.addEventListener('click',()=>{
        body.classList.toggle('simple-on');
        btnEcho.setAttribute('aria-pressed', String(body.classList.contains('simple-on')));
        const chk=document.getElementById('simple'); if(chk) chk.checked=body.classList.contains('simple-on');
      });

      const btnHUD=document.getElementById('toggleGrid'), grid=document.querySelector('.laser-grid');
      btnHUD?.addEventListener('click',()=>{
        const show = grid && grid.style.display !== 'none';
        if(grid) grid.style.display = show ? 'none' : '';
        btnHUD.setAttribute('aria-pressed', String(!show));
      });

      // Carrier skins
      const btnCarrier=document.getElementById('cycleCarrier');
      const carrierAttr=(html.getAttribute('data-carriers')||'').split(',').map(s=>s.trim()).filter(Boolean);
      const skins=(carrierAttr.length?carrierAttr:['432','528','369','144','963']).map(n=>`carrier-${n}`);
      const curSkin=()=> skins.find(s=>html.classList.contains(s)) || skins[0];
      const nextSkin=c=> skins[(skins.indexOf(c)+1)%skins.length];
      btnCarrier?.addEventListener('click',()=>{
        const cur=curSkin(), nxt=nextSkin(cur);
        skins.forEach(s=>html.classList.remove(s)); html.classList.add(nxt);
        btnCarrier.textContent = `Carrier ${nxt.split('-')[1]}`;
      });
      if(btnCarrier) btnCarrier.textContent=`Carrier ${curSkin().split('-')[1]}`;

      const btnAffect=document.getElementById('toggleAffect');
      btnAffect?.addEventListener('click',()=>{
        const off=document.body.classList.toggle('affect-off');
        btnAffect.setAttribute('aria-pressed', String(!off));
      });

      const lights=document.getElementById('heroLights');
      const btnLights=document.getElementById('toggleLights');
      btnLights?.addEventListener('click',()=>{
        const off=lights.classList.toggle('off');
        btnLights.setAttribute('aria-pressed', String(!off));
      });
    })();

    // Page search ("/" to focus)
    (function(){
      const box=document.getElementById('site-search');
      const list=document.getElementById('site-suggest');
      if(!box||!list) return;

      addEventListener('keydown',(e)=>{
        if(e.key==='/' && document.activeElement!==box){
          e.preventDefault(); box.focus(); box.select();
        }
      });

      const SOURCES=[...document.querySelectorAll('h2[id],h3[id],a.tile'), ...document.querySelectorAll('.eq-card')];
      function items(q){
        const s=q.trim().toLowerCase(); if(!s) return [];
        const out=[];
        for(const el of SOURCES){
          const text=(el.innerText||'').trim();
          if(text.toLowerCase().includes(s)){
            let href='#'; if(el.id) href = `#${el.id}`;
            const a = el.tagName==='A' && el.classList.contains('tile') ? el.getAttribute('href') : href;
            out.push({text, href:a}); if(out.length>12) break;
          }
        }
        return out;
      }
      function render(arr){
        if(!arr.length){ list.classList.add('hidden'); list.innerHTML=''; return; }
        list.innerHTML = arr.map((o,i)=>`<a href="${o.href}" role="option" data-ix="${i}">${o.text}</a>`).join('');
        list.classList.remove('hidden');
      }
      box.addEventListener('input', ()=>render(items(box.value)));
      box.addEventListener('keydown',(e)=>{
        const links=[...list.querySelectorAll('a')]; if(!links.length) return;
        const cur=list.querySelector('.sel'); let i=cur?+cur.dataset.ix:-1;
        if(e.key==='ArrowDown'){ e.preventDefault(); i=Math.min(links.length-1, i+1); }
        else if(e.key==='ArrowUp'){ e.preventDefault(); i=Math.max(0, i-1); }
        else if(e.key==='Enter'){ if(cur){ location.href=cur.getAttribute('href'); list.classList.add('hidden'); } return; }
        else if(e.key==='Escape'){ list.classList.add('hidden'); return; }
        links.forEach(a=>a.classList.remove('sel')); if(i>=0){ links[i].classList.add('sel'); }
      });
      addEventListener('click',(e)=>{ if(!list.contains(e.target) && e.target!==box) list.classList.add('hidden'); });
    })();

    // Scroll reveal
    (function(){
      if(!('IntersectionObserver' in window)){ document.querySelectorAll('.reveal').forEach(el=>el.classList.add('in')); return; }
      const io=new IntersectionObserver(es=>{ for(const e of es){ if(e.isIntersecting){ e.target.classList.add('in'); io.unobserve(e.target); } } }, {threshold:.12});
      document.querySelectorAll('.reveal').forEach(el=>io.observe(el));
    })();

    // Î driver for living glow
    (function(){
      const root=document.documentElement.style, dot=document.querySelector('.xi-dot'); let xi=.35;
      function step(){
        const target=.25+Math.random()*.6, start=xi, dur=2200+Math.random()*1600, t0=performance.now();
        function tween(t){
          const p=Math.min(1,(t-t0)/dur);
          xi=start+(target-start)*(0.5-0.5*Math.cos(Math.PI*p));
          root.setProperty('--xi', xi.toFixed(3)); if(dot) dot.style.opacity=(0.7+0.3*xi).toFixed(3);
          (p<1)?requestAnimationFrame(tween):requestAnimationFrame(step);
        } requestAnimationFrame(tween);
      } requestAnimationFrame(step);
    })();

    // Command Palette (âŒ˜K / Ctrl+K)
    (function palette(){
      const pal=document.getElementById('palette');
      const input=document.getElementById('palInput');
      const list=document.getElementById('palList');
      const OPEN_KEYS=new Set(['k','K']);
      const LINKS=[...document.querySelectorAll('a.tile, nav.tabs a, .cta')].map(a=>({text:a.textContent.trim(), href:a.getAttribute('href')||'#'}));
      function open(){ pal.hidden=false; input.value=''; render(LINKS.slice(0,12)); setTimeout(()=>input.focus(),0); }
      function close(){ pal.hidden=true; }
      function render(items){ list.innerHTML=items.map(o=>`<li><a href="${o.href}">${o.text}</a></li>`).join(''); }
      function filter(q){ q=q.trim().toLowerCase(); if(!q) return LINKS; return LINKS.filter(o=>o.text.toLowerCase().includes(q)); }

      addEventListener('keydown',(e)=>{
        const meta=e.ctrlKey||e.metaKey;
        if(meta && OPEN_KEYS.has(e.key)){ e.preventDefault(); open(); }
        if(!pal.hidden && e.key==='Escape'){ e.preventDefault(); close(); }
      });
      pal.addEventListener('click', (e)=>{ if(e.target===pal) close(); });
      input.addEventListener('input', ()=>render(filter(input.value).slice(0,14)));
      input.addEventListener('keydown',(e)=>{ if(e.key==='Enter'){ const a=list.querySelector('a'); if(a){ location.href=a.href; close(); } } });
    })();

    // Equation FX (mobile-safe sizing)
    (function eqFX(){
      if(matchMedia('(prefers-reduced-motion: reduce)').matches) return;

      const isSmall = matchMedia('(max-width: 640px)').matches;
      const cards=[...document.querySelectorAll('.eq-card')];
      const variants=['beams','orbit','spiral','nebula','rays','combo'];

      function seed(str){ let h=0; for(let i=0;i<str.length;i++) h=(h*31 + str.charCodeAt(i))>>>0; return h||1; }
      function rnd(s){ let x=s>>>0; return ()=> (x=(x*1664525+1013904223)>>>0, (x/0xFFFFFFFF)); }

      cards.forEach((card, idx)=>{
        const box=card.querySelector('.eq'); if(!box) return;
        const fx=box.querySelector('.fx-layer') || box.prepend(document.createElement('div')) || box.querySelector('.fx-layer');
        if(!fx.classList.contains('fx-layer')) fx.className='fx-layer';

        const r=rnd(seed(card.id||(`eq-${idx}`)));
        const v = variants[(idx + Math.floor(r()*variants.length)) % variants.length];
        const recipe = (v==='combo' || r()<0.28) ? 'combo' : v;
        box.setAttribute('data-fx', recipe);

        // Keep sizes sane on phones
        if (!isSmall) {
          const roll=r();
          card.classList.toggle('eq-lg', roll>0.8);
          card.classList.toggle('eq-sm', roll<0.15);
        } else {
          card.classList.remove('eq-lg','eq-sm');
        }

        box.style.setProperty('--beam-speed',       (22 + r()*10).toFixed(2)+'s');
        box.style.setProperty('--beam-speed-alt',   (26 + r()*12).toFixed(2)+'s');
        box.style.setProperty('--orbit-speed',      (30 + r()*14).toFixed(2)+'s');
        box.style.setProperty('--spiral-speed',     (34 + r()*16).toFixed(2)+'s');
        box.style.setProperty('--spiral-speed-alt', (38 + r()*18).toFixed(2)+'s');
        box.style.setProperty('--rays-speed',       (36 + r()*16).toFixed(2)+'s');

        function addBeams(n=2+Math.floor(r()*3)){
          for(let i=0;i<n;i++){
            const d=document.createElement('div');
            d.className='beam'+(r()<0.45?' alt':'');
            d.style.setProperty('--d', `${(r()*9).toFixed(2)}s`);
            const tilt=(r()<0.5?1:-1)*(8+r()*12);
            d.style.transform=`translateX(0) rotate(${tilt}deg)`;
            fx.appendChild(d);
          }
        }
        function addOrbit(){
          const o1=document.createElement('div'); o1.className='orbit';
          o1.style.setProperty('--tilt', `${(8+r()*14)*(r()<.5?-1:1)}deg`);
          const o2=document.createElement('div'); o2.className='orbit counter';
          o2.style.setProperty('--tilt', `${(10+r()*12)*(r()<.5?-1:1)}deg`);
          const b1=document.createElement('div'); b1.className='orb';
          const b2=document.createElement('div'); b2.className='orb gold';
          o1.appendChild(b1); o2.appendChild(b2); fx.append(o1,o2);
        }
        function addSpiral(){ const s=document.createElement('div'); s.className='spiral'; fx.appendChild(s); if(r()<.55){ const a=document.createElement('div'); a.className='spiral alt'; fx.appendChild(a);} }
        function addNebula(){ const n=document.createElement('div'); n.className='nebula'; fx.appendChild(n); }
        function addRays(){ const rr=document.createElement('div'); rr.className='rays'; fx.appendChild(rr); const d=document.createElement('div'); d.className='dust'; fx.appendChild(d); const f=document.createElement('div'); f.className='flare'; fx.appendChild(f); }

        if(recipe==='beams') addBeams();
        else if(recipe==='orbit') addOrbit();
        else if(recipe==='spiral') addSpiral();
        else if(recipe==='nebula') addNebula();
        else if(recipe==='rays') addRays();
        else { addBeams(); addOrbit(); if(r()<.7) addSpiral(); if(r()<.6) addNebula(); if(r()<.5) addRays(); }

        // Ensure MathJax SVG fits the card on mobile
        requestAnimationFrame(() => {
          card.querySelectorAll('mjx-container').forEach(m => {
            m.style.maxWidth = '100%';
            m.style.overflow = 'hidden';
            if (isSmall) m.style.fontSize = 'min(21px, 4.8vw)';
          });
        });
      });
    })();

    // 13-Moon mini deep-link keep fresh
    (function(){
      const MOONS = ["Magnetic","Lunar","Electric","Self-Existing","Overtone","Rhythmic","Resonant","Galactic","Solar","Planetary","Spectral","Crystal","Cosmic"];
      const MOON_ESS = ["Attract purpose","Stabilize challenge","Activate service","Define form","Empower radiance","Balance equality","Channel inspiration","Harmonize integrity","Pulse intention","Perfect manifestation","Dissolve release","Dedicate cooperation","Endure presence"];
      const TZ_KEY = "sof_moons_tz";

      function dateInTZ(baseDate, tz){
        try{
          const parts=new Intl.DateTimeFormat("en-CA",{timeZone:tz,hour12:false,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).formatToParts(baseDate);
          const m=Object.fromEntries(parts.map(p=>[p.type,p.value]));
          return new Date(`${m.year}-${m.month}-${m.day}T${m.hour}:${m.minute}:${m.second}Z`);
        }catch(_){ return new Date(baseDate); }
      }
      const isLeapYear = y => (y%4===0 && y%100!==0) || (y%400===0);
      const isLeapDayUTC = d => d.getUTCMonth()===1 && d.getUTCDate()===29;
      const isDOOT = (d, tz) => { const dt=dateInTZ(d, tz); return (dt.getUTCMonth()===6 && dt.getUTCDate()===25); }; // Jul 25 in TZ
      function startOfYear13(d, tz){
        const dt = dateInTZ(d, tz);
        const y = dt.getUTCFullYear();
        const aThis = new Date(Date.UTC(y,6,26));
        const aPrev = new Date(Date.UTC(y-1,6,26));
        return dt >= aThis ? aThis : aPrev;
      }
      const utcTrunc = d => new Date(Date.UTC(d.getUTCFullYear(), d.getUTCMonth(), d.getUTCDate()));
      function dayIndexSinceStart(d, tz){
        const start = utcTrunc(startOfYear13(d, tz));
        const dt = utcTrunc(dateInTZ(d, tz));
        let days = Math.floor((dt - start)/86400000);
        const doot = new Date(Date.UTC(start.getUTCFullYear()+1,6,25));
        if (dt >= doot) days -= 1;
        for (let y=start.getUTCFullYear(); y<=dt.getUTCFullYear(); y++){
          if(isLeapYear(y)){
            const feb29 = new Date(Date.UTC(y,1,29));
            if (dt >= feb29 && start <= feb29) days -= 1;
          }
        }
        return days;
      }
      function calc13Moon(d, tz){
        if (isDOOT(d,tz)){
          const s=startOfYear13(d,tz).getUTCFullYear();
          return {special:"Day Out of Time", year:`${s}/${s+1}`};
        }
        if (isLeapDayUTC(dateInTZ(d,tz))){
          const s=startOfYear13(d,tz).getUTCFullYear();
          return {special:"Leap Day", year:`${s}/${s+1}`};
        }
        const idx = dayIndexSinceStart(d, tz);
        const moon = Math.floor(idx/28)+1;
        const day  = (idx%28)+1;
        const s=startOfYear13(d,tz).getUTCFullYear();
        return {special:null, moon, day, year:`${s}/${s+1}`};
      }

      function renderMoonBar(){
        const link = document.getElementById('moonMiniLink'); if (!link) return;
        const mbMoon = document.getElementById('mbMoon');
        const mbDay  = document.getElementById('mbDay');
        const mbDayLine = document.getElementById('mbDayLine');
        const mbEss = document.getElementById('mbEssence');
        const mbYear = document.getElementById('mbYear');

        const tz = localStorage.getItem(TZ_KEY) || Intl.DateTimeFormat().resolvedOptions().timeZone || "UTC";
        const now = new Date();
        const wall = dateInTZ(now, tz);
        const dStr = wall.toISOString().slice(0,10);

        const m13 = calc13Moon(now, tz);

        if (m13.special){
          mbMoon.textContent = m13.special;
          mbDay.textContent = 'â€”';
          mbDayLine.textContent = 'â€”';
          mbEss.textContent = `13-Moon Year ${m13.year}`;
          mbYear.textContent = m13.year;
        } else {
          const idx = m13.moon - 1;
          mbMoon.textContent = `${MOONS[idx]}`;
          mbDay.textContent = `${m13.day}`;
          mbDayLine.textContent = `Day ${m13.day} of 28`;
          mbEss.textContent = MOON_ESS[idx];
          mbYear.textContent = m13.year;
        }

        const url = new URL(link.getAttribute('href'), document.baseURI);
        url.searchParams.set('d', dStr);
        url.searchParams.set('tz', tz);
        link.setAttribute('href', url.toString());
      }

      renderMoonBar();
      setInterval(renderMoonBar, 60*1000);
    })();

    } // end guard

    <!-- ===== HeavenSound v2 â€” subtle sacred ambience ===== -->
<script>
/*
  Why your old button was silent:
  - WebAudio contexts must be started from a user gesture (click/touch).
  - iOS suspends contexts on page hide; need resume guards.
  - Using <audio> tags across pages is heavy; here we synthesize ultra-light ambient tones.

  What this provides:
  - One tiny WebAudio engine with soft-carrier â€œremnantâ€ pads.
  - Different voicings per page (home/theory/teach/â€¦ via location.pathname).
  - Safe defaults (very low volume, no autoplay). Click âœ§ Sound to start/stop.
  - Persists state across navigation (localStorage).
*/

(function(){
  "use strict";
  const btn = document.getElementById('heavenToggle');
  if(!btn) return;

  // Persisted prefs
  const LS_KEY_STATE = 'sof_heaven_on';
  const LS_KEY_VOL   = 'sof_heaven_vol';
  const clamp=(v,a,b)=>Math.min(b,Math.max(a,v));
  let desiredVol = +localStorage.getItem(LS_KEY_VOL) || 0.22;

  // Audio graph bits
  let ctx=null, master=null, padNodes=[], lfo=null, filter=null;
  let running=false;

  // Page â†’ â€œmodeâ€ (voicing) map
  function modeForPath(){
    const p = location.pathname.toLowerCase();
    if (p.includes('/theory'))  return 'wisdom';
    if (p.includes('/teach'))   return 'manifest';
    if (p.includes('/moons'))   return 'moons';
    if (p.includes('/ethics'))  return 'ethics';
    if (p.includes('/circle'))  return 'circle';
    return 'home';
  }

  // Simple tempered helpers
  const A4=440, SEMI=Math.pow(2,1/12);
  const ratio = n => A4*Math.pow(SEMI,n);
  // carriers for different pages (Hz sets; gentle beating)
  const BANKS={
    home:      [432, 528*0.5, 963/2],
    wisdom:    [ ratio(-12), ratio(0), ratio(7) ],      // A3, A4, E5
    manifest:  [ 528, 396, 639 ],
    moons:     [ 432, 384, 288 ],
    ethics:    [ 963, 528*0.75, 432/2 ],
    circle:    [ 444, 333, 222 ]
  };

  // Create the synthesis graph
  function build(){
    ctx = new (window.AudioContext||window.webkitAudioContext)({latencyHint:'interactive'});
    master = ctx.createGain(); master.gain.value = 0.0001; master.connect(ctx.destination);

    // Gentle lowpass to make it airy
    filter = ctx.createBiquadFilter(); filter.type='lowpass'; filter.frequency.value=2600; filter.Q.value=0.6;
    filter.connect(master);

    // Very slow LFO to move warmth
    lfo = ctx.createOscillator(); lfo.type='sine'; lfo.frequency.value = 0.03; // ~33s
    const lfoGain = ctx.createGain(); lfoGain.gain.value = 400; // mod depth
    lfo.connect(lfoGain); lfoGain.connect(filter.frequency); lfo.start();

    // Add pads for current page
    const bank = BANKS[modeForPath()] || BANKS.home;
    padNodes = bank.map((hz,i)=>{
      const osc = ctx.createOscillator();
      const shape = (i%2? 'sine' : 'triangle');
      osc.type = shape; osc.frequency.value = hz;

      const g = ctx.createGain();
      // tiny detune per-voice for movement
      osc.detune.value = (i-1)*1.6;

      // very slow individual LFOs
      const l = ctx.createOscillator(); l.type='sine'; l.frequency.value = 0.01 + i*0.008;
      const lg = ctx.createGain(); lg.gain.value = 0.2; l.connect(lg); lg.connect(g.gain); l.start();

      // envelope in
      g.gain.value = 0.00001;
      osc.connect(g); g.connect(filter);
      osc.start();

      // shimmer by adding a very quiet noise bed
      const noise = pinkNoiseNode(ctx);
      const ng = ctx.createGain(); ng.gain.value = 0.0005;
      noise.connect(ng); ng.connect(filter);

      return {osc,g,noise,ng};
    });
  }

  // Pink-ish noise node (cheap)
  function pinkNoiseNode(ctx){
    const bufSize = 4096;
    const node = ctx.createScriptProcessor ? ctx.createScriptProcessor(bufSize,1,1)
                                           : ctx.createScriptProcessor(bufSize,1,1); // old API fallback
    let b0=0,b1=0,b2=0,b3=0,b4=0,b5=0,b6=0;
    node.onaudioprocess = function(e){
      const out=e.outputBuffer.getChannelData(0);
      for(let i=0;i<out.length;i++){
        const white=Math.random()*2-1;
        b0=0.99886*b0 + white*0.0555179;
        b1=0.99332*b1 + white*0.0750759;
        b2=0.96900*b2 + white*0.1538520;
        b3=0.86650*b3 + white*0.3104856;
        b4=0.55000*b4 + white*0.5329522;
        b5=-0.7616*b5 - white*0.0168980;
        out[i]=(b0+b1+b2+b3+b4+b5+b6*0.5362)*0.11;
        b6=white*0.115926;
      }
    };
    return node;
  }

  // Smooth ramps
  function rampParam(param, to, ms=1200){
    if(!ctx || !param) return;
    const now = ctx.currentTime || 0;
    try { param.cancelScheduledValues(now); } catch {}
    if (typeof param.setTargetAtTime === 'function') {
      // Exponential-like easing
      param.setTargetAtTime(to, now, Math.max(0.001, ms/1000));
    } else if (typeof param.linearRampToValueAtTime === 'function') {
      // Fallback for non-AudioParam-like objects
      param.setValueAtTime(param.value ?? 0, now);
      param.linearRampToValueAtTime(to, now + ms/1000);
    } else {
      // Last resort
      try { param.value = to; } catch {}
    }
  }

  async function start(){
    if(running) return;
    if(!ctx) build();
    await ctx.resume();               // iOS guard
    // fade in master & pad gains
    padNodes.forEach(v=> rampParam(v.g.gain, 0.08, 2400));
    rampParam(master.gain, desiredVol, 1800);
    running = true;
    updateBtn();
  }

  function stop(){
    if(!ctx || !running) return;
    // soft fade out
    padNodes.forEach(v=> rampParam(v.g.gain, 0.00001, 800));
    rampParam(master.gain, 0.0001, 1000);
    running = false;
    updateBtn();
  }

  function updateBtn(){
    btn.setAttribute('aria-pressed', String(running));
  }

  // UI
  btn.addEventListener('click', async ()=>{
    if(!running){ await start(); localStorage.setItem(LS_KEY_STATE,'1'); }
    else{ stop(); localStorage.setItem(LS_KEY_STATE,'0'); }
  }, {passive:false});

  // Optional volume slider if you ever unhide #heavenPanel
  const vol = document.getElementById('heavenVol');
  if(vol){
    vol.value = String(desiredVol);
    vol.addEventListener('input', ()=>{
      desiredVol = clamp(parseFloat(vol.value)||0, 0, 1);
      localStorage.setItem(LS_KEY_VOL, String(desiredVol));
      if(master) master.gain.value = desiredVol;
    }, {passive:true});
  }

  // Resume on visibility change (iOS suspends)
  document.addEventListener('visibilitychange', async ()=>{
    if(document.hidden) return;
    if(running && ctx && ctx.state !== 'running'){ try{ await ctx.resume(); }catch{} }
  });

  // If user previously enabled sound, arm the button so first gesture anywhere re-enables
  if(localStorage.getItem(LS_KEY_STATE)==='1'){
    // Prime but donâ€™t autoplay: first click anywhere starts it via our button click
    const primer = ()=>{ btn.click(); window.removeEventListener('pointerdown', primer); };
    window.addEventListener('pointerdown', primer, {once:true, passive:true});
  }
})();
</script>
<!-- ===== end HeavenSound v2 ===== -->

</body>
</html>
