/* ==========================================================================
   Scroll of Fire — 13 Moons
   - Moonbar, rings, calendars, numerology, practice prompts
   - Includes subtle starfield + glints for “wizard” vibe
   ========================================================================== */
@layer remnant {
  /* Starfield canvas sits behind the UI (inserted in HTML) */
  body.stars {
    background-attachment: fixed;
    background-image:
      radial-gradient(1200px 700px at 10% -20%, color-mix(in oklch, var(--accent) 10%, transparent), transparent 60%),
      radial-gradient(1200px 700px at 90% 120%, color-mix(in oklch, var(--accent-2) 10%, transparent), transparent 60%),
      var(--bg);
  }

  /* Moonbar mini */
  .moonbar[data-size="compact"] { gap: 12px }
  .moonbar .moonbar-line { display: flex; gap: 8px; align-items: baseline }
  .moonbar .moonbar-tags { display: flex; gap: 8px; align-items: center; color: var(--muted) }
  .moonbar .yhwh-on .tag.yhwh { background: color-mix(in oklch, var(--accent) 14%, var(--bg-elev)) }

  /* Progress ring (header badge) */
  .moon-badge { display: flex; align-items: center; gap: 10px; flex-wrap: wrap }
  .pill .k { font-weight: 800 }

  /* Week dots */
  #weekDots { margin-top: 6px }
  #weekDots .dot.today {
    outline: 2px solid color-mix(in oklch, var(--accent) 70%, #fff);
    outline-offset: 2px;
    opacity: 1;
  }

  /* Year map table */
  .year-map tbody tr:hover { background: color-mix(in oklch, var(--accent) 6%, var(--bg-elev)) }
  .year-map td:nth-child(1) { width: 36px; text-align: right; font-family: var(--font-mono) }
  .year-map td:nth-child(4),
  .year-map td:nth-child(5) { font-family: var(--font-mono) }

  /* Dual calendars */
  .calendar, .gregorian { --cell: 40px }
  .calendar .row,
  .gregorian .row { display: grid; grid-template-columns: repeat(7, var(--cell)); gap: 6px; margin-bottom: 8px }
  .calendar .head,
  .gregorian .head { display: grid; grid-template-columns: repeat(7, var(--cell)); gap: 6px; margin-bottom: 6px }
  .calendar .dow,
  .gregorian .dow { text-align: center; color: var(--muted); font-size: 12px }

  .daycell {
    height: var(--cell); display: grid; place-items: center;
    border-radius: 10px; border: 1px solid var(--line); background: var(--bg-elev);
    position: relative; overflow: hidden;
  }
  .daycell .n { font-family: var(--font-mono); font-size: 13px }
  .daycell .evt { position: absolute; bottom: 4px; left: 6px; display: flex; gap: 4px }
  .daycell .evt i { width: 6px; height: 6px; border-radius: 50% }
  .daycell.is-today { box-shadow: var(--glow-a) }
  .daycell.is-doot { background: color-mix(in oklch, var(--accent-2) 12%, var(--bg-elev)) }
  .daycell.is-leap { background: color-mix(in oklch, #b8ffd1 18%, var(--bg-elev)) }

  .remnant .daycell.is-filled { background: color-mix(in oklch, var(--accent) 10%, var(--bg-elev)) }
  .gregorian .daycell.is-dim  { opacity: .5 }

  /* Numerology and quotes */
  .sim { display: grid; grid-template-columns: 280px 1fr; gap: 10px; align-items: center }
  @media (max-width: 560px){ .sim { grid-template-columns: 1fr } }

  /* Practice list */
  .prompts { padding-left: 18px }
  .prompts li { margin: 6px 0 }
  #noteText { margin-top: 6px }

  /* Share card button (mini moonbar) */
  .moonbar-share::after {
    content: "⤴"; font-weight: 900; padding-left: 6px;
  }

  /* Little sparkles on hover (subtle) */
  .card.shine:hover { box-shadow: var(--shadow-3) }
  .card.shine:hover::after {
    content:""; position:absolute; inset:-2px; pointer-events:none;
    background: radial-gradient(400px 120px at 20% -20%, color-mix(in oklch, var(--accent) 14%, transparent), transparent 60%),
                radial-gradient(400px 120px at 120% 120%, color-mix(in oklch, var(--accent-2) 14%, transparent), transparent 60%);
    border-radius: inherit; opacity: .65;
  }

  /* Mobile nudges (complement to core.css) */
  @media (max-width: 880px){
    .calendar, .gregorian { --cell: 42px }
    .daycell .n { font-size: 12px }
  }
}