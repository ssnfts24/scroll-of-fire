@layer components{
/* header badge */
.moon-badge{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.ring{width:clamp(88px,9vw,120px);position:relative}
.ring .label{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
.ring .ring-bg{stroke:#1b2231;stroke-width:10;fill:none}
.ring .ring-fg{stroke:url(#rg), var(--accent);stroke-linecap:round;stroke-width:12;fill:none;stroke-dasharray:0 316;filter:drop-shadow(0 0 10px rgba(122,243,255,.35))}

/* week dots */
.weekrow{display:flex;gap:8px;align-items:center;margin-top:10px}
.weeklabel{opacity:.7}
.week{display:grid;grid-template-columns:repeat(14,minmax(8px,1fr));gap:6px}
.week .dot{height:8px;width:8px;border-radius:999px;background:#2a3242}
.week .dot.on{background:color-mix(in oklab, var(--accent) 80%, transparent)}
@media (min-width:720px){ .week{grid-template-columns:repeat(28,1fr)} }

/* compare calendars */
.compare{display:grid;gap:12px;grid-template-columns:1fr}
@media (min-width:960px){ .compare{grid-template-columns:1fr 1fr} }
.panel{background:var(--bg-elev);border-radius:var(--radius);box-shadow:var(--rim)}
.panel__head{display:flex;justify-content:space-between;align-items:end;gap:10px;padding:var(--pad)}
.panel .calendar,.panel .gregorian{padding:var(--pad)}
.legend{display:flex;flex-wrap:wrap;gap:10px;padding:0 var(--pad) var(--pad)}

/* year map */
.year-map{border-collapse:separate;border-spacing:0;min-width:720px;width:100%}
.year-map thead th{position:sticky;top:0;background:var(--bg);z-index:1}
.year-map tbody tr:nth-child(odd){background:color-mix(in oklab, var(--card) 85%, transparent)}
.year-map td,.year-map th{padding:.5rem .6rem}

/* mini moonbar */
.moonbar{display:flex;align-items:center;gap:12px;padding:.5rem .65rem;border-radius:999px;background:rgba(127,127,127,.08);border:1px solid var(--line);isolation:isolate}
.moonbar svg{width:100%;height:auto;min-height:34px}
.moonbar .mb-bg{stroke:#142233;stroke-width:8;opacity:.9}
.moonbar .mb-fg{stroke:url(#mbGrad), var(--accent);stroke-width:8;stroke-linecap:round;filter:drop-shadow(0 0 8px color-mix(in oklch, var(--accent) 55%, transparent))}
.moonbar-info{display:flex;flex-direction:column;gap:2px}
.moonbar-line{display:flex;gap:8px;align-items:center}
.moonbar-actions{margin-left:auto;display:flex;gap:6px;align-items:center}
.moonbar .moonbar-share{padding:.35rem .6rem;border:1px solid var(--line);border-radius:10px;background:transparent}
@media (min-width:880px){ .moonbar .mb-fg{stroke-width:10} }

/* inputs */
#noteText{width:100%;min-height:120px;resize:vertical}
}

/* tiny extras from utilities layer */
@layer utilities{
.wrap{max-width:1100px;margin-inline:auto;padding-inline:clamp(12px,4vw,20px)}
}

@layer components{
/* Calendar grid primitives */
.calendar,.gregorian{
  --cell:42px;
  display:grid;
  gap:8px;
}
.calendar .head,.gregorian .head{
  display:grid; grid-template-columns:repeat(7,1fr); gap:6px;
}
.calendar .row,.gregorian .row{
  display:grid; grid-template-columns:repeat(7,1fr); gap:6px;
}

/* Day cells */
.daycell{
  min-height:var(--cell);
  background:var(--bg-elev);
  border:1px solid var(--line);
  border-radius:10px;
  display:flex; align-items:flex-start; justify-content:flex-start;
  padding:.4rem .45rem; position:relative;
}
.daycell .n{ font:600 0.95rem/1 Inter,system-ui; opacity:.9 }
.daycell .evt{ position:absolute; right:.45rem; bottom:.35rem; width:6px; height:6px; border-radius:999px; background:transparent }

/* States */
.daycell.is-dim{ opacity:.35 }
.daycell.is-today{ outline:2px solid var(--accent); outline-offset:1px }
.daycell.is-doot{ border-color: color-mix(in oklab, var(--gold) 60%, var(--line)) }
.daycell.is-doot .evt{ background: var(--gold) }
.daycell.is-leap{ border-color: color-mix(in oklab, var(--accent-2) 60%, var(--line)) }
.daycell.is-leap .evt{ background: var(--accent-2) }

/* Legend dots (match states) */
#calLegend .k-dot{ display:inline-block; width:.7em; height:.7em; border-radius:50%; vertical-align:middle; margin-right:.35rem }
#calLegend .k-evt1{ background: var(--accent) }
#calLegend .k-evt2{ background: var(--accent-2) }
#calLegend .k-doot{ background: var(--gold) }
#calLegend .k-leap{ background: var(--accent-2) }
#calLegend .k-today{ background: color-mix(in oklab, var(--accent) 60%, var(--ink)) }
}