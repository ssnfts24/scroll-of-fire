/* ==========================================================================
   Scroll of Fire — Astrology Panel Skin
   Depends on: tokens.css, core.css
   Scopes: planet chips, zodiac wheel labels, house lines, aspects table,
           badges/legend, responsive polish
   Theme: Wizard of YHWH — aqua↔gold gradients, soft star glows
   ========================================================================== */

@layer astrology, utilities;

/* ------------------------------ Planet Chips ------------------------------ */
@layer astrology {
  .astro .chip{
    transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
  }
  .astro .chip:focus-visible{ outline: none; box-shadow: 0 0 0 2px var(--focus), var(--glow-aqua) }
  .astro .chip:hover{ transform: translateY(-1px); box-shadow: 0 4px 18px rgba(0,0,0,.28), var(--glow-aqua) }
  .astro .chip[aria-pressed="true"]{
    background: linear-gradient(180deg, rgba(122,243,255,.12), rgba(243,201,122,.10));
    border-color: color-mix(in oklch, var(--aqua) 45%, var(--line));
  }
  .astro .chip b{ letter-spacing:.2px }
  .astro .chip .pos{ opacity:.85 }
  .astro .chip .sign{ opacity:.9; color: var(--aqua) }
  .astro .more summary{ cursor:pointer; list-style:none }
  .astro .more summary::-webkit-details-marker{ display:none }
}

/* ------------------------------ Zodiac Wheel ------------------------------ */
@layer astrology {
  .astro-wheel{
    --label: #a7b1ca;
    --tick:  #2a3242;
    --rim:   color-mix(in oklch, var(--aqua) 60%, transparent);
    position:relative; padding:8px; border:1px solid var(--line); border-radius:16px;
    background: linear-gradient(145deg, rgba(255,255,255,.02), rgba(255,255,255,.01));
  }
  .astro-wheel::after{
    content:""; position:absolute; inset:0; border-radius:16px; pointer-events:none;
    box-shadow: 0 0 0 1px rgba(255,255,255,.04) inset, 0 0 32px rgba(122,243,255,.06) inset;
  }

  /* SVG labels/ticks default styles (populated by JS) */
  #houseLines line{ stroke: var(--tick); stroke-width:.9 }
  #signLabels text{
    fill: var(--label);
    font-family: var(--font-sans);
    font-weight: 600;
    letter-spacing:.4px;
    paint-order: stroke;
    stroke: #0b0f16;
    stroke-width: 2px; /* halo */
  }

  /* Planet dots inherit element-color classes from core.css */
  #planetDots .dot{ filter: drop-shadow(0 0 6px rgba(0,0,0,.3)) }

  /* Animated sweep when new data arrives (JS toggles .sweep) */
  #astroWheel.sweep { animation: aw-sweep 1400ms ease }
  @keyframes aw-sweep {
    from { opacity:.65; transform: scale(.985) }
    60%  { opacity:1;   transform: scale(1) }
    to   { opacity:1 }
  }
}

/* ------------------------------ Aspect Legend/Table ----------------------- */
@layer astrology {
  .legend{
    display:flex; flex-wrap:wrap; gap:8px; padding:6px 0;
  }
  .legend .badge{
    font-weight:700; border-radius:999px; padding:6px 10px;
    background: rgba(255,255,255,.04); border:1px solid var(--line);
  }
  .asp-table{
    width:100%; margin-top:6px; border-collapse:separate; border-spacing:0;
  }
  .asp-table thead th{
    font-size: var(--fs-sm); color: var(--muted); font-weight:700;
    border-bottom:1px solid var(--line); padding:8px 10px;
  }
  .asp-table tbody td{
    padding:10px; border-bottom:1px dashed var(--line); vertical-align:middle;
  }
  .asp-table tbody tr:hover{
    background: linear-gradient(90deg, rgba(122,243,255,.06), transparent);
  }
  .asp-table .deg{ font-variant-numeric: tabular-nums; letter-spacing:.2px }
  .asp-table .orb-tight{ color: var(--aqua) }
  .asp-table .orb-wide{ color: var(--muted) }
}

/* ------------------------------ Glyph Helpers ----------------------------- */
@layer astrology {
  /* Optional fallback emoji for platforms without glyph font */
  .z-glyph{
    font-family: ui-symbols, "Segoe UI Symbol", "Apple Color Emoji", "Noto Color Emoji", system-ui, sans-serif;
    font-size: 12px; opacity:.9;
  }
  .pl-glyph{
    font-family: ui-symbols, "Segoe UI Symbol", "Apple Color Emoji", "Noto Color Emoji", system-ui, sans-serif;
    font-size: 12px; opacity:.95;
  }
}

/* ------------------------------ Footer/meta of the panel ------------------ */
@layer astrology {
  .astro figcaption{ margin-top:8px; display:flex; align-items:center; gap:8px; justify-content:center }
  .astro figcaption .sep{ opacity:.5 }
  #astroSource{ color: var(--aqua) }
}

/* ------------------------------ Responsive ------------------------------- */
@layer astrology {
  @media (max-width: 1040px){
    .astro .chip{padding:7px 9px}
    #astroWheel{ max-width: 520px }
  }
  @media (max-width: 640px){
    .astro .chip{ font-size: 13px }
    #astroWheel{ max-width: 420px }
  }
}

/* ------------------------------ Utilities -------------------------------- */
@layer utilities {
  .asp.conj { border-color:#3a4254 }
  .asp.sext { border-color:#2f5a46 }
  .asp.sqr  { border-color:#5a3a32 }
  .asp.tri  { border-color:#2b5568 }
  .asp.opp  { border-color:#564268 }
}
