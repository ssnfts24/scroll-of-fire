/* ==========================================================================
   Scroll of Fire â€” Bridge (last-resort overrides)
   Purpose: tame legacy/unlayered styles, fix specificity gaps, prevent jank
   Layer: legacy (loads last)
   ========================================================================== */
@layer legacy {
  /* Normalize buttons/inputs in toolbars */
  .calendar__tools .btn,
  .lab-btn,
  .dl,
  button,
  input[type="button"],
  input[type="submit"],
  input[type="reset"]{
    font: 600 14px/1.2 var(--ui, Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif);
    border-radius: 12px;
    border: 1px solid var(--line, #2a3242);
    background: var(--card, #0e131a);
    color: var(--ink, #edf2fb);
    padding: 8px 12px;
    display: inline-flex; align-items: center; gap: .5rem;
    text-decoration: none;
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
  }
  .calendar__tools .btn:hover,
  .lab-btn:hover, .dl:hover,
  button:hover { background: color-mix(in oklch, var(--card), white 4%); }

  /* Compact tag/pill fixes */
  .tag, .pill, .badge{
    border: 1px solid var(--line,#2a3242);
    background: color-mix(in oklch, var(--surface,#0e131a) 98%, white);
    color: var(--muted,#a7b1ca);
    border-radius: 999px;
    padding: .25rem .5rem;
    display: inline-flex; align-items: center; gap:.35rem;
    white-space: nowrap;
  }

  /* Moonbar ring dash compat */
  #moonArc[pathLength], #moonArcMini[pathLength]{
    stroke-linecap: round;
    stroke: url(#mbGrad);
    fill: none;
  }

  /* Anti jump on iOS toolbars */
  html, body { overscroll-behavior: contain; }

  /* Table overflow safety */
  .year-map{ width:100%; border-collapse: collapse; }
  .year-map th, .year-map td{
    border-bottom: 1px solid var(--line,#2a3242);
    padding:.5rem .6rem; text-align:left;
  }

  /* Provide a default named container for container queries */
  .wrap{ container-type:inline-size; container-name:wrap; }

  /* Mobile toolbar wrapping */
  @container wrap (max-width: 720px){
    .lab-row{ flex-wrap: wrap; gap:.5rem; }
    .moonbar{ grid-template-columns: auto 1fr; }
    .moonbar-actions{ grid-column: 1 / -1; justify-content: flex-end; }
  }

  /* FB in-app browser guard */
  .is-fbapp .lab-btn, .is-fbapp select, .is-fbapp input{ transform: translateZ(0); }

  /* Min-width fix to prevent flex children overflow clipping */
  * { min-width: 0; }
}
